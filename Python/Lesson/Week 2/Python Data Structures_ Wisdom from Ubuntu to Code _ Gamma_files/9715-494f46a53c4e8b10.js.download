(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9715],{98:()=>{},343:(e,t,n)=>{"use strict";n.d(t,{$:()=>p});var i=n(55729),r=n(88586),o=n(56450),l=n(20715),a=n(32263),s=n(51817),d=n(72492),c=n(82927),u=n(53505);let p=()=>{let[e]=(0,r.wdY)(),{user:t}=(0,c.ur)();return(0,i.useCallback)(async n=>{let{title:i,path:c,documentAttributes:p,file:h,source:m,titleEdited:g}=n,x=(0,a.k5)(p),f=(0,d.p0)(x);if(!h)throw Error("Tried to create a page without file");let y=(0,u.X)({path:c,file:h}),{data:v}=await e({variables:{fileId:h.id,title:i,titleEdited:g,path:y,source:m&&o.a[m]||r.ALe.SitesAddPage,initialContent:{ydoc:f,schemaVersion:s.f$,editors:[null==t?void 0:t.id]}}});if(!v)throw Error("Mutation didnt return data");let{createPage:{id:b}}=v;return(0,l.c)({doc_id:b,source:m||r.ALe.SitesAddPage,channel:null}),{docId:b}},[e,null==t?void 0:t.id])}},1433:()=>{},2942:(e,t,n)=>{"use strict";n.d(t,{Z0:()=>d,ip:()=>u,mm:()=>c});var i=n(81278),r=n(55729),o=n(15342),l=n(43634),a=n(70006),s=n(81664);let d=(0,r.createContext)({openSiteSettings:e=>{},openSharePanel:(e,t)=>{}}),c=e=>{let{push:t}=(0,i.useRouter)(),n=(0,o.CU)();return(0,r.useMemo)(()=>({openSiteSettings:e=>{s.R.emit("openSiteSettings",e)},openSharePanel:async(i,r)=>{let o=()=>s.R.emit("openSharePanel",r);if(i!==e){let e=(0,a.pF)({docId:i});await t(e);let r=n.subscribe(()=>{(0,l.sX)(n.getState())===i&&(o(),r())})}else o()}}),[e,t,n])},u=()=>(0,r.useContext)(d)},5291:(e,t,n)=>{"use strict";n.d(t,{b9:()=>h,go:()=>u,iJ:()=>c,iO:()=>p});var i=n(55729),r=n(22275),o=n(15342),l=n(86497),a=n(58859),s=n(34647),d=n(25991);let c=()=>{let e=(0,i.useRef)("unsynced"),t=(0,o.CU)(),n=(0,l.O)(),s=(0,i.useCallback)(async(i,r,o)=>{if((0,d.yy)(t.getState())||n){if("unsynced"!==e.current)return void console.warn("Cannot load doc from cache when it is already ".concat(e.current));await (0,a.f)().loadYDoc(i,r)&&(e.current="loaded",o())}},[n,t]),c=(0,i.useCallback)((i,o)=>{if(!((0,d.yy)(t.getState())||n))return;let l=(0,r.S)();if("unsynced"!==e.current)return void console.warn("Cannot sync doc to cache when it is already ".concat(e.current));l&&(0,a.f)().syncYDoc(i,o)},[n,t]);return(0,i.useMemo)(()=>({loadYDoc:s,syncYDoc:c}),[s,c])},u=()=>{let e=(0,o.jL)(),t=(0,o.CU)();return(0,i.useCallback)(function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date().toISOString();(0,d.yy)(t.getState())&&e((0,d.KT)({docIds:n,lastSynced:i}))},[e,t])},p=()=>{let e=(0,o.jL)(),t=(0,o.CU)();return(0,i.useCallback)(function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date().toISOString();if((0,d.yy)(t.getState()))return e((0,d.yK)({docId:n,lastSynced:i}))},[e,t])},h=()=>(0,i.useMemo)(()=>(0,s.S)(),[])},5455:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});let i={src:"/_next/static/media/error-cat.e78a3685.png",height:449,width:540,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAgVBMVEUBfMPTzcLW0r8keq2gqJivt7Q4MTTq5dB/fwChtMRciatXg8Uwer4Cd7xGbrIFd71abX1gk2N+halUXW6rpJa/iqLXwruluZ2EhoIjicoqdZ+ogZUAc7Tl0cDY1sCBiWMvdIHU1Mh5j45fhtELcbOqnLxxcm/+8dTuyrhdYmwHcrIeJhGKAAAAInRSTlP+/Hn+/v5i/gH+6P38tNTL/fy/9P6M/fv+Tv63XayX/P5ZKm4vtgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAERJREFUeJwFwQUCgCAQBMAFgQMLsbvF+P8DnYHWlVJDNyKxhW/fD8CZsVr0AGIjytusCCLpGmIL9uN6iEgiTPNp5nz7AXZMA8B1anccAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:7}},6252:(e,t,n)=>{"use strict";n.d(t,{r:()=>v});var i=n(6029),r=n(88507),o=n(95669),l=n.n(o),a=n(91938),s=n(73110),d=n(29608);let c="".concat("01919ef7-fdd5-72aa-8b3e-9a438906692f").concat("production"===a.$.APPLICATION_ENVIRONMENT?"":"-test"),u="https://cdn.cookielaw.org/consent/".concat(c,"/OtAutoBlock.js"),p="https://cdn.cookielaw.org/consent/".concat(c,"/otSDKStub.js"),h=()=>{let e=(0,s.O)(),t=!(0,d.rA)();return((0,r.w)(()=>{try{if(t){var n;null==(n=window.OneTrust)||n.changeLanguage(e)}}catch(e){}},[t,e]),t)?(0,i.jsxs)(l(),{children:[(0,i.jsx)("script",{id:"ot-autoblock",src:u}),(0,i.jsx)("script",{id:"ot-script",src:p,"data-domain-script":c}),(0,i.jsx)("script",{id:"ot-anon",dangerouslySetInnerHTML:{__html:"function OptanonWrapper() { }"}})]}):null};var m=n(11403),g=n(85732);let x=()=>{let e=!(0,d.rA)()&&!(0,g.NF)();return(0,m.En)()&&e?(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:'\x3c!-- Google Tag Manager (noscript) --\x3e\n<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TGJXRPT"\nheight="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>\n\x3c!-- End Google Tag Manager (noscript) --\x3e'}}):null},f=()=>{let e=!(0,d.rA)()&&!(0,g.NF)();return(0,m.En)()&&e?(0,i.jsxs)(l(),{children:[(0,i.jsx)("script",{dangerouslySetInnerHTML:{__html:"\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag(){dataLayer.push(arguments);}\ngtag('js', new Date());\n\ngtag('config', 'AW-11368900852');\n"}}),(0,i.jsx)("script",{async:!0,src:"https://www.googletagmanager.com/gtag/js?id=AW-11368900852"}),(0,i.jsx)("script",{dangerouslySetInnerHTML:{__html:"\n(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-TGJXRPT');\n"}})]}):null},y=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f,{}),(0,i.jsx)(x,{})]});function v(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return n=>(0,i.jsxs)(i.Fragment,{children:[t&&(0,i.jsx)(h,{}),(0,i.jsx)(y,{}),(0,i.jsx)(e,{...n})]})}},6308:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(6029),r=n(774),o=n(66360),l=n(91106),a=n(55729),s=n(99767),d=n(73110),c=n(2435);let u=(e,t)=>{e.globalToast||(e.globalToast=(0,c.J)({theme:t}))},p=e=>{let{children:t}=e,n=(0,d.O)(),c=s.zd[n],p=(null==c?void 0:c.rtl)===!0?"rtl":"ltr",h=(0,a.useMemo)(()=>(0,r.oY)(l.Ip,{direction:p,styles:{global:{".ProseMirror":{outline:"0 none"}}}}),[p]);return(0,a.useEffect)(()=>{u(window,h)},[]),(0,i.jsx)(o.s,{toastOptions:l.S1,theme:h,resetCSS:!0,children:t})}},7761:(e,t,n)=>{"use strict";n.d(t,{x:()=>f});var i=n(6029),r=n(8527),o=n(40162),l=n(49611),a=n(78140),s=n(36999),d=n(41283),c=n(37930),u=n(48478),p=n(58959),h=n(99492),m=n(48621),g=n(45143);let x=e=>{let{option:t,isSelected:n,setSelectedOption:a,size:s="sm"}=e,{tab:d}=(0,r.o)("Tabs",{variant:"soft-rounded",size:s}),c={...d,display:"inline-flex"};return(0,i.jsx)(o.Q,{children:(0,i.jsx)(l.$,{__css:c,"aria-selected":n,leftIcon:t.icon,"aria-label":t.ariaLabel,onClick:()=>a(t),"data-testid":"tab-dropdown-tab-button",isDisabled:t.isDisabled,children:t.label})},t.key)},f=e=>{let{selectedOption:t,setSelectedOption:n,options:r,dropdownButtonLeftIcon:f,dropdownMenuTitle:y,breakpoints:v,size:b="sm",isDisabled:j}=e,w=g.lJ.useGammaBreakpointValue(v||{base:!0,xl:!1});return(0,i.jsx)(o.B,{zIndex:"4",width:["100%","auto"],mt:[4,0],children:w?(0,i.jsxs)(a.W,{closeOnSelect:!0,variant:"tabDropdown",children:[(0,i.jsx)(s.I,{as:l.$,variant:"ghost",size:b,rightIcon:(0,i.jsx)(m.g,{icon:h.Jt$}),fontWeight:"600",...f&&{leftIcon:f},"data-testid":"tab-dropdown-menu",isDisabled:j,children:t.label}),(0,i.jsx)(d.c,{minWidth:"240px",children:(0,i.jsx)(c.i,{defaultValue:t.key,title:y,type:"radio",onChange:e=>{let t=r.find(t=>t.key===e);t&&n(t)},value:t.key,children:r.map(e=>(0,i.jsx)(u.k,{value:e.key,isDisabled:e.isDisabled,children:(0,i.jsxs)(p.z,{alignItems:"center",children:[e.icon,e.label]})},e.key))})})]}):r.map(e=>{let r=e.key===t.key;return(0,i.jsx)(x,{option:e,isSelected:r,setSelectedOption:n,size:b},e.key)})})}},8814:(e,t,n)=>{"use strict";n.d(t,{G:()=>a});var i=n(55729),r=n(91938),o=n(95889),l=n(52860);let a=()=>{let e=(0,i.useRef)(!1),t=(0,i.useRef)(new Map);(0,i.useEffect)(()=>{if("production"!==r.$.APPLICATION_ENVIRONMENT)return;let n=()=>{if(e.current)return;let n=t.current.get("total"),i=t.current.get("notTrusted");i/n>.5&&n>5&&(e.current=!0,l.z.track(o.ng.NOT_TRUSTED_EVENTS_DETECTED,{totalEvents:n,notTrustedEvents:i}))},i=e=>{e.isTrusted||t.current.set("notTrusted",(t.current.get("notTrusted")||0)+1),t.current.set("total",(t.current.get("total")||0)+1),n()};return document.addEventListener("paste",i,{capture:!0}),document.addEventListener("mousedown",i,{capture:!0}),document.addEventListener("keydown",i,{capture:!0}),()=>{document.removeEventListener("paste",i,{capture:!0}),document.removeEventListener("mousedown",i,{capture:!0}),document.removeEventListener("keydown",i,{capture:!0})}},[])}},10817:(e,t,n)=>{"use strict";n.d(t,{b:()=>tN});var i=n(6029),r=n(26420),o=n(34732),l=n(55729),a=n(74158),s=n(91938),d=n(80116),c=n(75074),u=n(48094),p=n(32617),h=n(15342),m=n(85011),g=n(40452),x=n(12514),f=n(91106),y=n(36936),v=n(91792),b=n(84431),j=n(85684),w=n(24302),C=n(89122),I=n(26385),S=n(96500),k=n(68301),A=n(87827),E=n(94740),_=n(66199),R=n(16936),P=n(74676),T=n(18078),z=n(48810),M=n(99492),D=n(48621),O=n(19564),L=n(80180);let N="0px 1px 0px rgba(0,0,0,0)",B="insert-widget-popover";var U=n(58959),F=n(56570),W=n(22905),G=n(88586),V=n(95889),H=n(76083),q=n(64642),K=n(94922),Y=n(43182),X=n(47665),J=n(15607),$=n(84672);let Z=(0,l.memo)(e=>{let{subcategory:t,items:n,editor:r,badge:o,itemGroupLength:l,closeFn:a,hideTooltips:s,smallTitle:d}=e,{isInOfflineMode:c}=(0,G.utY)();return(0,i.jsxs)(I.B,{spacing:2,children:[l>1&&(0,i.jsx)(f._x,{flex:"1",textAlign:"start",ms:1,fontSize:d?"xs":"sm",children:(0,i.jsxs)(U.z,{children:[(0,i.jsx)(z.E,{children:t}),"beta"===o&&(0,i.jsx)(P.E,{colorScheme:"trueblue",children:(0,i.jsx)(O.x6,{id:"YBt9YP"})})]})}),(0,i.jsx)(F.x,{gap:"1.5",gridTemplateColumns:"1fr 1fr 1fr",maxW:"100%",children:n.map(e=>(0,H.gT)(r,e,!1,c)?null:(0,i.jsx)($.p,{item:e,onDragStart:()=>et(e,r,a,s),onDragEnd:t=>ee(e,r,t),onClick:()=>Q(e,r,a,c)},e.key))})]})});Z.displayName="InsertWidgetSubcategory";let Q=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=()=>{n(),(0,H.Jb)(e,V.oU.INSERT_WIDGET),"cardTemplate"===e.type&&(0,q.B)(e.key),e.execute(t)},o=t.view,l=t.state.selection,a=t.state.doc.resolve(l.from),s=(0,W.eL)(a,X.jg),{mostVisible:d,visibleCards:c}=(0,X.lA)(t),u=c.some(e=>e.pos===(null==s?void 0:s.pos)),p=(0,H.gT)(t,e,void 0,i);if(u&&!p)return void r();if(!(0,H.gT)(t,e,!1,i))try{let n=(null==d?void 0:d.pos)?(0,K.dg)(o.state.tr,d.pos):null,i=null==n?void 0:n.body;if(i){let n=i.pos+i.node.nodeSize-1;if(t.commands.setTextSelection(n),!(0,J.Bi)(t,e.nodeName)){let e=i.pos+2;t.commands.setTextSelection(e)}if(!(0,J.Bi)(t,e.nodeName))return}r(),o.dispatch(o.state.tr.scrollIntoView())}catch(e){console.error("[InsertWidget] error in click to insert:",e)}},ee=(e,t,n)=>{n.preventDefault(),n.stopPropagation();let{dragEndFn:i}=e;try{i&&i(t),(0,H.Jb)(e,V.oU.INSERT_WIDGET),"cardTemplate"===e.type&&(0,q.B)(e.key)}catch(e){console.error("[InsertWidget] dragEndFn error:",e)}},et=(e,t,n,i)=>{setTimeout(()=>{n()});let r="card"===e.nodeName?(0,Y.iM)((0,H.GO)()[e.key]):(0,H.GO)()[e.key],o=e.dragStartFn?e.dragStartFn:r?()=>(0,H.fS)(t,r):void 0;if(!o)return void console.error("[InsertWidget] dragStartFn undefined",e);o(t),null==i||i()};var en=n(51684),ei=n(77650),er=n(7957),eo=n(27856),el=n(54678),ea=n(34555),es=n(19250),ed=n(88145),ec=n(11215);let eu="search";var ep=function(e){return e.Cards="cards",e.Images="images",e.Apps="apps",e.Videos="videos",e.Layouts="layouts",e.Text="text",e.Forms="forms",e.Charts="charts",e.SmartDiagrams="Smart diagrams",e}({});let eh={Other:(0,i.jsx)(O.x6,{id:"/IX/7x"}),Tables:(0,i.jsx)(O.x6,{id:"8+4V8D"}),Columns:(0,i.jsx)(O.x6,{id:"jEu4bB"}),"Smart layouts":(0,i.jsx)(O.x6,{id:"uNnHCK"}),Lists:(0,i.jsx)(O.x6,{id:"h16FyT"}),Interactive:(0,i.jsx)(O.x6,{id:"jijeT/"}),Text:(0,i.jsx)(O.x6,{id:"xeiujy"}),Diagrams:(0,i.jsx)(O.x6,{id:"wYoFon"}),"Smart diagrams":(0,i.jsx)(O.x6,{id:"djbazg"}),New:(0,i.jsx)(O.x6,{id:"isRobC"}),"Callout boxes":(0,i.jsx)(O.x6,{id:"uJ8xrP"}),Charts:(0,i.jsx)(O.x6,{id:"A4tHrb"})},em=()=>{let e=(0,H.Vo)(),t=k.of.get("smartDiagrams"),n={cards:{key:"cards",name:ei.Ru._({id:"4z8XKi"}),shortName:ei.Ru._({id:"Ccpbzh"}),subtitle:ei.Ru._({id:"b2o2+V"}),icon:en.HuL,itemGroups:(0,eo.D)()},images:{key:"images",name:ei.Ru._({id:"an5hVd"}),shortName:ei.Ru._({id:"an5hVd"}),subtitle:ei.Ru._({id:"BbyCbN"}),icon:en.Cyq,itemGroups:[{subcategory:eh.Other,items:[...(0,es.D)().filter(e=>"image"===e.nodeName),e.gallery]}]},charts:{key:"charts",name:ei.Ru._({id:"2x61T5"}),shortName:ei.Ru._({id:"A4tHrb"}),subtitle:ei.Ru._({id:"sp3a5R"}),icon:en.s67,itemGroups:[{subcategory:eh.Charts,items:(0,el.V)()},{subcategory:eh.Diagrams,items:(0,ea.A)()}]},apps:{key:"apps",name:ei.Ru._({id:"Nz7jbx"}),shortName:ei.Ru._({id:"aTofd0"}),icon:en.c9S,subtitle:ei.Ru._({id:"iC/G6e"}),itemGroups:[{subcategory:eh.Other,items:[...(0,es.D)().filter(e=>"embed"===e.nodeName&&(!e.categories||e.categories.includes("app")))]}]},videos:{key:"videos",name:ei.Ru._({id:"86kBVB"}),shortName:ei.Ru._({id:"RKuImK"}),subtitle:ei.Ru._({id:"hCcWLL"}),icon:en.OxR,itemGroups:[{subcategory:eh.Other,items:[e.gallery,...(0,es.D)().filter(e=>"video"===e.nodeName)]}]},layouts:{key:"layouts",name:ei.Ru._({id:"uNnHCK"}),shortName:ei.Ru._({id:"yU0QVO"}),subtitle:ei.Ru._({id:"HXUYWx"}),icon:en.sUV,itemGroups:[{subcategory:eh.Columns,items:[e.columns2,e.columns3,e.columns4]},...(0,ec.KF)()]},text:{key:"text",name:ei.Ru._({id:"8nVVMR"}),shortName:ei.Ru._({id:"7s3WlU"}),subtitle:ei.Ru._({id:"l6pR8S"}),icon:en.tiU,itemGroups:[{subcategory:eh.Text,items:[e.title,e.h1,e.h2,e.h3,e.h4,e.blockquote]},{subcategory:eh.Tables,items:[e.table2,e.table3,e.table4]},{subcategory:eh.Lists,items:[e.bulletedList,e.numberedList,e.todoList]},{subcategory:eh["Callout boxes"],items:(0,er.A3)()},{subcategory:eh.Interactive,items:[e.buttonGroup,e.toggle]},{subcategory:eh.Other,items:[e.codeBlock,e.mathBlock,e.footnote,e.contributors,e.tableOfContents,e.divider]}]},forms:{key:"forms",name:ei.Ru._({id:"4Kic3M"}),shortName:ei.Ru._({id:"CiIFml"}),subtitle:ei.Ru._({id:"Gsox27"}),icon:en.tAZ,itemGroups:[{subcategory:eh.Other,items:[e.buttonGroup,...(0,es.D)().filter(e=>{var t;return"embed"===e.nodeName&&(null==(t=e.categories)?void 0:t.includes("form"))})]}]}};return t&&(n["Smart diagrams"]={key:"Smart diagrams",name:ei.Ru._({id:"djbazg"}),shortName:ei.Ru._({id:"muZ1GG"}),subtitle:ei.Ru._({id:"GlXcA3"}),icon:en.Gmj,itemGroups:[{subcategory:eh["Smart diagrams"],items:(0,ed.b)(),badge:"beta",featureFlag:"smartDiagrams"}]}),n},eg=()=>[["text","images","layouts",...k.of.get("smartDiagrams")?["Smart diagrams"]:[],"charts","videos","apps","forms"]],ex=()=>{let e=em();return eg().map(t=>t.map(t=>e[t]).filter(e=>void 0!==e))},ef=()=>({iconColor:(0,w.dU)("deepocean.600","deepocean.200"),hoverColor:(0,w.dU)("gray.50","whiteAlpha.100"),activeColor:(0,w.dU)("gray.200","whiteAlpha.200"),popoverBackgroundColor:(0,w.dU)("titanium.50","titanium.900"),popoverBorderColor:(0,w.dU)("gray.200","whiteAlpha.300"),searchInputIconColor:(0,w.dU)("gray.500","gray.500"),searchInputBorderColor:(0,w.dU)("gray.200","whiteAlpha.200"),searchInputBackgroundColor:(0,w.dU)("whiteAlpha.900","blackAlpha.900"),searchInputTextColor:(0,w.dU)("gray.800","gray.50"),searchInputCloseColorScheme:(0,w.dU)("blackAlpha","gray"),scrollGradientStart:(0,w.dU)("rgba(249, 246, 246, 0)","rgba(0,0,0,0)"),scrollGradientEnd:(0,w.dU)("rgba(249, 246, 246, 1)","rgba(0,0,0,0.9)"),attentionColor:(0,w.dU)("trueblue.200","gray.800"),attentionTextColor:(0,w.dU)("whiteAlpha.900","gray.50")}),ey=(0,l.memo)(e=>{let{icon:t,name:n,subtitle:o,itemGroups:a,editor:s,setOpenButton:d,isOpen:c,insertableCategories:u}=e,p=(0,l.useRef)(null),{GammaTooltipHiderContext:h,hideTooltips:m}=(0,f.ku)(),y=ef(),v=(0,l.useCallback)(()=>{d(null)},[d]);return(0,l.useEffect)(()=>{c&&p.current&&p.current.scrollTo({top:0})},[c]),(0,i.jsxs)(E.A,{placement:"start",isOpen:c,isLazy:!0,lazyBehavior:"keepMounted",returnFocusOnClose:!1,modifiers:[{name:"preventOverflow",enabled:!0,options:{padding:20}}],autoFocus:!1,children:[(0,i.jsx)(f.Tz,{label:n,modifiers:[{name:"offset",options:{offset:[0,-2]}}],shouldWrapChildren:!0,"aria-label":n,placement:"left",portalProps:{appendToParentPortal:!0},children:(0,i.jsx)(_.W,{children:(0,i.jsxs)(r.a,{position:"relative",children:[(0,i.jsx)(R.K,{"aria-label":n,"data-testid":"".concat(n.toLowerCase().split(" ").join("-"),"-widget-inner-button"),size:"md",icon:(0,i.jsx)(D.g,{icon:t}),color:y.iconColor,fontWeight:"500",borderRadius:"md",backdropFilter:"blur(20px)",variant:"undefined",bg:c?y.activeColor:void 0,_hover:{bg:c?y.activeColor:y.hoverColor},textShadow:N,onMouseDown:e=>(s.isFocused&&(0,L.Fw)(e),d(e=>e===n?null:n),!0)}),"Smart diagrams"===n&&(0,i.jsx)(P.E,{position:"absolute",top:"-2px",left:"-10px",colorScheme:"green",fontSize:"2xs",px:1,py:0,borderRadius:"full",pointerEvents:"none",children:(0,i.jsx)(O.x6,{id:"isRobC"})})]})})}),(0,i.jsx)(x.Z,{children:(0,i.jsxs)(T.h,{bg:y.popoverBackgroundColor,borderRadius:"xl",borderColor:y.popoverBorderColor,shadow:"xl",zIndex:"overlay",overflow:"hidden",maxH:"90vh",w:"400px",p:0,me:-.5,className:B,position:"relative","data-insert-widget-popover":!0,children:[(0,i.jsxs)(h,{children:[(0,i.jsx)(r.a,{p:2,borderBottom:"1px solid",borderColor:y.searchInputBorderColor,children:(0,i.jsxs)(f._x,{flex:"1",textAlign:"start",ms:1,children:[(0,i.jsxs)(g.s,{alignItems:"center",children:[(0,i.jsx)(D.g,{icon:t}),(0,i.jsx)(z.E,{ms:2,children:n}),1===a.length&&(0,i.jsx)(i.Fragment,{children:"beta"===a[0].badge&&(0,i.jsx)(P.E,{colorScheme:"trueblue",ms:2,children:(0,i.jsx)(O.x6,{id:"YBt9YP"})})})]}),(0,i.jsx)(z.E,{fontSize:"xs",children:o})]})}),(0,i.jsx)(I.B,{ref:p,overflow:"hidden auto",p:2,pb:a.length>1?8:2,spacing:3,children:a.map((e,t)=>{let{subcategory:n,items:r,badge:o,featureFlag:l}=e;return l&&!k.of.get(l)?null:(0,i.jsx)(Z,{subcategory:n,items:r,badge:o,editor:s,itemGroupLength:a.length,closeFn:v,hideTooltips:m},t)})})]}),u[ep.Layouts].name===n&&(0,i.jsxs)(g.s,{alignItems:"center",gap:2,paddingX:4,paddingY:3,zIndex:1,backgroundColor:y.attentionColor,color:y.attentionTextColor,children:[(0,i.jsx)(D.g,{"aria-label":"Tip",icon:M.mEO}),(0,i.jsx)(z.E,{fontSize:"xs",children:(0,i.jsx)(O.x6,{id:"HVl8F3"})})]}),a.length>1&&(0,i.jsx)(r.a,{h:"12",w:"100%",position:"absolute",bottom:"0",bg:"linear-gradient(to bottom, ".concat(y.scrollGradientStart,", ").concat(y.scrollGradientEnd," 90%)"),pointerEvents:"none"})]})})]})});ey.displayName="InsertWidgetButtons";var ev=n(78686),eb=n(22832),ej=n(72470),ew=n(77979),eC=n(38036),eI=n(24351);let eS=(0,l.memo)(e=>{let{isOpen:t,setOpenButton:n,editor:r,insertableCategoriesListLocalized:o,allFlags:a}=e,s=ef(),d=(0,l.useMemo)(()=>{let e=o.flat().filter(e=>{let{featureFlag:t}=e;return!t||a[t]}),t=e.findIndex(e=>e.key===ep.Cards);if(t>-1){let[n]=e.splice(t,1);e.push(n)}return e},[o,a]),c=(0,l.useCallback)(()=>{n(null)},[n]);return(0,i.jsxs)(E.A,{placement:"start",isOpen:t,isLazy:!0,lazyBehavior:"keepMounted",returnFocusOnClose:!1,modifiers:[{name:"preventOverflow",enabled:!0,options:{padding:20}}],autoFocus:!1,children:[(0,i.jsx)(f.Tz,{label:"Search",modifiers:[{name:"offset",options:{offset:[0,-2]}}],shouldWrapChildren:!0,"aria-label":ei.Ru._({id:"A1taO8"}),placement:"left",portalProps:{appendToParentPortal:!0},children:(0,i.jsx)(_.W,{children:(0,i.jsx)(R.K,{"aria-label":ei.Ru._({id:"A1taO8"}),"data-testid":"".concat(eu,"-widget-inner-button"),size:"md",icon:(0,i.jsx)(D.g,{icon:en.MjD}),color:s.iconColor,fontWeight:"500",borderRadius:"md",backdropFilter:"blur(20px)",variant:"undefined",bg:t?s.activeColor:void 0,_hover:{bg:t?s.activeColor:s.hoverColor},textShadow:N,onMouseDown:e=>(r.isFocused&&(0,L.Fw)(e),n(e=>e===eu?null:eu),!0)})})}),(0,i.jsx)(x.Z,{children:(0,i.jsxs)(T.h,{bg:s.popoverBackgroundColor,borderRadius:"xl",borderColor:s.popoverBorderColor,shadow:"xl",zIndex:"overlay",overflow:"hidden",maxH:"90vh",w:"400px",p:0,me:-.5,className:B,position:"relative","data-insert-widget-popover":!0,children:[(0,i.jsx)(eA,{editor:r,closeFn:c,isOpen:t,insertableCategoriesForSearch:d}),(0,i.jsxs)(g.s,{alignItems:"center",gap:2,paddingX:4,paddingY:3,zIndex:1,backgroundColor:s.attentionColor,color:s.attentionTextColor,children:[(0,i.jsx)(D.g,{"aria-label":ei.Ru._({id:"rm2Cxd"}),icon:M.mEO}),(0,i.jsx)(z.E,{fontSize:"xs",children:(0,i.jsx)(O.x6,{id:"4jZKOY",components:{0:(0,i.jsx)(eb.C,{})}})})]})]})})]})});eS.displayName="SearchAllWidgets";let ek=(0,l.memo)(e=>{let{query:t,onChange:n,isOpen:o}=e,a=ef(),s=(0,l.useRef)(null);return(0,l.useEffect)(()=>{o&&s.current&&setTimeout(()=>{var e;null==s||null==(e=s.current)||e.focus()})},[o]),(0,i.jsx)(r.a,{p:4,borderBottom:"1px solid",borderColor:a.searchInputBorderColor,children:(0,i.jsxs)(ej.M,{size:"md",variant:"outline",children:[(0,i.jsx)(ew.W,{pointerEvents:"none",children:(0,i.jsx)(ev.W,{color:a.searchInputIconColor})}),(0,i.jsx)(eC.p,{ref:s,placeholder:ei.Ru._({id:"W/TXwD"}),value:t,onChange:n,backgroundColor:a.searchInputBackgroundColor,color:a.searchInputTextColor}),t&&(0,i.jsx)(ew.t,{p:4,children:(0,i.jsx)(R.K,{variant:"ghost",colorScheme:a.searchInputCloseColorScheme,size:"xs","aria-label":ei.Ru._({id:"V8yTm6"}),icon:(0,i.jsx)(D.g,{icon:M.Jyw}),onClick:()=>n({target:{value:""}})})})]})})});ek.displayName="SearchInput";let eA=(0,l.memo)(e=>{let{editor:t,closeFn:n,isOpen:r,insertableCategoriesForSearch:o}=e,{GammaTooltipHiderContext:a,hideTooltips:s}=(0,f.ku)(),d=(0,l.useRef)(null),[c,u]=(0,l.useState)(""),p=(0,l.useMemo)(()=>o.map(e=>{let{name:t,itemGroups:n,icon:i,featureFlag:r,subtitle:o}=e,l=n.map(e=>({...e,items:e.items.filter(e=>{let{name:t,keywords:n=[]}=e;return t().toLowerCase().includes(c.toLowerCase())||n.find(e=>e.startsWith(c.toLowerCase()))})})).filter(e=>e.items.length>0);return l.length>0?{name:t,subtitle:o,icon:i,featureFlag:r,itemGroups:l}:null}).filter(Boolean),[o,c]);return(0,l.useEffect)(()=>{r&&d.current&&d.current.scrollTo({top:0})},[r]),(0,l.useEffect)(()=>{r||u("")},[r]),(0,i.jsxs)(a,{children:[(0,i.jsx)(ek,{query:c,onChange:e=>u(e.target.value),isOpen:r}),(0,i.jsxs)(I.B,{p:2,pb:8,spacing:6,h:"100%",overflow:"hidden auto",ref:d,children:[!p.length&&(0,i.jsx)(I.B,{alignItems:"center",justifyContent:"center",h:"100%",pt:20,pb:20,children:(0,i.jsx)(eI.p,{size:"xs",title:(0,i.jsx)(O.x6,{id:"X+k8ml"}),description:(0,i.jsx)(O.x6,{id:"BcZ5cE"})})}),p.map(e=>{let{name:r,itemGroups:o,icon:l,subtitle:a}=e;return(0,i.jsxs)(I.B,{spacing:2,children:[(0,i.jsxs)(f._x,{flex:"1",textAlign:"start",ms:1,children:[(0,i.jsxs)(g.s,{alignItems:"center",children:[(0,i.jsx)(D.g,{icon:l}),(0,i.jsx)(z.E,{ms:2,children:r})]}),(0,i.jsx)(z.E,{fontSize:"xs",children:a})]}),o.map((e,r)=>{let{subcategory:l,items:a}=e;return(0,i.jsx)(Z,{smallTitle:!0,subcategory:l,items:a,editor:t,itemGroupLength:o.length,closeFn:n,hideTooltips:s},r)})]},r)})]})]})});eA.displayName="SearchAllWidgetsContent";let eE=e=>{let{editor:t}=e,n=(0,A.n)(ex),r=(0,k.mt)(),[o,a]=l.useState(null),s=(0,l.useRef)(null),d={bg:(0,w.dU)("white","elevation.3"),border:(0,w.dU)("titanium.100","titanium.900"),text:(0,w.dU)("titanium.900","titanium.300")},c=(0,l.useMemo)(()=>em(),[]);return(0,C.j)({ref:s,handler:e=>{e.target.closest("[data-insert-widget-popover]")||a(null)}}),(0,i.jsxs)(I.B,{bg:d.bg,color:d.text,p:.5,borderWidth:"1px",borderColor:d.border,borderRadius:"md",shadow:"lg",ref:s,spacing:1,children:[(0,i.jsx)(eS,{setOpenButton:a,isOpen:"search"===o,editor:t,insertableCategoriesListLocalized:n,allFlags:r}),n.map((e,n)=>(0,i.jsxs)(l.Fragment,{children:[n>0&&(0,i.jsx)(S.c,{}),e.map(e=>{let{name:n,shortName:r,itemGroups:l,icon:s,subtitle:d,key:u}=e;return(0,i.jsx)(ey,{itemGroups:l,icon:s,name:n,shortName:r,subtitle:d,editor:t,setOpenButton:a,isOpen:o===n,insertableCategories:c},u)})]},n))]})},e_=e=>{let{editor:t}=e;return(0,j.R)()?(0,i.jsx)(g.s,{position:"fixed",w:"0%",h:"0%",insetInlineEnd:4,top:"50%",alignItems:"center",zIndex:b.$.insertWidget,"data-testid":"insert-widget-wrapper",children:(0,i.jsx)(g.s,{position:"absolute",insetInlineEnd:0,"data-guider-highlight":"insert-widget",direction:"column",className:"insert-widget",children:(0,i.jsx)(eE,{editor:t})})}):null},eR=(0,l.memo)(e=>{let{editor:t}=e,[n,r]=(0,l.useState)(!1),o=(0,v.rd)();return((0,l.useEffect)(()=>y.R.on("bringInsertWidgetToFront",e=>{let{inFront:t}=e;r(t)}),[]),n)?(0,i.jsx)(f.L8,{isDark:o,children:(0,i.jsx)(x.Z,{children:(0,i.jsx)(e_,{editor:t})})}):(0,i.jsx)(f.L8,{isDark:o,children:(0,i.jsx)(e_,{editor:t})})});var eP=n(22249),eT=n(26886),ez=n(34807),eM=n(43634),eD=n(85235);let eO=(e,t,n)=>{let[i,r]=(0,l.useState)(!1),[o,a]=(0,l.useState)(!1),s=(0,l.useRef)(),d=(0,l.useCallback)(t=>{r(!0),e(t)},[e]),c=(0,l.useCallback)(e=>{r(!1),a(!1),t(e)},[t]),u=(0,l.useCallback)(e=>{s.current instanceof HTMLElement&&s.current.focus(),n(e)},[n]);return{isDragging:i,isMouseDown:o,handleDragStart:d,handleDragEnd:c,handleClick:u,onMouseDown:(0,l.useCallback)(()=>{a(!0),s.current=document.activeElement||void 0},[]),onMouseUp:(0,l.useCallback)(()=>{a(!1)},[])}},eL=()=>{let[e]=(0,eT.U)(["(max-height: 400px)","(min-height: 401px"]),t=(0,h.GV)(eM.nD),n=(0,h.GV)(eM.cS),i=(0,ez.A)({base:!1,lg:!0}),r=(0,h.GV)(eM.wC);return t&&!e&&!n&&i&&r!==eD.w.SLIDE_VIEW};var eN=n(72316);let eB="insert-widget-popover";var eU=n(49611);let eF=()=>({textColor:(0,w.dU)("gray.800","gray.50"),iconColor:(0,w.dU)("trueblue.600","trueblue.200"),hoverColor:(0,w.dU)("gray.50","whiteAlpha.100"),activeColor:(0,w.dU)("gray.200","whiteAlpha.200"),popoverBackgroundColor:(0,w.dU)("titanium.50","titanium.900"),popoverBorderColor:(0,w.dU)("gray.200","whiteAlpha.300"),searchInputIconColor:(0,w.dU)("gray.500","gray.500"),searchInputBorderColor:(0,w.dU)("gray.200","whiteAlpha.200"),searchInputBackgroundColor:(0,w.dU)("whiteAlpha.900","blackAlpha.900"),searchInputTextColor:(0,w.dU)("gray.800","gray.50"),searchInputCloseColorScheme:(0,w.dU)("blackAlpha","gray"),scrollGradientStart:(0,w.dU)("rgba(249, 246, 246, 0)","rgba(0,0,0,0)"),scrollGradientEnd:(0,w.dU)("rgba(249, 246, 246, 1)","rgba(0,0,0,0.9)"),attentionColor:(0,w.dU)("trueblue.200","gray.800"),attentionTextColor:(0,w.dU)("whiteAlpha.900","gray.50"),bg:(0,w.dU)("gray.50","gray.800"),border:(0,w.dU)("blackAlpha.100","whiteAlpha.200"),dividerColor:(0,w.dU)("blackAlpha.200","whiteAlpha.200")}),eW=(0,l.forwardRef)((e,t)=>{let{testId:n,icon:r,label:o,onClick:l,isOpen:a,editor:s}=e,d=eF();return(0,i.jsxs)(eU.$,{ref:t,"aria-label":o,"data-testid":"".concat(n,"-widget-inner-button"),size:"lg",color:d.iconColor,fontWeight:"500",borderRadius:"md",variant:"undefined",bg:a?d.activeColor:void 0,_hover:{bg:a?d.activeColor:d.hoverColor},textShadow:"0px 1px 0px rgba(0,0,0,0)",onMouseDown:e=>(s.isFocused&&(0,L.Fw)(e),l(),!0),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:2,width:65,height:65,transition:"height 0.2s ease-in-out",role:"button",children:[(0,i.jsx)(D.g,{icon:r,size:"lg","aria-hidden":"true"}),(0,i.jsx)(z.E,{fontSize:"xs",fontWeight:"medium",mt:2,color:d.textColor,textAlign:"center",maxW:"60px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxHeight:"20px","aria-hidden":"true",children:o})]})});eW.displayName="InsertWidgetButton";var eG=n(33787),eV=n(55597),eH=n(50507),eq=n(9455);let eK=e=>{let{item:t}=e,{name:n,image:o,icon:l,key:a,previewImage:s,shortcut:d,badge:c}=t,u=(0,eH.iT)(),{colorMode:p}=(0,w.G6)(),h={iconColor:(0,w.dU)("trueblue.600","trueblue.100"),bgColor:(0,w.dU)("white","gray.800"),textColor:(0,w.dU)("gray.700","gray.50"),borderColor:(0,w.dU)("gray.200","gray.600"),invertFilter:(0,w.dU)("invert(0)","invert(.7) brightness(1.4) hue-rotate(180deg)"),iconBgColor:(0,w.dU)("white","gray.700"),gripDotsColor:(0,w.dU)("gray.500","gray.500")};return(0,i.jsxs)(I.B,{h:"100%",bg:h.bgColor,p:2.5,pt:2,spacing:1.5,alignItems:"center",shadow:"sm",borderRadius:"xl",border:"1px",borderColor:h.borderColor,role:"group",children:[(0,i.jsx)(g.s,{justifyContent:"center",alignItems:"center",minH:"7",w:"100%",children:"cardTemplate"===t.type&&u[a]?(0,i.jsx)(eq.LK,{content:u[a].jsonContent,isDark:"dark"===p}):s?(0,i.jsx)(g.s,{bg:h.iconBgColor,borderRadius:"md",children:(0,i.jsx)(eG._,{filter:h.invertFilter,src:s.src,w:"100%",maxW:"100%",alt:n(),pointerEvents:"none"})}):o?(0,i.jsx)(eG._,{src:o.src,borderRadius:"sm",h:"1.5em",w:"1.5em",objectFit:"contain",pointerEvents:"none"}):(0,i.jsx)(r.a,{color:h.iconColor,fontSize:"xl",children:l&&(0,i.jsx)(D.g,{icon:l})})}),c&&(0,i.jsx)(P.E,{position:"absolute",top:"1",insetEnd:"2",colorScheme:"green",children:c()}),(0,i.jsxs)(I.B,{spacing:0,whiteSpace:"break-spaces",flex:"1",textAlign:"center",children:[(0,i.jsx)(z.E,{color:h.textColor,fontWeight:"600",fontSize:"xs",lineHeight:1.2,noOfLines:2,children:n()}),d&&(0,i.jsx)(z.E,{fontSize:"xs",color:"gray.500",fontWeight:"500",children:d})]})]})},eY=e=>{let{item:t,onDragStart:n,onDragEnd:o,onClick:l}=e,{isDragging:a,isMouseDown:s,handleDragStart:d,handleDragEnd:c,handleClick:u,onMouseDown:p,onMouseUp:h}=eO(n,o,l),{key:m,description:g}=t,x={gripDotsBg:(0,w.dU)("white","gray.800"),gripDotsColor:(0,w.dU)("gray.500","gray.500")};return(0,i.jsx)(f.Tz,{closeOnMouseDown:!0,closeOnClick:!0,isOpen:!a&&void 0,label:(0,i.jsxs)(r.a,{as:"span",display:"inline",children:[(0,i.jsx)(D.g,{icon:M.bFI})," ",(0,i.jsx)(z.E,{display:"inline",children:(0,i.jsx)(O.x6,{id:"Dd9uag"})}),g&&(0,i.jsx)(z.E,{textAlign:"start",color:"gray.300",maxW:"170px",children:g()})]}),"aria-label":ei.Ru._({id:"Dd9uag"}),placement:"top",children:(0,i.jsxs)(I.B,{"data-testid":"".concat(m,"-insert-button"),draggable:!0,onDragStart:d,onDragEnd:c,onClick:u,onMouseDown:p,onMouseUp:h,onMouseLeave:h,cursor:"grab",_hover:{transform:"scale(1.05) rotate(-0.25deg)",shadow:"lg"},transitionProperty:"common",transitionDuration:"normal",transform:"rotate(".concat(s&&!a?-1:0,"deg) translate(0, 0);"),role:"group",borderRadius:"xl",children:[(0,i.jsx)(eK,{item:t}),(0,i.jsx)(r.a,{opacity:0,_groupHover:{opacity:1},transitionProperty:"opacity",transitionDuration:"normal",position:"absolute",top:"0",insetStart:"1.5",bg:x.gripDotsBg,color:x.gripDotsColor,borderRadius:"sm",fontSize:"sm",children:(0,i.jsx)(D.g,{icon:eV.IMq,fixedWidth:!0})})]})})},eX=(0,l.memo)(e=>{let{subcategory:t,items:n,editor:r,itemGroupLength:o,closeFn:l,hideTooltips:a}=e,{isInOfflineMode:s}=(0,G.utY)();return(0,i.jsxs)(I.B,{spacing:2,children:[(0,i.jsx)(f._x,{flex:"1",textAlign:"start",ms:1,fontSize:"xs",children:o>1&&t}),(0,i.jsx)(F.x,{gap:"1.5",gridTemplateColumns:"1fr 1fr 1fr 1fr",maxW:"100%",children:n.map(e=>(0,H.gT)(r,e,!1,s)?null:(0,i.jsx)(eY,{item:e,onDragStart:()=>et(e,r,l,a),onDragEnd:t=>ee(e,r,t),onClick:()=>Q(e,r,l,s)},e.key))})]})});eX.displayName="InsertWidgetSubcategory";let eJ=(0,l.memo)(e=>{let{icon:t,name:n,shortName:o,subtitle:a,itemGroups:s,editor:d,setOpenButton:c,isOpen:u,containerRef:p}=e,[h,m]=(0,l.useState)(null),y=(0,l.useRef)(null),{GammaTooltipHiderContext:v,hideTooltips:b}=(0,f.ku)(),j=eF(),{styles:w,attributes:C}=(0,eN.E)(p.current,h,{placement:"top-start",modifiers:[{name:"offset",options:{offset:[0,8]}},{name:"preventOverflow",options:{padding:20,boundary:document.body}},{name:"flip",options:{fallbackPlacements:["bottom-start","right-start","left-start"]}}]}),S=(0,l.useCallback)(()=>{c(null)},[c]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Tz,{label:a,shouldWrapChildren:!0,"aria-label":a,placement:"bottom",portalProps:{appendToParentPortal:!0},children:(0,i.jsx)("div",{ref:y,children:(0,i.jsx)(eW,{testId:n,icon:t,label:o,onClick:()=>{u?S():c(n)},isOpen:u,editor:d})})}),u&&(0,i.jsx)(x.Z,{children:(0,i.jsxs)(I.B,{ref:m,style:{...w.popper},backgroundColor:j.popoverBackgroundColor,borderRadius:"var(--chakra-radii-xl)",borderColor:j.popoverBorderColor,borderWidth:"1px",boxShadow:"var(--chakra-shadows-xl)",zIndex:"var(--chakra-zIndices-overlay)",overflow:"hidden",maxHeight:"50vh",width:"625px",padding:0,marginEnd:"-0.5rem",position:"relative",className:eB,"data-insert-widget-popover":!0,...C.popper,children:[(0,i.jsxs)(v,{children:[(0,i.jsx)(r.a,{p:2,borderBottom:"1px solid",borderColor:j.searchInputBorderColor,children:(0,i.jsx)(f._x,{flex:"1",textAlign:"start",ms:1,children:(0,i.jsxs)(g.s,{alignItems:"center",children:[(0,i.jsx)(D.g,{icon:t}),(0,i.jsxs)(z.E,{ms:2,fontSize:"xs",children:[n,"\xa0"]}),(0,i.jsxs)(z.E,{fontSize:"xxs",color:"gray.500",children:["| ",a]})]})})}),(0,i.jsx)(I.B,{ref:e=>{e&&u&&setTimeout(()=>{e&&e.scrollTo({top:0})},0)},overflow:"hidden auto",p:2,pb:s.length>1?8:2,spacing:3,children:s.map((e,t)=>{let{subcategory:n,items:r}=e;return(0,i.jsx)(eX,{subcategory:n,items:r,editor:d,itemGroupLength:s.length,closeFn:S,hideTooltips:b},t)})})]}),s.length>1&&(0,i.jsx)(r.a,{h:"12",w:"100%",position:"absolute",bottom:"0",bg:"linear-gradient(to bottom, ".concat(j.scrollGradientStart,", ").concat(j.scrollGradientEnd," 90%)"),pointerEvents:"none"})]})})]})});eJ.displayName="InsertWidgetButtons";let e$=(0,l.memo)(e=>{let{isOpen:t,setOpenButton:n,editor:r,insertableCategoriesListLocalized:o,allFlags:a,containerRef:s}=e,d=eF(),c=(0,l.useRef)(null),[u,p]=(0,l.useState)(null),{styles:h,attributes:m}=(0,eN.E)(s.current,u,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,8]}}]}),g=(0,l.useMemo)(()=>{let e=o.flat().filter(e=>{let{featureFlag:t}=e;return!t||a[t]}),t=e.findIndex(e=>e.key===ep.Cards);if(t>-1){let[n]=e.splice(t,1);e.push(n)}return e},[o,a]),y=(0,l.useCallback)(()=>{n(null)},[n]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Tz,{label:"Search",shouldWrapChildren:!0,"aria-label":ei.Ru._({id:"A1taO8"}),placement:"top",portalProps:{appendToParentPortal:!0},children:(0,i.jsx)("div",{ref:c,children:(0,i.jsx)(eW,{testId:eu,icon:en.MjD,label:ei.Ru._({id:"A1taO8"}),onClick:()=>{t?y():n(eu)},isOpen:t,editor:r})})}),t&&(0,i.jsx)(x.Z,{children:(0,i.jsx)(I.B,{ref:p,style:{...h.popper},backgroundColor:d.popoverBackgroundColor,borderRadius:"var(--chakra-radii-xl)",borderColor:d.popoverBorderColor,borderWidth:"1px",boxShadow:"var(--chakra-shadows-xl)",zIndex:"var(--chakra-zIndices-overlay)",overflow:"hidden",maxHeight:"50vh",width:"625px",padding:0,marginEnd:"-0.5rem",position:"relative",className:eB,"data-insert-widget-popover":!0,...m.popper,children:(0,i.jsx)(eQ,{editor:r,closeFn:y,isOpen:t,insertableCategoriesForSearch:g})})})]})});e$.displayName="SearchAllWidgets";let eZ=(0,l.memo)(e=>{let{query:t,onChange:n,isOpen:o}=e,a=eF(),s=(0,l.useRef)(null);return(0,l.useEffect)(()=>{o&&s.current&&setTimeout(()=>{var e;null==s||null==(e=s.current)||e.focus()})},[o]),(0,i.jsx)(r.a,{p:4,borderBottom:"1px solid",borderColor:a.searchInputBorderColor,children:(0,i.jsxs)(ej.M,{size:"md",variant:"outline",children:[(0,i.jsx)(ew.W,{pointerEvents:"none",children:(0,i.jsx)(ev.W,{color:a.searchInputIconColor})}),(0,i.jsx)(eC.p,{ref:s,placeholder:ei.Ru._({id:"W/TXwD"}),value:t,onChange:n,backgroundColor:a.searchInputBackgroundColor,color:a.searchInputTextColor}),t&&(0,i.jsx)(ew.t,{p:4,children:(0,i.jsx)(R.K,{variant:"ghost",colorScheme:a.searchInputCloseColorScheme,size:"xs","aria-label":ei.Ru._({id:"V8yTm6"}),icon:(0,i.jsx)(D.g,{icon:M.Jyw}),onClick:()=>n({target:{value:""}})})})]})})});eZ.displayName="SearchInput";let eQ=(0,l.memo)(e=>{let{editor:t,closeFn:n,isOpen:o,insertableCategoriesForSearch:a}=e,{GammaTooltipHiderContext:s,hideTooltips:d}=(0,f.ku)(),c=eF(),u=(0,l.useRef)(null),[p,h]=(0,l.useState)(""),m=(0,l.useMemo)(()=>a.map(e=>{let{name:t,itemGroups:n,icon:i,featureFlag:r,subtitle:o}=e,l=n.map(e=>({...e,items:e.items.filter(e=>{let{name:t,keywords:n=[]}=e;return t().toLowerCase().includes(p.toLowerCase())||n.find(e=>e.startsWith(p.toLowerCase()))})})).filter(e=>e.items.length>0);return l.length>0?{name:t,subtitle:o,icon:i,featureFlag:r,itemGroups:l}:null}).filter(Boolean),[a,p]);return(0,l.useEffect)(()=>{o&&u.current&&u.current.scrollTo({top:0})},[o]),(0,l.useEffect)(()=>{o||h("")},[o]),(0,i.jsxs)(s,{children:[(0,i.jsx)(eZ,{query:p,onChange:e=>h(e.target.value),isOpen:o}),(0,i.jsxs)(I.B,{ref:e=>{e&&o&&setTimeout(()=>{e&&e.scrollTo({top:0})},0)},overflow:"hidden auto",p:2,pb:8,spacing:3,children:[!m.length&&(0,i.jsx)(I.B,{alignItems:"center",justifyContent:"center",h:"100%",pt:20,pb:20,children:(0,i.jsx)(eI.p,{size:"xs",title:(0,i.jsx)(O.x6,{id:"X+k8ml"}),description:(0,i.jsx)(O.x6,{id:"kXnLEt"})})}),m.map(e=>{let{name:r,itemGroups:o,icon:l,subtitle:a}=e;return(0,i.jsxs)(I.B,{spacing:2,children:[(0,i.jsx)(f._x,{flex:"1",textAlign:"start",ms:1,children:(0,i.jsxs)(g.s,{alignItems:"center",children:[(0,i.jsx)(D.g,{icon:l}),(0,i.jsxs)(z.E,{ms:2,fontSize:"xs",children:[r,"\xa0"]}),(0,i.jsxs)(z.E,{fontSize:"xxs",color:"gray.500",children:["| ",a]})]})}),o.map((e,r)=>{let{subcategory:l,items:a}=e;return(0,i.jsx)(eX,{subcategory:l,items:a,editor:t,itemGroupLength:o.length,closeFn:n,hideTooltips:d},r)})]},r)})]}),(0,i.jsx)(r.a,{h:"12",w:"100%",position:"absolute",bottom:"0",bg:"linear-gradient(to bottom, ".concat(c.scrollGradientStart,", ").concat(c.scrollGradientEnd," 90%)"),pointerEvents:"none"})]})});eQ.displayName="SearchAllWidgetsContent";let e0=e=>{let{editor:t}=e,n=(0,A.n)(ex),r=(0,k.mt)(),[o,a]=l.useState(null),s=(0,l.useRef)(null),d=eF();return(0,C.j)({ref:s,handler:e=>{e.target.closest("[data-insert-widget-popover]")||a(null)}}),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(U.z,{bg:d.bg,color:d.iconColor,p:.5,borderWidth:"1px",borderColor:d.border,borderRadius:"md",shadow:"lg",ref:s,overflow:"hidden",spacing:1,"data-testid":"insert-widget-inner",pointerEvents:"auto",children:[(0,i.jsx)(e$,{setOpenButton:a,isOpen:"search"===o,editor:t,insertableCategoriesListLocalized:n,allFlags:r,containerRef:s}),n.map((e,n)=>(0,i.jsxs)(l.Fragment,{children:[n>0&&(0,i.jsx)(S.c,{borderColor:d.dividerColor}),e.map(e=>{let{name:n,shortName:l,itemGroups:d,icon:c,featureFlag:u,subtitle:p,key:h}=e;return u&&!r[u]?null:(0,i.jsx)(eJ,{itemGroups:d,icon:c,name:n,shortName:l,subtitle:p,editor:t,setOpenButton:a,isOpen:o===n,containerRef:s},h)})]},n))]})})},e1=e=>{let{editor:t}=e,n=eL(),r=(0,h.GV)((0,eP.lp)("left")),o=(0,h.GV)((0,eP.lp)("right"));return n?(0,i.jsx)(g.s,{position:"fixed",paddingLeft:"calc(var(--doc-padding-left) + ".concat(r,"px)"),paddingRight:"calc(var(--doc-padding-right) + ".concat(o,"px)"),bottom:"30px",insetStart:0,insetEnd:0,align:"center",alignItems:"center",justifyContent:"center",zIndex:"sticky","data-testid":"insert-widget-wrapper",pointerEvents:"none",children:(0,i.jsx)(g.s,{position:"relative","data-guider-highlight":"insert-widget",direction:"row",className:"insert-widget",children:(0,i.jsx)(e0,{editor:t})})}):null},e6=(0,l.memo)(e=>{let{editor:t}=e,[n,r]=(0,l.useState)(!1),o=(0,v.rd)();return((0,l.useEffect)(()=>y.R.on("bringInsertWidgetToFront",e=>{let{inFront:t}=e;r(t)}),[]),n)?(0,i.jsx)(f.L8,{isDark:o,children:(0,i.jsx)(x.Z,{children:(0,i.jsx)(e1,{editor:t})})}):(0,i.jsx)(f.L8,{isDark:o,children:(0,i.jsx)(e1,{editor:t})})});var e2=n(91242),e5=n(82927),e4=n(11403),e8=n(49251),e3=n(45373),e9=n(90184),e7=n(62590),te=n(77711);let tt=(0,l.memo)(e=>{let{editor:t}=e,n=k.of.get("arrowAutocomplete"),[r,o]=(0,l.useState)(null),[a,s]=(0,l.useState)(null),{hideTooltips:d,GammaTooltipHiderContext:c}=(0,f.ku)();return((0,l.useEffect)(()=>{t&&t.commands.command(e=>{let{tr:t}=e;return t.setMeta(te.f,{buttonElement:a,tippyTarget:r,onHide:d}),!0})},[t,r,a,d]),n)?(0,i.jsx)("div",{ref:o,style:{visibility:"hidden"},children:(0,i.jsx)(g.s,{ref:s,children:(0,i.jsx)(c,{children:(0,i.jsx)(tn,{editor:t})})})}):null});tt.displayName="AutocompleteButton";let tn=e=>{let{editor:t}=e,n=(0,h.GV)(eM.SJ),r=(0,v.rd)(),[o,a]=(0,l.useState)(r);return(0,l.useEffect)(()=>{if(!t)return;let e=()=>{let e=(0,e7.e)(t,n);a(void 0!==e?e:r)};return e(),t.on("selectionUpdate",e),()=>{t.off("selectionUpdate",e)}},[t,r,n]),(0,i.jsx)(f.L8,{isDark:o,children:(0,i.jsx)(f.Tz,{label:(0,i.jsxs)(U.z,{gap:.5,children:[(0,i.jsx)(z.E,{children:ei.Ru._({id:"ZyVTQp"})}),(0,i.jsx)(e9.G,{type:"autocomplete",bg:"transparent",p:0}),(0,i.jsx)(f.iM,{shortcut:"Tab"})]}),placement:"top",children:(0,i.jsx)(eU.$,{variant:"plain",size:"xs",padding:"1px 2px",borderRadius:"4px",background:"none",fontSize:"0.7em",transition:"var(--chakra-transition-property-colors)",children:(0,i.jsx)(D.g,{icon:M.up_})})})})};var ti=n(12417),tr=n(40240),to=n(24037);let tl=(0,l.memo)(e=>{let{editor:t,getNodePos:n,children:r,tippyOptions:o}=e,[a,s]=(0,l.useState)(null),[d,c]=(0,l.useState)(null);return(0,l.useEffect)(()=>{t&&t.commands.command(e=>{let{tr:t}=e;return t.setMeta(to.X,{element:d,tippyTarget:a,getNodePos:n,tippyOptions:o}),!0})},[t,d,a,n,o]),(0,i.jsx)("div",{ref:s,style:{visibility:"hidden"},id:"gamma-bubble-menu",children:(0,i.jsx)("div",{ref:c,children:r})})});tl.displayName="GammaBubbleMenu";var ta=n(23050);let ts=(0,l.memo)(e=>{let{editor:t}=e;return k.of.get("arrowAutocomplete")?(0,i.jsx)(tl,{editor:t,getNodePos:()=>{let e=ta.nD.getState(t.view.state),n=t.view.state.selection;return e&&e.insertedRange&&null!==e.insertedRange.to&&e.insertedRange.to===n.from?e.insertedRange.to:null},tippyOptions:{placement:"bottom",hideOnClick:!1,offset:[0,5]},children:(0,i.jsx)(td,{editor:t})}):null});ts.displayName="AutocompleteFeedback";let td=e=>{let{editor:t}=e,n=(0,h.GV)(eM.SJ),r=(0,v.rd)(),[o,a]=(0,l.useState)(r),[s,d]=(0,l.useState)(null),[c,u]=(0,l.useState)(!1),p=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(!t)return;let e=()=>{d(null);let e=(0,e7.e)(t,n);a(void 0!==e?e:r);let i=ta.nD.getState(t.view.state),o=i&&i.insertedRange&&null!==i.insertedRange.from;u(null!=o&&o)};return e(),t.on("selectionUpdate",e),()=>{t.off("selectionUpdate",e)}},[t,r,n]),(0,C.j)({ref:p,handler:e=>{let n=e.target.closest("[data-rating-buttons]"),i=e.target.closest("[data-rating-popover]");if(n||i)return;let r=ta.nD.getState(t.view.state);r&&r.insertedRange&&null!==r.insertedRange.from&&t.commands.setMeta("autocompleteEvent",{type:"reset"})}});let m=(0,l.useCallback)((e,n,i)=>{var r;let o=null==(r=te.f.getState(t.state))?void 0:r.interactionId;(0,tr.xj)({feedback:n,tags:i,rating:e,interactionId:o})},[t]),x=(0,l.useCallback)(e=>{var n;let i=null==(n=te.f.getState(t.state))?void 0:n.interactionId;d(e),(0,tr.Dx)({rating:e,interactionId:i})},[t]);return(console.log("shouldShow",c),c)?(0,i.jsx)(f.L8,{isDark:o,children:(0,i.jsx)(g.s,{ref:p,backgroundColor:o?"gray.800":"gray.200",p:1,borderRadius:"md",position:"relative",_before:{content:'""',position:"absolute",top:"-4px",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderBottom:"4px solid ".concat(o?"var(--chakra-colors-gray-800)":"var(--chakra-colors-gray-200)")},children:(0,i.jsx)(ti.f3,{rating:s||void 0,setRating:x,trackFeedback:m,RatingButtons:ti.Ep,feedbackTags:tc(),size:"xs"})})}):null},tc=()=>[{key:"too-long",label:(0,i.jsx)(O.x6,{id:"yIsdT7"})},{key:"too-short",label:(0,i.jsx)(O.x6,{id:"CALFDl"})},{key:"didnt-follow-prompt",label:(0,i.jsx)(O.x6,{id:"xZPdUv"})},{key:"wrong-formatting",label:(0,i.jsx)(O.x6,{id:"4xQrPc"})}];var tu=n(72688),tp=n(61385),th=n(87930);let tm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body";(0,l.useEffect)(()=>{let t,n=document.querySelector(e);if(!n)return;let i=e=>{var i,r;(null==(i=document.activeElement)?void 0:i.tagName)==="IFRAME"&&document.activeElement instanceof HTMLIFrameElement&&!t?(console.debug("[EditorCore] Prevented scrolling at page load from iframe",e,document.activeElement),n.scrollTo(0,0),document.activeElement.blur()):(null==(r=document.activeElement)?void 0:r.tagName)==="IFRAME"&&0===e.target.scrollTop&&t>50?(console.debug("[EditorCore] Prevented scrolling to top from iframe",e,t,document.activeElement),n.scrollTo(0,t)):t=e.target.scrollTop};return n.addEventListener("scroll",i,{passive:!0}),()=>n.removeEventListener("scroll",i)},[e])};var tg=n(43607),tx=n(30524),tf=n(18934),ty=n(73071),tv=n(41896),tb=n(95081),tj=n(53996),tw=n(80314),tC=n(24926),tI=n(83004),tS=n(55452),tk=n(30645),tA=n(1079),tE=n(49337),t_=n(37605);class tR extends l.Component{static getDerivedStateFromError(e){return{hasError:!0,errMessage:e.message}}componentDidCatch(e,t){this.errorEventId=tS.Cp(e,{extra:{info:null==t?void 0:t.componentStack}}),tC.yf.logger.error("[EditorCoreErrorBoundary]",{event:t_.ng.EDITOR_CORE_ERROR,docId:this.props.docId},e)}render(){return this.state.hasError?(0,i.jsx)(tT,{errMessage:this.state.errMessage,errorId:this.errorEventId,isInsideDrawer:this.props.isInsideDrawer}):this.props.children}constructor(e){super(e),this.errorEventId=null,this.state={hasError:!1,errMessage:""}}}let tP=["collaborative-editor-wrapper","public-static-editor-wrapper-inner","example-static-editor-wrapper-inner","custom-theme-tabs","custom-theme-tab-panels","custom-theme-preview-editor"].map(e=>'[data-testid="'.concat(e,'"]')).join(", "),tT=e=>{let{errMessage:t,errorId:n,isInsideDrawer:r=!1}=e,o=(0,p.u)("intercom"),l=(0,tE.k)();return(0,i.jsxs)(g.s,{minH:"100%",direction:"column","data-editor-error-component":!0,align:"center",children:[(0,i.jsx)(tI.mL,{styles:{[tP]:{height:"100%"},html:{height:"100%"},body:{height:"100%"}}}),(0,i.jsx)(tj.o,{flex:1,w:"100%",px:6,children:(0,i.jsxs)(tk.K,{title:(0,i.jsx)(O.x6,{id:"q54tkL"}),message:(0,i.jsx)(O.x6,{id:"qeLWZE"}),stackProps:{maxWidth:"min(450px, 100%)"},children:[t&&(0,i.jsxs)(eb.C,{display:"block",py:1,px:{base:4,md:12},maxW:"100%",children:[t,n&&(0,i.jsx)(O.x6,{id:"sS1P4/",values:{errorId:n},components:{0:(0,i.jsx)("br",{})}})]}),!r&&(0,i.jsxs)(U.z,{wrap:"wrap",justifyContent:"center",pb:4,spacing:3,mt:2,children:[(0,i.jsx)(eU.$,{variant:"solid",onClick:()=>{window.location.reload()},leftIcon:(0,i.jsx)(D.g,{fixedWidth:!0,icon:M.lLb}),children:(0,i.jsx)(O.x6,{id:"SnHWX8"})}),(0,i.jsx)(eU.$,{variant:"plain",onClick:o?l:void 0,leftIcon:(0,i.jsx)(D.g,{fixedWidth:!0,icon:o?M.gSF:M.y_8}),as:o?tw.N:void 0,href:o?void 0:"mailto:".concat(tA.J),children:(0,i.jsx)(O.x6,{id:"mpby9d"})})]})]})})]})};var tz=n(64072),tM=n(76610);let tD=e=>new Promise(t=>{setTimeout(()=>{requestAnimationFrame(()=>{let n=e.state.doc.resolve(1),i=(0,e2.s)(n,1,!0);i&&e.commands.command(e=>{let{tr:t}=e;return t.setSelection(i),!0}),t()})})}),tO=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=(0,m.O2)("editor"),i=(0,h.GV)(t=>{let n=(0,eM.wC)(t),i=(0,eM.$i)(t);return n===eD.w.SLIDE_VIEW&&i?(0,tp.OB)(i):e});(0,l.useEffect)(()=>{t&&i&&n.setScrollSelector(i)},[t,n,i])},tL=e=>{let{onCreate:t=()=>{},extensions:n=[],readOnly:m=!0,shouldSupportComments:g=!1,shouldSupportMenus:x=!1,initialContent:f,doc:y,docId:v,isStatic:b=!1,animationsEnabled:j=!0,scrollingParentSelector:w,theme:C,editorId:I,isThumbnail:S}=e,k=(0,e5.Iy)("edit",y),A=(null==y?void 0:y.organization)&&y.organization.id,[E]=(0,l.useState)(x),[_,R]=(0,l.useState)(!1),P=(0,a.wA)(),T=(0,h.GV)(eM.Cl),z=(0,l.useMemo)(()=>(0,tz.C)(),[]),M=(0,o.I)(),D=(0,p.u)("debugLogging"),O=!!(null==y?void 0:y.site),{setEditorRendered:L,onEditorUnload:N}=(0,ty.f)(I);tm(w),tO(w,!b);let B=(0,tv.hG)({async onCreate(e){let{editor:t}=e;console.debug("[EditorCore][onCreate] TipTap editor is now ready"),(0,tM.m)(t,P),R(!0)},onUpdate(e){var t,n;let{editor:i}=e;null==(t=th.U.getState(i.state))||t.processChanges(P),null==(n=tu.Jl.getState(i.state))||n.processChanges(P)},onSelectionUpdate(e){let{editor:t}=e;console.debug("[EditorCore][onSelectionUpdate] selection updated",t.state.selection.from,t.state.selection.to,t.state.selection)},onDestroy(){D&&console.warn("[EditorCore][onDestroy] This should only happen on page navigation."),N(),P((0,eM.cL)()),P((0,c.qq)())},extensions:z.concat(n),content:f,editable:!1});S&&(B.isThumbnail=!0),B.isReadOnly=!!m,(0,u.GZ)(B);let U=!!(B&&_);return((0,l.useEffect)(()=>{C&&P((0,eM.Yl)({theme:C}))},[C,P]),(0,e4.Vg)(()=>{B&&U&&(B.commands.migrateNativeEmojis(),tD(B).then(()=>{console.debug("[EditorCore][fullyReady] Menus initialized & focused at start - fully ready"),t({editor:B}),requestAnimationFrame(()=>{requestIdleCallback(()=>{L()})})}))},[B,U,t,L],[U]),(0,l.useEffect)(()=>{P((0,eM.Rs)({isStatic:b})),B.isStatic=b},[B,b,P]),(0,l.useEffect)(()=>{P((0,eM.$j)({animationsEnabled:j&&!1===M}))},[j,M,P]),(0,l.useEffect)(()=>{P((0,eM.yJ)({commentsEnabled:g}))},[g,P]),(0,l.useEffect)(()=>{if(B)return s.$.DEBUG_ENABLED&&void 0===window.gammaEditorCore&&(window.gammaEditorCore=B,window.contentToAIHTML=function(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,i=void 0===n?null==B||null==(e=B.state.doc.firstChild)?void 0:e.content:null==B||null==(t=B.state.doc.firstChild)?void 0:t.content.content[n];if(B&&i)return(0,d.KC)(B,i)},window.hashCard=e=>{let t=performance.now(),n=window.contentToAIHTML(e);if(B&&n)return{content:n,hash:function(e){let t=0x811c9dc5;for(let n=0;n<e.length;n++)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return(t>>>0).toString(16)}(n),duration:performance.now()-t}}),B.gammaOrgId=A,B.gammaDocId=v,B.editorId=I,B.multipageEnabled=O,()=>{delete window.gammaEditorCore}},[B,v,A,I,O]),(0,l.useEffect)(()=>{B&&P((0,eM.kd)({isAllowedToEdit:k&&!m}))},[B,P,m,k]),(0,l.useEffect)(()=>{B&&U&&requestAnimationFrame(()=>{B.setOptions({editable:T})})},[B,P,T,U,L]),(0,tg.gp)(B),(0,tg.l3)(B),(0,tg.eb)(B,T),(0,tg.WS)(B),B&&_)?(0,i.jsx)(tf.Q,{value:I,children:(0,i.jsxs)(r.a,{id:"editor-core-root",className:"editor-core-root","data-testid":"editor-core-root",width:"100%",position:"relative",sx:tb.q,children:[(0,i.jsx)(tv.$Z,{editor:B,style:{width:"100%",height:"100%"},"data-testid":"tiptap-react-root-wrapper",className:"highlight-mask"}),E&&(0,i.jsx)(tx.A,{editorId:I,children:(0,i.jsx)(tB,{editor:B,scrollingParentSelector:w})})]})}):(0,i.jsx)(i.Fragment,{})},tN=e=>{let{isInsideDrawer:t,...n}=e;return(0,i.jsx)(tR,{isInsideDrawer:t,docId:n.docId,children:(0,i.jsx)(tL,{...n})})},tB=(0,l.memo)(e=>{let{editor:t,scrollingParentSelector:n}=e,r=(0,p.u)("insertWidgetBottom");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e3.Ht,{editor:t,scrollingParentSelector:n}),r?(0,i.jsx)(e6,{editor:t}):(0,i.jsx)(eR,{editor:t}),(0,i.jsx)(e8.G,{editor:t}),(0,i.jsx)(tt,{editor:t}),(0,i.jsx)(ts,{editor:t})]})})},11949:(e,t,n)=>{"use strict";n.d(t,{i:()=>z});var i=n(6029),r=n(31090),o=n(58959),l=n(26420),a=n(48810),s=n(74676),d=n(26385),c=n(41781),u=n(40452),p=n(23293),h=n(49611),m=n(55597),g=n(48621),x=n(91106),f=n(19564),y=n(82203),v=n.n(y),b=n(55729),j=n(32617),w=n(87827),C=n(34823),I=n(11390),S=n(82927),k=n(11403),A=n(86992);let E=e=>{let{feature:t,type:n}=e;return(0,i.jsx)(r.ck,{display:"flex",alignItems:"center",fontWeight:"medium",fontSize:"sm",children:(0,i.jsxs)(o.z,{alignItems:"center",spacing:2,justifyContent:"center",children:["feature"===n?(0,i.jsx)(l.a,{bg:"gradient.brand.bg",as:"span",display:"inline-block",sx:{width:4,height:4,maskImage:"url(".concat("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBQcm8gNi42LjAgYnkgQGZvbnRhd2Vzb21lIC0gaHR0cHM6Ly9mb250YXdlc29tZS5jb20gTGljZW5zZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tL2xpY2Vuc2UgKENvbW1lcmNpYWwgTGljZW5zZSkgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI0NS44IDQ1LjlDMjQxLjkgMzcuNCAyMzMuNCAzMiAyMjQgMzJzLTE3LjkgNS40LTIxLjggMTMuOUwxNDIuNyAxNzQuNyAxMy45IDIzNC4yQzUuNCAyMzguMSAwIDI0Ni42IDAgMjU2czUuNCAxNy45IDEzLjkgMjEuOGwxMjguOCA1OS41IDU5LjUgMTI4LjhjMy45IDguNSAxMi40IDEzLjkgMjEuOCAxMy45czE3LjktNS40IDIxLjgtMTMuOWw1OS41LTEyOC44IDEyOC44LTU5LjVjOC41LTMuOSAxMy45LTEyLjQgMTMuOS0yMS44cy01LjQtMTcuOS0xMy45LTIxLjhMMzA1LjMgMTc0LjcgMjQ1LjggNDUuOXoiLz48L3N2Zz4=",")"),maskSize:"contain",maskRepeat:"no-repeat"}}):(0,i.jsx)(l.a,{color:"deepocean.800",children:(0,i.jsx)(g.g,{icon:m.e68})}),(0,i.jsxs)(l.a,{display:"inline-block",flex:1,children:[(0,i.jsx)(a.E,{as:"span",me:1,children:t.label}),t.infoTip&&(0,i.jsx)(x.qT,{label:t.infoTip,color:"gray.400"})]}),t.isBeta&&(0,i.jsx)(s.E,{colorScheme:"green",children:(0,i.jsx)(f.x6,{id:"YBt9YP"})})]})})},_=e=>{let{displayAsTwoLines:t}=e;return(0,i.jsxs)(d.B,{spacing:2,h:"80px",children:[(0,i.jsx)(l.a,{minH:"12",children:(0,i.jsxs)(d.B,{align:t?"flex-start":"flex-end",direction:t?"column":"row",children:[(0,i.jsx)(c.E,{height:"3em",width:"4.5em"}),(0,i.jsxs)(d.B,{direction:"row",children:[(0,i.jsx)(c.E,{height:".75em",width:"3em"}),(0,i.jsx)(c.E,{height:".75em",width:"3em"})]})]})}),(0,i.jsx)(c.E,{height:"1.5em",width:"10em"})]})},R=(0,b.memo)(e=>{let{isFree:t,selectedBillingCycleKey:n,productPrice:r,displayAsTwoLines:o}=e,l=(0,b.useMemo)(()=>(null==r?void 0:r.frequencyUnit)==="year"?(0,I.y7)(r):null,[r]);return(0,i.jsx)(a.E,{textAlign:o?"left":void 0,color:"gray.600",fontSize:"sm",children:t?(0,i.jsx)(f.x6,{id:"r0pThp"}):"monthly"===n?(0,i.jsx)(f.x6,{id:"aIkeAd"}):(null==l?void 0:l.discountedPrice)?(0,i.jsx)(f.x6,{id:"dl2uS6",values:{0:l.price,1:l.discountedPrice},components:{0:(0,i.jsx)(a.E,{as:"span",textDecoration:"line-through",me:1,color:"gray.400"})}}):(0,i.jsx)(f.x6,{id:"hRcVGy",values:{0:null==l?void 0:l.price}})})});R.displayName="BillingCycleDescription";let P=(0,b.memo)(e=>{let{isFree:t,productPrice:n,selectedBillingCycleKey:r,currencyOverride:o}=e,{isUserLoading:s}=(0,S.ur)(),c=100>(0,I.GP)(null==n?void 0:n.currency)||(0,I.VB)(null==n?void 0:n.currency);return(0,k.En)()&&!s&&(t||n)?(0,i.jsxs)(l.a,{children:[(0,i.jsx)(l.a,{minH:"12",children:(0,i.jsx)(d.B,{align:c?"flex-start":"center",direction:c?"column":"row",children:(0,i.jsx)(f.x6,{id:"dPKZZo",components:{0:(0,i.jsx)(a.E,{fontSize:"2.8rem",fontFamily:"heading",fontWeight:"semibold",lineHeight:"1",color:"deepocean.950"}),1:(0,i.jsx)(T,{isFree:t,productPrice:n,currencyOverride:o}),2:(0,i.jsx)(a.E,{variant:"brand",lineHeight:c?1:void 0,fontSize:"xs",pb:c?"1":void 0,color:"deepocean.950",fontWeight:"medium"})}})})}),(0,i.jsx)(R,{isFree:t,selectedBillingCycleKey:r,productPrice:n,displayAsTwoLines:c})]}):(0,i.jsx)(_,{displayAsTwoLines:c})});P.displayName="PriceAndBillingCycle";let T=(0,b.memo)(e=>{let{isFree:t,productPrice:n,currencyOverride:r}=e,{discountedPrice:o,price:l}=(0,I.vC)(n)||{};return t?(0,i.jsx)(i.Fragment,{children:(0,C.v)(0,{currency:r})}):o?(0,i.jsxs)(d.B,{direction:"row",alignItems:"center",children:[(0,i.jsx)(a.E,{color:"gray.400",fontSize:"2rem",textDecoration:"line-through",children:l}),(0,i.jsx)(a.E,{children:o})]}):(0,i.jsx)(i.Fragment,{children:l})});T.displayName="PricePerSeatPerMonth";let z=e=>{let{productKey:t,productPrice:n,isUpgrade:o=!0,isCurrentProduct:c,upgradeDisabled:m,onClick:g,isPublic:x,selectedBillingCycleKey:y,badgeLabel:b,isHighlighted:C,leftSideIsRounded:I,rightSideIsRounded:_,currencyOverride:R}=e,{user:T,isUserLoading:z}=(0,S.ur)(),M=(0,j.mt)(),D=(0,k.En)(),O="free"===t,L=!x&&(!g||O&&!c),N=(0,w.n)(A.Ok),{name:B,description:U,featureHeading:F,features:W,includesHeading:G,includes:V}=O?N.free:N[t];return(0,i.jsxs)(u.s,{scrollSnapAlign:"center",w:"auto",position:"relative",className:"product-details",direction:"column",...C?{bg:"white",mt:0,mb:-6,borderColor:"snowcap.100",borderWidth:"1px",borderStyle:"solid",boxShadow:"rgba(200, 220, 245, 0.6) 2px 2px 6px",zIndex:1}:{mt:6,bg:"rgba(235, 248, 255, 0.75)",backdropFilter:"blur(10px)",boxShadow:"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px inset"},borderStartRadius:I?"3xl":"none",borderEndRadius:_?"3xl":"none",minW:{base:"80vw",md:"unset"},flex:1,children:[(0,i.jsxs)(d.B,{px:{base:4,lg:8},pt:4,spacing:2,position:"relative",borderBottom:"1px solid var(--chakra-colors-titanium-100)",bg:"white",borderTopStartRadius:I?"3xl":"none",borderTopEndRadius:_?"3xl":"none",children:[(0,i.jsxs)(d.B,{alignItems:"flex-start",spacing:0,children:[b&&(0,i.jsx)(l.a,{w:"100%",textAlign:"end",children:(0,i.jsx)(s.E,{display:"inline-block",textTransform:"unset",px:2,size:"sm",letterSpacing:"unset",colorScheme:"pink",variant:C?"solid":"subtle",children:b})}),(0,i.jsx)(p.D,{variant:"brand",position:"relative",fontWeight:"600",letterSpacing:"none",size:"xl",color:"deepocean.950",lineHeight:"1",as:"h2",children:B})]}),(0,i.jsx)(a.E,{fontSize:"sm",position:"relative",lineHeight:"1.3em",minHeight:"2.6em",mb:5,children:U})]}),(0,i.jsxs)(d.B,{px:{base:4,lg:8},pt:{base:4,md:6},pb:{base:4,md:8},spacing:"5",children:[(0,i.jsx)(P,{productPrice:n,isFree:O,selectedBillingCycleKey:y,currencyOverride:R}),L?(0,i.jsx)(i.Fragment,{}):x?(0,i.jsx)(h.$,{variant:O?"plain":"special",size:"lg",width:"100%",as:v(),href:T&&!z?"/":"/signup",textShadow:"none",children:(0,i.jsx)(f.x6,{id:"c3b0B0"})}):c?(0,i.jsx)(h.$,{as:l.a,variant:"plain",size:"lg",textShadow:"none",bg:"gray.50",width:"100%",isDisabled:!0,visibility:L?"hidden":"visible",children:(0,i.jsx)(f.x6,{id:"wSfp0e"})}):(0,i.jsx)(h.$,{variant:C?"special":"plain",size:"lg",width:"100%",onClick:g,visibility:L?"hidden":"visible",isDisabled:m,textShadow:"none",children:o?(0,i.jsx)(f.x6,{id:"pDhZ5t",values:{name:B}}):(0,i.jsx)(f.x6,{id:"Yu4iKr",values:{name:B}})}),(0,i.jsxs)(d.B,{spacing:"2",pb:4,children:[(0,i.jsx)(a.E,{fontWeight:"bold",color:"deepocean.950",children:F}),(0,i.jsx)(r.B8,{spacing:"2",children:W.filter(e=>{let{flag:t}=e;return!t||D&&M[t]}).map((e,t)=>(0,i.jsx)(E,{feature:e,type:"feature"},t))}),(0,i.jsx)(a.E,{fontWeight:"bold",mt:4,color:"deepocean.950",children:G}),(0,i.jsx)(r.B8,{spacing:"2",children:null==V?void 0:V.map((e,t)=>(0,i.jsx)(E,{feature:e,type:"include"},t))})]})]})]})}},12733:(e,t,n)=>{"use strict";let i,r;n.d(t,{W:()=>d});var o=n(55729),l=n(91938),a=n(68301),s=n(15342);Promise.all([n.e(6935),n.e(9978)]).then(n.bind(n,12504)).then(e=>{i=e.applyDevTools,r=e.removeDevTools});let d=e=>{let t=(0,s.GV)(a.Ew);(0,o.useEffect)(()=>{if(e){if(t){console.debug("[Prosemirror DevTools] Activating prosemirror-dev-tools");try{i(e.view)}catch(e){}}else try{r()}catch(e){}return l.$.DEBUG_ENABLED&&(window.openPMDT=()=>i(e.view)),()=>{r(),delete window.openPMDT}}},[e,t])}},13006:(e,t,n)=>{"use strict";n.d(t,{w:()=>g});var i=n(6029),r=n(40452),o=n(4192),l=n(58959),a=n(96990),s=n(48810),d=n(58297),c=n(99492),u=n(48621),p=n(91106),h=n(19564),m=n(66897);n(24729);let g=e=>{let{selectedCollaborator:t,idx:n,handleRemoveClick:g}=e,x=t&&(0,m.t)((null==t?void 0:t.email)||""),f=0===n?170:300;return(0,i.jsx)(r.s,{width:0===n?"calc(100% - 100px)":"",className:"searchbartag","data-testid":"searchbartag-collaborator-".concat(t.email),children:(0,i.jsxs)(o.vw,{size:"md",minW:110,...x?{}:{colorScheme:"red"},children:["id"in t?(0,i.jsx)(p.Tz,{label:t.email,"aria-label":t.email,children:(0,i.jsxs)(l.z,{children:[(0,i.jsx)(a.e,{size:"2xs",m:0,name:t.displayName,src:t.profileImageUrl}),(0,i.jsx)(s.E,{textTransform:"capitalize",wordBreak:"break-word",noOfLines:1,maxW:f,lineHeight:"1.5",children:t.displayName})]})}):(0,i.jsx)(p.Tz,{label:x?t.email:(0,i.jsx)(h.x6,{id:"XILg0L"}),"aria-label":t.email,children:(0,i.jsxs)(l.z,{flex:1,children:[(0,i.jsx)(d.j,{size:6,children:(0,i.jsx)(u.g,{icon:x?c.y_8:c.bxP})}),(0,i.jsx)(s.E,{wordBreak:"break-all",display:"block",height:"100%",width:"100%",noOfLines:1,maxW:f,lineHeight:"1.5",children:t.email})]})}),(0,i.jsx)(o.TV,{onClick:g})]})},"id"in t?t.id:t.email)}},14322:(e,t,n)=>{"use strict";n.d(t,{AY:()=>l,GE:()=>s,ZV:()=>c,kp:()=>d,wb:()=>a});var i=n(77650),r=n(91938),o=n(88586);let l=()=>"".concat(r.$.API_HOST,"/billing/portal"),a=(e,t)=>"".concat(r.$.API_HOST,"/billing/checkout/").concat(e,"/?ids=").concat(t.join(",")),s=e=>{let{url:t,title:n,w:i,h:r}=e,o=void 0!==window.screenLeft?window.screenLeft:window.screenX,l=void 0!==window.screenTop?window.screenTop:window.screenY,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,s=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,d=Math.min(i,.8*a),c=Math.min(r,.8*s);return window.open(t,n,"\n    scrollbars=yes,\n    width=".concat(d,", \n    height=").concat(c,", \n    top=").concat((s-c)/2+l,", \n    left=").concat((a-d)/2+o,"\n    "))},d=e=>{var t,n,i,r;let l=null==e?void 0:e.find(e=>"pro"===e.key),a=null==l||null==(t=l.prices)?void 0:t.find(e=>e.frequencyUnit===o.Vd7.Month),s=null==l||null==(n=l.prices)?void 0:n.find(e=>e.frequencyUnit===o.Vd7.Year),d=null==e?void 0:e.find(e=>"plus"===e.key);return{proMonthlyProductPrice:a,proYearlyProductPrice:s,plusMonthlyProductPrice:null==d||null==(i=d.prices)?void 0:i.find(e=>e.frequencyUnit===o.Vd7.Month),plusYearlyProductPrice:null==d||null==(r=d.prices)?void 0:r.find(e=>e.frequencyUnit===o.Vd7.Year)}},c=e=>i.Ru.number(e,{style:"percent",maximumFractionDigits:0})},14473:(e,t,n)=>{"use strict";n.d(t,{zn:()=>x});var i=n(6029),r=n(2241),o=n(93242),l=n(26420),a=n(53996),s=n(24302),d=n(15592),c=n(40452),u=n(18833),p=n(86992);let h=(0,r.B)("div",{baseStyle:{w:"full",h:"full",rounded:"full",pos:"absolute",top:"0",right:"0",bottom:"0",left:"0"}}),m=(0,u.P)(h),g=e=>{let{getInputProps:t,getRadioProps:n,getLabelProps:r,state:d}=(0,o.z)(e);return(0,i.jsxs)(l.a,{as:"label",pos:"relative",...r(),children:[(0,i.jsx)("input",{...t()}),(0,i.jsx)(a.o,{...n(),cursor:"pointer",pos:"relative",zIndex:1,minH:"10",py:2,lineHeight:"1.2",fontSize:{base:"sm",md:"md"},px:"4",textAlign:"center",transition:"all 0.2s",minW:{base:"none",md:"10rem"},fontWeight:"medium",_checked:{fontWeight:"bold",color:"deepocean.950"},borderRadius:"full",_focus:{boxShadow:"var(--chakra-shadows-outline)",outline:"none"},children:e.children}),d.isChecked&&(0,i.jsx)(m,{pos:"absolute",bg:(0,s.dU)("trueblue.50","trueblue.900"),color:(0,s.dU)("trueblue.600","trueblue.200"),layoutId:"highlight",insetStart:0,insetEnd:0,top:0,bottom:0,borderRadius:"full",transition:{duration:.2}})]})},x=e=>{let{selectedBillingCycleKey:t,setSelectedBillingCycleKey:n,...r}=e,{getRadioProps:o,getRootProps:l}=(0,d.m)({defaultValue:t,onChange:e=>{n(e)}});return(0,i.jsx)(c.s,{pos:"relative",justifyContent:"center",alignItems:"center",children:(0,i.jsxs)(c.s,{display:"inline-flex",align:"center",bg:(0,s.dU)("white","gray.600"),rounded:"full",p:"2",boxShadow:"base",...l(r),children:[(0,i.jsx)(g,{...o({value:"monthly"}),children:(0,p._v)().monthly.name}),(0,i.jsx)(g,{...o({value:"yearly"}),children:(0,p._v)().yearly.name})]})})}},17859:(e,t,n)=>{"use strict";n.d(t,{D:()=>l});var i=n(29608),r=n(11403),o=n(85732);let l=()=>{let e=!(0,i.rA)()&&!(0,o.NF)();return(0,r.WM)(e,'\n!function(w,d,i,s){function l(){if(!d.getElementById(i)){var f=d.getElementsByTagName(s)[0],e=d.createElement(s);e.type="text/javascript",e.async=!0,e.src="https://canny.io/sdk.js",f.parentNode.insertBefore(e,f)}}if("function"!=typeof w.Canny){var c=function(){c.q.push(arguments)};c.q=[],w.Canny=c,"complete"===d.readyState?l():w.attachEvent?w.attachEvent("onload",l):w.addEventListener("load",l,!1)}}(window,document,"canny-jssdk","script");\n'),null}},18351:(e,t,n)=>{"use strict";n.d(t,{k:()=>d});var i=n(6029),r=n(46898),o=n(19564),l=n(55729),a=n(88586),s=n(99038);let d=()=>{let e=(0,r.d)(),[t]=(0,a.Tyr)({refetchQueries:["GetChannelDocActivity","GetChannels"]});return{addDocChannel:(0,l.useCallback)(n=>{let{docId:r,doc:l,channel:d,existingChannels:c=[]}=n,u=r||(null==l?void 0:l.id);if(!u)return void console.error("Invalid docid");let p={input:{docId:u,sharing:[{op:a.wSW.Add,path:"/channels",value:[{channelId:d.id}]}]}},h=(null==l?void 0:l.title)||s.TP,m=[...c,{id:d.id,slug:d.slug,name:d.name,permission:a.aXG.Comment}].sort((e,t)=>e.slug.localeCompare(t.slug,"en"));t({variables:p,update:(e,t)=>{let{data:n}=t;e.writeFragment({id:"Doc:".concat(u),fragment:a.Hr1,data:null==n?void 0:n.updatePublicChannels})},optimisticResponse:{updatePublicChannels:{id:p.input.docId,channels:m}}}).then(()=>{e({title:(0,i.jsx)(o.x6,{id:"7hDHpt",values:{title:h}}),description:(0,i.jsx)(o.x6,{id:"A2xcFn",values:{GAMMA_ARTIFACT_PROPER_NOUN:s.TP,0:d.name}}),status:"success",duration:5e3,isClosable:!0,position:"top"})},t=>{e({title:(0,i.jsx)(o.x6,{id:"bLdU0Q",values:{title:h,0:d.name}}),description:t.message,duration:null,status:"error",isClosable:!0,position:"top"})})},[t,e]),removeDocChannel:(0,l.useCallback)((n,r)=>{var l;if(!r)return;let d={input:{docId:n.id,sharing:[{op:a.wSW.Remove,path:"/channels",value:[{channelId:r}]}]}};t({variables:d,update:(e,t)=>{let{data:i}=t;e.writeFragment({id:"Doc:".concat(n.id),fragment:a.e34,data:null==i?void 0:i.updatePublicChannels})},optimisticResponse:{updatePublicChannels:{id:d.input.docId,channels:null==(l=n.channels)?void 0:l.filter(e=>e.id!==r)}}}).then(()=>{e({title:(0,i.jsx)(o.x6,{id:"qsnpV6",values:{GAMMA_ARTIFACT_PROPER_NOUN:s.TP}}),status:"success",duration:1e4,position:"top"})}).catch(t=>{e({title:(0,i.jsx)(o.x6,{id:"+yMzgs"}),description:t.message,status:"error",duration:3e3,isClosable:!0,position:"top"}),console.error("[addRemoveDocChannel] Error removing channel:",t.message)})},[t,e])}}},18640:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var i=n(6029),r=n(55729),o=n(87996);let l={width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},a=e=>{let{uppy:t,multiple:n=!1,accept:a=o.RH.join(",")}=e,s=(0,r.useRef)(null),d=(0,r.useMemo)(()=>(0,i.jsx)("input",{ref:s,className:"gamma-uppy-FileInput-input",style:l,type:"file",name:"gamma-file-input",multiple:n,accept:a,onChange:e=>{let n=e.target;n&&n.files&&(Array.from(n.files).forEach(e=>{try{t.addFile({source:"file input",name:e.name,type:e.type,data:e})}catch(e){e.isRestriction?console.warn("[useFileInput] Restriction error:",e):console.error(e)}}),n.value=null)}}),[]),c=(0,r.useCallback)(()=>{var e;null==(e=s.current)||e.click()},[]);return(0,r.useEffect)(()=>{let e=s.current;e&&(t.on("file-removed",()=>{e.value=null}),t.on("complete",()=>{e.value=null}),t.on("transloadit:complete",()=>{e.value=null}))},[]),{inputElement:d,onClick:c}}},20715:(e,t,n)=>{"use strict";n.d(t,{c:()=>l,d:()=>a});var i=n(95889),r=n(29608),o=n(37605);let l=e=>{let{doc_id:t,source:n,source_doc_id:r,channel:l,extra:a}=e;null===i.zS||void 0===i.zS||i.zS.track(o.VV.DOC_CREATED,{doc_id:t,source_doc_id:r,source:n,channel:l,extra:a})},a=e=>{let{docId:t,type:n,source:l}=e;if(!t)return void console.debug("[trackDocShareLinkCopiedEvent]: doc_id is required");null===i.zS||void 0===i.zS||i.zS.track(o.VV.DOC_SHARELINK_COPIED,{doc_id:t,source:l,type:n,device:(0,r.ZI)()})}},23636:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BuddyChatPane:()=>np});var i=n(6029),r=n(35946),o=n(46898),l=n(57405),a=n(58959),s=n(49611),d=n(99492),c=n(48621),u=n(77650),p=n(58495),h=n(55729),m=n(91938),g=n(40452),x=n(26385),f=n(33787),y=n(23293),v=n(48810),b=n(19564),j=n(99038),w=n(12258);let C=(0,h.memo)(()=>(0,i.jsx)(g.s,{direction:"column",height:"100%",justifyContent:"flex-end",children:(0,i.jsxs)(x.B,{spacing:6,alignItems:"center",p:4,borderRadius:"lg",textAlign:"center",children:[(0,i.jsx)(f._,{src:w.A.src,alt:"Empty state",maxW:"200px"}),(0,i.jsxs)(x.B,{spacing:1,children:[(0,i.jsx)(y.D,{size:"sm",fontWeight:"semibold",children:(0,i.jsx)(b.x6,{id:"EVnzPs"})}),(0,i.jsx)(v.E,{color:"gray.600",fontSize:"sm",children:(0,i.jsx)(b.x6,{id:"iaCYkN",values:{GAMMA_ARTIFACT_PROPER_NOUN:j.TP}})})]})]})}));C.displayName="BuddyChatEmptyState";var I=n(70965),S=n(85942),k=n(66380),A=n(15342),E=n(87291),_=n(7554),R=n(43634),P=n(47956);let T=()=>{let e=(0,A.CU)(),t=(0,A.GV)(P.eb),n=(0,A.GV)(R.SJ),i=(0,k.V)(),r=(0,E.d)(),o=(0,h.useCallback)(t=>{let n=(0,_.ST)(e.getState()).find(e=>e.id===t);n&&r(n)},[r,e]);return{editor:t,store:e,theme:n,imageOptions:{imageProvider:i.imageProvider,imageModel:i.imageModel,imageStyle:i.imageStyle,visualsMenuEnabled:i.imageOptions.visualsMenuEnabled,artStylePreset:i.imageOptions.artStylePreset,artStylePrompt:i.imageOptions.artStylePrompt},applyTheme:o}};var z=n(49023),M=n(42721),D=n(22905),O=n(81807),L=n(68469),N=n(80116),B=n(83605),U=n(82592),F=n(47867),W=n(92397),G=n(61385),V=n(33201),H=n(56603),q=n(63867),K=n(15607);let Y=(e,t)=>{let n=e.state.doc.content.content[0].content.content[0].attrs.id,i=e.state.doc.resolve(t),r=e.state.doc.nodeAt(t);if((null==r?void 0:r.type.name)==="card"&&1===i.depth)return r.attrs.id;let o=(0,K.Ft)(i,(e,t)=>"card"===e.type.name&&t<=G.$x);return o?o.node.attrs.id:n},X=(e,t)=>{let{top:n,bottom:i}=t.getBoundingClientRect(),{from:r,to:o}=e.state.selection,l=e.view.coordsAtPos(r),a=e.view.coordsAtPos(o),s=Math.min(l.top,a.top),d=Math.max(l.bottom,a.bottom),c=d-s;return d<n?{position:"above",overlap:0}:s>i?{position:"below",overlap:0}:s<n&&d<=i?{position:"startsAbove",overlap:(d-n)/c}:s>=n&&d>i?{position:"endsBelow",overlap:(i-s)/c}:s<n&&d>i?{position:"spansContainer",overlap:1}:{position:"within",overlap:1}},J=(e,t)=>{let{selection:n}=e.state,{from:i,to:r}=n,{overlap:o}=X(e,t);if(0===o)return;let l=n instanceof q.nh,a=!l,s=Y(e,i),d=e.state.doc.nodeAt(i);if((!l||!(o<.5))&&(!a||!(o<.33)))return l&&(null==d?void 0:d.type.name)==="card"?{type:"card",selectedCardId:s}:a&&r-i>5?{type:"text",selectionStartCardId:s,textSelection:e.state.doc.textBetween(i,r)}:{type:"none",cursorInCardId:s}},$=e=>new Promise(t=>setTimeout(t,e));class Z{static applyResultVariation(e,t){let{editor:n,store:i}=e;Z.loadCheckpoint(e,t.toApplyCheckpointId,t.messageId),i.dispatch((0,P.rD)({messageId:t.messageId,variationId:t.id}))}static loadCheckpoint(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,L.$)(),{editor:r,store:o}=e,l=(0,P.BV)(t)(o.getState());if(!l)throw Error("Cannot find checkpoint with id ".concat(t));r.commands.setContent(l.jsonContent,!0),null==(n=e.applyTheme)||n.call(e,l.themeId);let a=(0,R.SJ)(o.getState());(0,U.CP)({editor:r,rootNode:r.state.doc,theme:a,interactionId:i})}static async ensureCardInView(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=(0,F.H1)("editor"),r=document.querySelector((0,G.OB)(t)),o=(0,F.cH)(r,500);(null==o||!o.yAxisInView)&&(i.scrollElementIntoView({element:r}),n>0&&await $(n))}static focusResultVariation(e,t){let{editor:n}=e,i=t.scrollToCardId;if(!i)return;let r=Z.findCardById(n,i);setTimeout(()=>{Z.ensureCardInView(e,i),n.chain().selectInsideCardBody(r.pos).focus().run()},0)}static findCardById(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.findTopLevelCards(e).find(e=>e.cardId===t);if(!i)throw Error("Cannot find card with id ".concat(t));return n&&this.focusCard(e,i.pos),i}static checkCardById(e,t){let n=this.findTopLevelCards(e).find(e=>e.cardId===t);return n||null}static async removeCardById(e,t){let{cardId:n}=e,{editor:i}=t,r=Z.findCardById(i,n),o=null==r?void 0:r.pos,l=r?i.state.doc.nodeAt(r.pos):null;return!!o&&!!l&&(i.chain().deleteCard(o).run(),!0)}static async replaceCardHTMLById(e,t){let{cardId:n,cardHtml:i,messageId:r}=e,{editor:o,theme:l}=t,a=(0,O.DB)(i),s=(0,B.dE)(a),d=Z.findCardById(o,n),c=null==d?void 0:d.pos,u=d?o.state.doc.nodeAt(d.pos):null;if(!c||!u)return null;let p={from:c,to:c+u.nodeSize};return s.attrs.id=n,o.chain().setMeta("cardNotesHandled",!0).insertContentAt(p,s).selectInsideCardBody(c).run(),(0,U.Sg)({editor:o,content:s,theme:l,interactionId:r}),{oldHtml:i,newHtml:a,replaceRange:p}}static async replaceCardJSONById(e,t){let{cardId:n,cardJson:i,messageId:r}=e,{editor:o}=t,l=Z.findCardById(o,n),a=null==l?void 0:l.pos,s=l?o.state.doc.nodeAt(l.pos):null;if(!a||!s)return null;let d={from:a,to:a+s.nodeSize};return o.chain().setMeta("cardNotesHandled",!0).insertContentAt(d,i).selectInsideCardBody(a).run(),(0,U.Sg)({editor:o,content:i,theme:t.theme,interactionId:r}),{replaceRange:d}}static getCurrentFocusedCard(e,t){let n=e.state.selection,i=(0,W.hT)(e.state.doc,n.from);if(!i)throw Error("Cannot find currently focused card");let r=i.node.attrs.id,o=this.findCardNum(e,r);return{cardId:r,cardNum:o,html:(0,N.KC)(e,i.node)}}static focusCard(e,t){e.chain().selectInsideCardBody(t).focus().scrollIntoView().run()}static getDeckInfo(e,t){let{editor:n,store:i}=e,r=this.findTopLevelCards(n).map(e=>e.cardHtml).join("\n");r='<div class="gamma-doc">'.concat(r,"</div>");let o=(0,P.y3)(i.getState()),l=(0,F.H1)("editor"),a=document.querySelector(l.scrollSelector);if(!a)throw Error("Cannot find container element");return{docHtml:r,cardsInView:o,initiatingCardId:null==t?void 0:t.initiatingCardId,selection:J(n,a)}}static findTopLevelCards(e){return(0,D.xe)(e.state.doc,e=>(0,V.jg)(e)).filter(t=>1===e.state.doc.resolve(t.pos).depth).map((t,n)=>({pos:t.pos,node:t.node,cardNum:n+1,cardId:t.node.attrs.id,cardJson:t.node.toJSON(),cardHtml:(0,N.KC)(e,t.node)}))}static findCardNum(e,t){let n=this.findTopLevelCards(e).find(e=>e.cardId===t);if(!n)throw Error("Cannot find card with id ".concat(t));return n.cardNum}static findCreateCardInsertRange(e,t){let n=this.findTopLevelCards(e),i=t-1,r=n[i];if(i>=n.length){let t=n.length-1,i=e.state.doc.nodeAt(n[t].pos),r=n[t].pos+i.nodeSize;return{from:r,to:r,relativeRange:{from:(0,H.JO)(e.state,r),to:(0,H.JO)(e.state,r)}}}if(!r)throw Error("Cannot find card with index ".concat(i));return{from:r.pos,to:r.pos,relativeRange:{from:(0,H.JO)(e.state,r.pos),to:(0,H.JO)(e.state,r.pos)}}}static findCardInsertRange(e,t,n){let i=this.findCardById(e,t);if(!i)throw Error("Cannot find card with id ".concat(t));if("before"===n)return{from:i.pos,to:i.pos,relativeRange:{from:(0,H.JO)(e.state,i.pos),to:(0,H.JO)(e.state,i.pos)}};{let t=i.pos+i.node.nodeSize;return{from:t,to:t,relativeRange:{from:(0,H.JO)(e.state,t),to:(0,H.JO)(e.state,t)}}}}}Z.DEFAULT_APPLIED_FIRST_POS=2;var Q=n(34832),ee=n(13559),et=n(47665);class en{current(){return this._cardIds[this.index]}take(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return this._cardIds.slice(this.index,this.index+e)}goto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._cardIds.findIndex(t=>t===e);return -1===n&&(this.index=0),n+t<0?this.index=0:n+t>this._cardIds.length-1?this.index=this._cardIds.length-1:this.index=n+t,this}scrollAndSelect(e){let t=this.current();Z.ensureCardInView({editor:e},t);let n=(0,et.W0)(e,t);n&&e.chain().selectInsideCardBody(n.pos).focus().run()}constructor(e){this._cardIds=e,this.index=0}}let ei=e=>new en((0,D.xe)(e.state.doc,e=>(0,et.jg)(e)).filter(t=>1===e.state.doc.resolve(t.pos).depth).map(e=>{var t;return null==(t=e.node.attrs)?void 0:t.id}));class er{get id(){return this.input.toolCallId}getOriginalPreviewCardIds(e){return ei(e.editor).goto(this.input.cardId,-1).take(3)}getModifiedPreviewCardIds(e){return ei(e.editor).goto(this.input.cardId,-1).take(3)}originalCardToSelect(){return this.input.cardId}modifiedCardToSelect(){return this.input.cardId}async apply(e){let{editor:t}=e,n=(0,et.W0)(t,this.cardId);if(!n)throw Error("Cannot find card with id ".concat(this.cardId));let i=(0,et.W0)(t,this.input.movePositionCardId);if(!i)throw Error("Cannot find target position card with id ".concat(this.input.movePositionCardId));t.chain().rearrangeCards({from:n.pos,to:i.pos,position:"after"===this.input.movePosition?"below":"above"}).selectInsideCardBody(n.pos).scrollIntoView().run(),setTimeout(()=>{Z.ensureCardInView(e,this.cardId)},200)}async rollback(e){throw Error("Rollback not implemented")}getAppliedFirstPos(e){var t,n;return null!=(n=null==(t=Z.findTopLevelCards(e.editor).find(e=>e.cardId===this.cardId))?void 0:t.pos)?n:Z.DEFAULT_APPLIED_FIRST_POS}serialize(){return{type:this.type,input:this.input}}constructor(e){this.input=e,this.type="moveCard",this.previewType="doc",this.messageId=e.messageId,this.cardId=e.cardId}}var eo=n(68301),el=n(43182),ea=n(3383);async function es(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full",n=await fetch("".concat(m.$.API_HOST,"/ai/tools/read-url"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e,mode:t,workspaceId:(0,M.gx)()}),credentials:"include"});if(!n.ok)throw Error((await n.json().catch(()=>({}))).message||"HTTP ".concat(n.status));let i=await n.json();return"summary"===t?{url:e,title:i.title||"Unknown",content:i.summary||"",mode:"summary",publishedDate:i.publishedDate,author:i.author}:{url:e,title:i.title||"Unknown",content:i.content||"",mode:"full",metadata:i.metadata||{}}}async function ed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=await fetch("".concat(m.$.API_HOST,"/ai/tools/search-web"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,numResults:t,type:"keyword",text:{maxCharacters:2e3}}),credentials:"include"});if(!n.ok)throw Error((await n.json().catch(()=>({}))).message||"HTTP ".concat(n.status));let i=await n.json();return{query:e,numResults:i.length,results:i.map(e=>({id:e.id,title:e.title,url:e.url,text:e.text||"",publishedDate:e.publishedDate,author:e.author}))}}class ec{get id(){return this.input.toolCallId}async apply(e){let{editor:t}=e,n=Z.findCardInsertRange(t,this.input.createPositionCardId,this.input.createPosition);Z.checkCardById(t,this.cardId)||(t.chain().insertContentAt(n,this.cardJson).selectInsideCardBody(n.from).scrollIntoView().run(),(0,U.Sg)({editor:t,content:this.cardJson,theme:e.theme,interactionId:this.messageId}),setTimeout(()=>{Z.ensureCardInView(e,this.cardId)},200))}async rollback(e){Z.removeCardById({cardId:this.cardId},e)}getAppliedFirstPos(e){var t,n;return null!=(n=null==(t=Z.findTopLevelCards(e.editor).find(e=>e.cardId===this.cardId))?void 0:t.pos)?n:Z.DEFAULT_APPLIED_FIRST_POS}getOriginalPreviewCardIds(e){let{createPositionCardId:t,createPosition:n}=this.input;return ei(e.editor).goto(t,"before"===n?-1:0).take(3)}getModifiedPreviewCardIds(e){return ei(e.editor).goto(this.cardId,-1).take(3)}originalCardToSelect(e){let{createPositionCardId:t,createPosition:n}=this.input;return ei(e.editor).goto(t,"before"===n?-1:0).current()}modifiedCardToSelect(){return this.cardId}serialize(){return{type:this.type,input:this.input}}constructor(e){var t;this.input=e,this.type="createCard",this.previewType="doc",this.messageId=e.messageId,this.cardJson=this.input.cardJson,this.cardId=null==(t=this.cardJson.attrs)?void 0:t.id}}var eu=n(9922),ep=n.n(eu);class eh{get id(){return this.input.toolCallId}async apply(e){let{editor:t}=e,n=Z.findCardById(t,this.cardId);if(!n)throw Error("Cannot find card to duplicate with id ".concat(this.cardId));let i=ep()(n.cardJson);i.attrs.id=this.duplicatedCardId;let r=Z.findCardInsertRange(t,this.insertPositionCardId,this.insertPosition);t.chain().insertContentAt(r.from,i,{updateSelection:!1}).run(),setTimeout(()=>{Z.ensureCardInView(e,this.duplicatedCardId)},200)}async rollback(e){let{editor:t}=e;try{let e=Z.findCardById(t,this.duplicatedCardId);e&&t.commands.deleteCard(e.pos)}catch(e){console.warn("Could not find duplicated card by ID for rollback",e)}}getAppliedFirstPos(e){try{return Z.findCardById(e.editor,this.duplicatedCardId).pos}catch(e){return Z.DEFAULT_APPLIED_FIRST_POS}}getOriginalFirstPos(e){return Z.findCardById(e.editor,this.cardId).pos}getOriginalPreviewCardIds(e){return ei(e.editor).goto(this.cardId,-1).take(3)}getModifiedPreviewCardIds(e){return ei(e.editor).goto(this.duplicatedCardId,-1).take(3)}originalCardToSelect(){return this.cardId}modifiedCardToSelect(){return this.duplicatedCardId}serialize(){return{type:this.type,input:this.input}}constructor(e){this.input=e,this.type="duplicateCard",this.previewType="doc",this.messageId=e.messageId,this.cardId=e.cardId,this.duplicatedCardId=e.duplicatedCardId,this.insertPositionCardId=e.insertPositionCardId,this.insertPosition=e.insertPosition}}class em{async apply(e){for(let t of this.input.editedCardJsons){let n=t.attrs.id;if(!n){console.error("[EditAllCardsSuggestion] Card has no id");continue}Z.replaceCardJSONById({cardId:n,cardJson:t,messageId:this.messageId},e)}}async rollback(e){for(let t of this.input.originalCardJsons){let n=t.attrs.id;if(!n){console.error("[EditAllCardsSuggestion] Card has no id");continue}Z.replaceCardJSONById({cardId:n,cardJson:t,messageId:this.messageId},e)}}getAppliedFirstPos(){return 0}getOriginalPreviewCardIds(e){return ei(e.editor).take(3)}getModifiedPreviewCardIds(e){return ei(e.editor).take(3)}originalCardToSelect(e){return ei(e.editor).current()}modifiedCardToSelect(e){return ei(e.editor).current()}serialize(){return{type:this.type,input:this.input}}constructor(e){this.input=e,this.type="editAllCards",this.previewType="doc",this.messageId=e.messageId,this.id=this.input.toolCallId}}class eg{async apply(e){await Z.ensureCardInView(e,this.cardId,1e3),Z.replaceCardJSONById({cardId:this.cardId,cardJson:this.input.editedCardJson,messageId:this.messageId},e)}async rollback(e){Z.replaceCardJSONById({cardId:this.cardId,cardJson:this.input.originalCardJson,messageId:this.messageId},e)}getAppliedFirstPos(e){let t=(0,et.W0)(e.editor,this.cardId);return t?t.pos:(console.error("[EditCardSuggestion] Cannot find card with id",this.cardId),Z.DEFAULT_APPLIED_FIRST_POS)}getOriginalPreviewCardIds(e){return ei(e.editor).goto(this.cardId).take(3)}getModifiedPreviewCardIds(e){return ei(e.editor).goto(this.cardId).take(3)}originalCardToSelect(){return this.cardId}modifiedCardToSelect(){return this.cardId}serialize(){return{type:this.type,input:this.input}}constructor(e){this.input=e,this.type="editCardById",this.previewType="card",this.messageId=e.messageId,this.id=this.input.toolCallId,this.cardId=this.input.cardId}}let ex=(e,t)=>{let n=t.findIndex(t=>e.includes(t));return t[n]};class ef{async apply(e){let{editor:t}=e,{cardIds:n}=this.input;await Z.ensureCardInView(e,n[0],1e3),t.chain().command(e=>{let{tr:i}=e;return n.forEach(e=>{let n=Z.findCardById(t,e);if(!n)throw Error("Cannot find card with id ".concat(e));let{pos:r}=n,o=t.state.doc.nodeAt(r),l=r+o.nodeSize;i.deleteRange(i.mapping.map(r),i.mapping.map(l))}),!0}).run()}async rollback(e){let{editor:t,store:n}=e,i=this.input.originalAllCardIds.map(e=>{let t=this.input.removedCardJson[e];return t?{id:e,removed:!0,content:t}:{id:e,removed:!1,content:null}});for(let[e,n]of Object.entries(i)){if(!n.removed)continue;if("0"===e){t.chain().insertContentAt({from:1,to:1},n.content).run();continue}let r=i[Number(e)-1].id,o=Z.findCardInsertRange(t,r,"after");t.chain().insertContentAt(o,n.content).run()}}getAppliedFirstPos(e){let t=Z.findCardById(e.editor,this.cardBeforeFirstRemovedCard);return t?t.pos+t.node.nodeSize:this.firstPos}getOriginalPreviewCardIds(e){return ei(e.editor).goto(this.firstRemovedCardId,-1).take(3)}getModifiedPreviewCardIds(e){return ei(e.editor).goto(this.cardBeforeFirstRemovedCard).take(3)}originalCardToSelect(){return this.firstRemovedCardId}modifiedCardToSelect(){return this.cardBeforeFirstRemovedCard}get id(){return this.input.toolCallId}serialize(){return{type:"removeCards",input:this.input}}constructor(e){this.input=e,this.type="removeCards",this.previewType="doc",this.firstPos=1,this.messageId=e.messageId,this.firstRemovedCardId=ex(e.cardIds,e.originalAllCardIds);let t=this.input.originalAllCardIds,n=t.findIndex(e=>e===this.firstRemovedCardId);if(this.cardBeforeFirstRemovedCard=t[n-1],!this.cardBeforeFirstRemovedCard){var i;let n=t.findIndex(t=>!e.cardIds.includes(t));this.cardBeforeFirstRemovedCard=null!=(i=t[n])?i:t[0]}}}let ey=e=>{var t,n,i,r,o,l,a,s,d,c,u,p,h;let m=(null==(n=e.config)||null==(t=n.keywords)?void 0:t.color.slice(0,4))||[],g=(null==(r=e.config)||null==(i=r.keywords)?void 0:i.tone.slice(0,5))||[],x=[e.bodyFont,e.headingFont].filter(Boolean);return{id:e.id,name:e.name?e.name:null,accent:e.accentColor?e.accentColor:null,background:(null==(l=e.config)||null==(o=l.background)?void 0:o.type)==="color"?null==(s=e.config)||null==(a=s.background.color)?void 0:a.hex:null,bodyColor:(null==(d=e.config)?void 0:d.bodyColor)?e.config.bodyColor:null,headingColor:(null==(c=e.config)?void 0:c.headingColor)?e.config.headingColor:null,cardColor:(null==(h=e.config)||null==(p=h.cardBackground)||null==(u=p.color)?void 0:u.hex)?e.config.cardBackground.color.hex:null,fonts:x.length>0?x.join(", "):null,keywords:[...m,...g].join(" ")}},ev={focusCardById:{execute:async function(e,t){let{cardId:n}=e,{editor:i}=t,r=Z.findCardById(i,n);Z.focusCard(i,r.pos);let{cardNum:o}=r;return{status:"success",cardNum:o,cardId:n}}},removeCards:{execute:async function(e,t,n,i){let{cardIds:r}=e,{editor:o,store:l}=t,a=Z.findTopLevelCards(o),s=a.map(e=>e.cardId),d=a.reduce((e,t)=>(r.includes(t.cardId)&&(e[t.cardId]=t.cardJson),e),{}),c=new ef({toolCallId:n.toolCallId,messageId:i,cardIds:r,originalAllCardIds:s,removedCardJson:d});return await c.apply(t),l.dispatch((0,P.Ed)(c)),{status:"success",removedCardIds:r,suggestionId:c.id}}},editCardById:{execute:async function(e,t,n,i){let{editor:r,store:o,imageOptions:l}=t,{instructions:a,cardId:s}=e,d=Z.findTopLevelCards(r),c=d.findIndex(e=>e.cardId===s),u=d[c];if(!u)throw Error("Cannot find card with id ".concat(s));let p=c>0?d[c-1].cardHtml:void 0,h=(0,ee.h)(r,o),m=await (0,Q.K8)({promptKey:"EditCardWithLayout",variables:{previousHtml:p,request:a,inputHtml:u.cardHtml,imageProvider:l.imageProvider,imageOptions:{model:l.imageModel,stylePrompt:l.imageStyle,visualsMenuEnabled:l.visualsMenuEnabled,artStylePreset:l.artStylePreset,artStylePrompt:l.artStylePrompt},...h,outline:"",basePromptKey:eo.of.get("editCardPrompt"),model:eo.of.get("editCardModel")},workspaceId:(0,M.gx)(),opts:{abortController:t.abortController}}),g=(0,O.DB)(m),x=(0,B.dE)(g),f=new eg({messageId:i,toolCallId:n.toolCallId,originalCardJson:u.cardJson,editedCardJson:x,cardId:s});return await f.apply(t),o.dispatch((0,P.Ed)(f)),{status:"success",cardId:s,beforeHtml:u.cardHtml,afterHtml:g,suggestionId:f.id}}},editAllCards:{execute:async function(e,t,n,i){let{instructions:r}=e,{editor:o,store:l,imageOptions:a}=t,s=Z.findTopLevelCards(o);if(0===s.length)return{status:"success",editedCards:[]};let d=(0,ee.h)(o,l),c=[];s.forEach(e=>{c.push(e.cardHtml)});let u=c.join(),p=await (0,Q.K8)({promptKey:"EditCardParallel",variables:{inputHtml:u,request:r,imageOptions:{model:a.imageModel,stylePrompt:a.imageStyle},imageProvider:a.imageProvider,...d,outline:"",model:eo.of.get("editCardModel"),reasoningEffort:eo.of.get("editCardReasoningEffort"),basePromptKey:eo.of.get("editCardParallelPrompt")},workspaceId:(0,M.gx)(),opts:{abortController:t.abortController}}),h=(0,O.dg)(p);if(h.length!==s.length)throw Error("Mismatch in number of cards returned from AI");let m=s.map(e=>e.cardJson),g=h.map(e=>(0,B.dE)(e)),x=new em({toolCallId:n.toolCallId,messageId:i,originalCardJsons:m,editedCardJsons:g});return await x.apply(t),l.dispatch((0,P.Ed)(x)),{status:"success",suggestionId:x.id}}},createCard:{execute:async function(e,t,n,i){let r,{editor:o,store:l,imageOptions:a}=t,{createPosition:s,createPositionCardId:d,...c}=e,u=Z.findCardInsertRange(o,d,s),p=(0,ee.h)(o,l),h=(0,ea.ze)(o,u.from),{templateCardId:m,...g}=e;if(m){let e=Z.findCardById(o,m);e&&(r=e.cardHtml)}let x=await (0,Q.K8)({promptKey:"GenerateCardWithLayout",variables:{...g,templateText:r,imageProvider:a.imageProvider,imageOptions:{model:a.imageModel,stylePrompt:a.imageStyle,visualsMenuEnabled:a.visualsMenuEnabled,artStylePreset:a.artStylePreset,artStylePrompt:a.artStylePrompt},...p,outline:"",previous:h},workspaceId:(0,M.gx)(),opts:{abortController:t.abortController}}),f=(0,B.dE)(x),y=f.attrs.id,v=new ec({messageId:i,toolCallId:n.toolCallId,cardId:y,cardJson:f,createPositionCardId:d,createPosition:s});return await v.apply(t),l.dispatch((0,P.Ed)(v)),{status:"success",newCardId:y,newCardHtml:x,createPositionCardId:d,createPosition:s,suggestionId:v.id}}},setCardHtml:{execute:async function(e,t,n,i){let{cardId:r,cardHtml:o}=e,{editor:l,store:a}=t;if(!Z.findCardById(l,r))throw Error("Cannot find card with id ".concat(r));return Z.replaceCardHTMLById({cardId:r,cardHtml:o,messageId:i},t),{status:"success",cardId:r,cardHtml:o}}},moveCard:{execute:async function(e,t,n,i){let{cardId:r,movePositionCardId:o,movePosition:l}=e,{store:a}=t,s=new er({toolCallId:n.toolCallId,messageId:i,cardId:r,movePositionCardId:o,movePosition:l});return await s.apply(t),a.dispatch((0,P.Ed)(s)),{status:"success",suggestionId:s.id}}},duplicateCard:{execute:async function(e,t,n,i){let{store:r}=t,{cardId:o,insertPositionCardId:l,insertPosition:a}=e,s=el.Yv.generate(),d=new eh({toolCallId:n.toolCallId,messageId:i,cardId:o,duplicatedCardId:s,insertPositionCardId:l,insertPosition:a});return d.apply(t),r.dispatch((0,P.Ed)(d)),{status:"success",originalCardId:o,duplicatedCardId:s,insertPositionCardId:l,insertPosition:a,suggestionId:d.id}}},revertToCheckpoint:{execute:async function(e,t,n,i){let{store:r}=t,{beforeCheckpointId:o}=e;return Z.loadCheckpoint(t,o),{status:"success",revertedToCheckpointId:o}}},suggestThemes:{execute:async function(e,t,n,i){let{store:r}=t,o=(0,R.SJ)(r.getState()),l=(0,_.ST)(r.getState()).map(ey).filter(e=>e.id!==o.id),a=Z.getDeckInfo(t),s=await (0,Q.K8)({promptKey:"SuggestThemes",variables:{docHtml:a.docHtml,allThemes:l,userRequest:e.userRequest},workspaceId:(0,M.gx)(),opts:{abortController:t.abortController}}),d=JSON.parse((0,O.DB)(s)).themes.map((e,t)=>{let{id:n,name:i}=e;return{themeId:n,themeName:i}}).filter(e=>!!l.find(t=>t.id===e.themeId)),c={themeId:o.id,themeName:o.name,wasOriginal:!0};if(d[0]){var u;null==(u=t.applyTheme)||u.call(t,d[0].themeId)}return{status:"success",suggestedThemes:[c,...d],beforeThemeId:c.themeId}}},readUrl:{execute:async function(e){let{url:t,mode:n="full"}=e;return{status:"success",...await es(t,n)}}},webSearch:{execute:async function(e){let{query:t,numResults:n=5}=e;return{status:"success",...await ed(t,n)}}}},eb=(0,p.d_)("1234567890abcdefghijklmnopqrstuvwxyz",8),ej=(e,t)=>({id:eb(),jsonContent:e.state.doc.toJSON(),themeId:t,timestamp:new Date().toISOString()}),ew=()=>{let e=(0,A.jL)(),t=(0,A.CU)(),n=T();return(0,h.useCallback)(()=>{let{editor:i}=n,r=(0,P.KF)(t.getState());if(!r)throw Error("No rolling back state");let o=(0,P.BV)(r.currentCheckpointId)(t.getState());if(!o)throw Error("No checkpoint exists with id ".concat(r.currentCheckpointId));e((0,P.rY)()),Z.loadCheckpoint(n,o.id)},[n,e,t])},eC=e=>{let t=(0,A.jL)(),n=(0,A.CU)(),i=T();return(0,h.useCallback)(r=>{let{editor:o}=i;if(!o)return;let l=e.findIndex((e,t)=>e.id===r.id);if(-1===l)throw Error("Cannot find message with id ".concat(r.id));let a=ej(o,(0,R.SJ)(n.getState()).id);t((0,P.AY)(a));let s=(0,P.fN)(r.id)(n.getState());if(!s)throw Error("Cannot find message result");if("applied-changes"!==s.type)throw Error("Cannot rollback non-applied-changes result");let d=(0,P.GL)(s.messageId)(n.getState());if(!d)throw Error("Cannot find applied variation");let c=s.variations.find(e=>e.id===d);if(!c)throw Error("Cannot find applied variation");Z.applyResultVariation(i,c),t((0,P.LU)({messageIndex:l,resultId:s.messageId,currentCheckpointId:a.id,chosenVariationId:c.id}))},[i,t,e,n])};var eI=n(12364),eS=n.n(eI),ek=n(85011);let eA=function(){let{onStart:e,onEnd:t,onUpdate:n,element:i=null,endDelay:r=250,updateThrottle:o=100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,h.useRef)(!1),a=(0,h.useRef)(null),s=(0,h.useRef)(null),d=(0,h.useRef)(0),c=(0,h.useRef)(!1);(0,h.useEffect)(()=>{c.current="onscrollend"in window},[]);let u=(0,h.useCallback)(()=>{let e=Date.now(),t=e-d.current;t>=o?(d.current=e,null==n||n()):(s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{d.current=Date.now(),null==n||n()},o-t))},[n,o]),p=(0,h.useCallback)(()=>{l.current||(l.current=!0,null==e||e())},[e]),m=(0,h.useCallback)(()=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{l.current&&(l.current=!1,null==t||t())},r)},[t,r]),g=(0,h.useCallback)(()=>{p(),n&&u(),c.current||m()},[p,m,u,n]),x=(0,h.useCallback)(()=>{l.current&&(l.current=!1,null==t||t())},[t]);return(0,h.useEffect)(()=>{if(i)return i.addEventListener("scroll",g,{passive:!0}),c.current&&i.addEventListener("scrollend",x,{passive:!0}),()=>{i.removeEventListener("scroll",g),c.current&&i.removeEventListener("scrollend",x),a.current&&clearTimeout(a.current),s.current&&clearTimeout(s.current)}},[i,g,x]),{isScrolling:l.current,supportsScrollEnd:c.current}};var eE=n(85235),e_=n(23460);let eR=(e,t)=>e.length===t.length&&e.every((e,n)=>e.cardId===t[n].cardId&&e.pos===t[n].pos&&e.inView===t[n].inView),eP=e=>{let t=e.filter(e=>e.overlap>=.6);if(0===t.length)return[];if(0===t.filter(e=>e.overlap>.6).length){let e=t.reduce((e,t)=>e.overlap>t.overlap?e:t,t[0]);return[{cardId:e.id,pos:e.pos,inView:"partial"}]}return t.map(e=>({cardId:e.id,pos:e.pos,inView:e.overlap>=.9?"full":"partial"}))},eT=(e,t,n,i)=>{let r=i-n;return Math.max(r-Math.max(e-n,0)-Math.max(i-t,0),0)/r},ez=e=>{let t=(0,eo.u)("buddyEdit"),n=(0,A.GV)(R.wC),i=(0,ek.O2)("editor"),[r,o]=(0,h.useState)(null),l=(0,A.jL)(),a=(0,h.useRef)([]),s=(0,h.useRef)(n);s.current=n;let d=(0,h.useRef)({scrollTop:0,containerHeight:0}),c=(0,h.useCallback)(e=>{eR(a.current,e)||(a.current=e,l((0,P.vz)(e)))},[l]),u=(0,h.useCallback)(function(){let n=s.current===eE.w.SLIDE_VIEW;if(document.hidden||!e||!t||n)return;let{scrollTop:r,containerHeight:o}=d.current,l=r+o,a=(0,D.xe)(e.state.doc,et.jg).filter(t=>1===e.state.doc.resolve(t.pos).depth),u=document.querySelector(i.scrollSelector);if(!u)return;let p=(0,e_.sR)(u,i.scrollSelector),h=[];for(let t of a){let n,o=t.node.attrs.id;try{n=e.view.nodeDOM(t.pos)}catch(e){console.error("computeOverlap error",e);continue}if(n instanceof HTMLElement){n=n.querySelector("[data-card-body]");let e=(0,e_.sR)(n,i.scrollSelector)-p;if(e>l)break;let{offsetHeight:a}=n,s=a+e;h.push({id:o,pos:t.pos,overlap:eT(r,l,e,s)})}}c(eP(h.sort((e,t)=>e.pos-t.pos)))},[t,c,e,i.scrollSelector]);eA({element:r,onUpdate:()=>{r&&(d.current.scrollTop=r.scrollTop,u())},onEnd:()=>{r&&(d.current.scrollTop=r.scrollTop,u())},endDelay:250,updateThrottle:100}),(0,h.useEffect)(()=>{if(!t)return;let e=eS()(()=>{r&&(d.current.containerHeight=r.getBoundingClientRect().height,u())},250,{trailing:!0,maxWait:500});return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t,u,r]),(0,h.useEffect)(()=>{if(!t)return;let e=document.querySelector(i.scrollSelector);e&&(o(e),d.current.scrollTop=e.scrollTop,d.current.containerHeight=e.getBoundingClientRect().height,u())},[i.scrollSelector,d,t,u]),(0,h.useEffect)(()=>{let e=setInterval(()=>{u()},1e3);return()=>clearInterval(e)},[u])};var eM=n(11403),eD=n(6807);let eO=e=>{let{enabled:t}=e,n=(0,A.CU)(),i=(0,A.jL)(),[r,o]=(0,eD.M)("buddyState",{...P.qP,messages:[]}),l=(0,eM.lW)(o,1e3),a=(0,h.useRef)([]);return(0,h.useEffect)(()=>{if(t)return n.subscribe(()=>{let e=n.getState().Buddy;if(null!==e){let{editor:t,...n}=e;l({...n,messages:a.current})}})},[]),(0,h.useEffect)(()=>{if(!t)return;let e=n.getState().Buddy.editor;i((0,P.Gu)({...r,editor:e}))},[]),{initialMessages:t&&r.messages||[],messagesRef:a}},eL={createCard:{present:()=>u.Ru._({id:"YFvSg3"}),past:()=>u.Ru._({id:"Z801fH"})},editCardById:{present:()=>u.Ru._({id:"y5kNPl"}),past:()=>u.Ru._({id:"nTOyvW"})},editAllCards:{present:()=>u.Ru._({id:"+mgW41"}),past:()=>u.Ru._({id:"tor7fY"})},focusCardById:{present:()=>u.Ru._({id:"dwh4Lg"}),past:()=>u.Ru._({id:"t0SVyb"})},removeCards:{present:()=>u.Ru._({id:"PPHKL3"}),past:()=>u.Ru._({id:"EgCNgl"})},setCardHtml:{present:()=>u.Ru._({id:"jubeck"}),past:()=>u.Ru._({id:"+BZeOo"})},moveCard:{present:()=>u.Ru._({id:"2VD+0p"}),past:()=>u.Ru._({id:"B8He3D"})},duplicateCard:{present:()=>u.Ru._({id:"tO+JlV"}),past:()=>u.Ru._({id:"PdoIWT"})},revertToCheckpoint:{present:()=>u.Ru._({id:"fIJtam"}),past:()=>u.Ru._({id:"i8Of62"})},suggestThemes:{present:()=>u.Ru._({id:"EGiXRh"}),past:()=>u.Ru._({id:"exJFz8"})},readUrl:{present:()=>u.Ru._({id:"L7svJg"}),past:()=>u.Ru._({id:"cQlPDN"})},webSearch:{present:()=>u.Ru._({id:"f2YVZg"}),past:()=>u.Ru._({id:"AzLUkE"})}},eN=e=>eL[e];var eB=n(64072);n(90010);let eU=e=>"result"===e.state&&!!e.result&&"object"==typeof e.result&&"error"===e.result.status,eF=e=>"result"===e.state&&!!e.result&&"object"==typeof e.result&&"success"===e.result.status,eW=(e,t,n,i)=>{for(let r of[eV,eG])if(r(e,t,n,i))return},eG=(e,t,n,i)=>{let r=function(e){var t;let n=(null==(t=e.parts)?void 0:t.filter(e=>"tool-invocation"===e.type))||[],i=null;return n.filter(e=>"tool-invocation"===e.type).forEach(e=>{eF(e.toolInvocation)&&"suggestedThemes"in e.toolInvocation.result&&(i=e.toolInvocation.result.suggestedThemes)}),i}(n);if(!r)return!1;let o={messageId:n.id,title:u.Ru._({id:"H7jm8i"}),type:"suggest-themes",themes:r};return e.dispatch((0,P.AY)(i)),e.dispatch((0,P.Jw)(o)),!0},eV=(e,t,n,i)=>{let r=ej(t,(0,R.SJ)(e.getState()).id),o=eH(e,n,i,r);return!!o&&(e.dispatch((0,P.AY)(i)),e.dispatch((0,P.AY)(r)),e.dispatch((0,P.Jw)(o)),e.dispatch((0,P.rD)({messageId:o.messageId,variationId:o.variations[1].id})),!0)},eH=(e,t,n,i)=>{let r=function(e,t){var n;return((null==(n=e.parts)?void 0:n.filter(e=>"tool-invocation"===e.type))||[]).filter(e=>"tool-invocation"===e.type).map(e=>{if(eF(e.toolInvocation)&&"suggestionId"in e.toolInvocation.result){let n=e.toolInvocation.result.suggestionId;if(n)return t[n]}}).filter(e=>!!e)}(t,e.getState().Buddy.suggestions);if(0===r.length)return null;let o=t.id,{originalPreviewCardIds:l,modifiedPreviewCardIds:a,originalScrollToCardId:s,modifiedScrollToCardId:d,previewType:c}=eq({beforeContent:n.jsonContent,afterContent:i.jsonContent,suggestions:r}),p={id:"original",messageId:o,name:u.Ru._({id:"HxF6Fk"}),toApplyCheckpointId:n.id,previewCardIds:l,scrollToCardId:s,previewType:c},h={id:"modified",messageId:o,name:u.Ru._({id:"tgWuMB"}),toApplyCheckpointId:i.id,previewCardIds:a,scrollToCardId:d,previewType:c};return{type:"applied-changes",messageId:o,title:function(e){return 0===e.length?u.Ru._({id:"Ef7StM"}):e.length>1?u.Ru._({id:"WTvBlv"}):eN(e[0].type).past()}(r),variations:[p,h]}},eq=e=>{let{beforeContent:t,afterContent:n,suggestions:i}=e,r=new D.KE({extensions:(0,eB.C)(),content:n}),o=new D.KE({extensions:(0,eB.C)(),content:t}),l=1===i.length&&"card"===i[0].previewType,a=i.map(e=>({pos:e.getAppliedFirstPos({editor:r}),suggestion:e})).filter(e=>null!=e.pos).sort((e,t)=>e.pos-t.pos)[0].suggestion;return{originalPreviewCardIds:a.getOriginalPreviewCardIds({editor:o}),modifiedPreviewCardIds:a.getModifiedPreviewCardIds({editor:r}),originalScrollToCardId:a.originalCardToSelect({editor:o}),modifiedScrollToCardId:a.modifiedCardToSelect({editor:r}),previewType:l?"card":"doc"}};var eK=n(74158);let eY={createCard:e=>new ec(e),duplicateCard:e=>new eh(e),editCardById:e=>new eg(e),removeCards:e=>new ef(e),editAllCards:e=>new eg(e),moveCard:e=>new er(e),setCardHtml:()=>{throw Error("Not implemented")},focusCardById:()=>{throw Error("Not implemented")},revertToCheckpoint:()=>{throw Error("Not implemented")},suggestThemes:()=>{throw Error("Not implemented")},readUrl:()=>{throw Error("Not implemented")},webSearch:()=>{throw Error("Not implemented")}},eX={type:"doc",content:[{type:"document",attrs:{aiOptions:{preserveLayouts:!1,imageOptions:{license:"All",provider:"aiGenerated",generateStyle:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",model:"flux-1-schnell",stylePreset:"Theme"}},docId:"nono90o4qpq5ob7",background:{type:"none"},docFlags:{cardLayoutsEnabled:!0},format:"deck",customCode:{},settings:{defaultFullBleed:"contained",stylesDerivedFrom:"deck_default",cardDimensions:"fluid",verticalAlign:"center",defaultContentWidth:"lg",fontSize:"md",scaleContentToFit:!1,animationsEnabled:!0},generateStatus:"done",generateInfo:{interactionId:"q2dl35labe1zc6v",streamId:"nono90o4qpq5ob7",lastEventId:"8",lastCompletedCardId:"5e8a3a2i4zeax4f",lastCompletedCardIndex:7}},content:[{type:"card",attrs:{id:"1643zoszvd9ioaj",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"left",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"IoMxT",horizontalAlign:null,savedMediaId:"czelj4ujxi4tv6v",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/0_RF_8Yh9hDshk2BGwP-w.jpg",tempUrl:null,uploadStatus:3,meta:{width:896,height:1152},providerMeta:null,aiParams:{model:"flux-1-schnell",steps:30,width:896,height:1152,prompt:"bright futuristic cityscape, abstract, glowing lines and shapes, AI-powered skyscrapers",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",interactionId:"q2dl35labe1zc6v",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"bright futuristic cityscape, abstract, glowing lines and shapes, AI-powered skyscrapers",options:{model:"flux-1-schnell",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"VkEw8",name:null,query:"bright futuristic cityscape, abstract, glowing lines and shapes, AI-powered skyscrapers",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"baseten"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Artificial Intelligence: Reshaping the Future of Software Engineering"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Artificial Intelligence (AI) is transforming the software engineering landscape, offering unprecedented opportunities to enhance efficiency, creativity, and problem-solving in the development process."}]},{type:"contributors",attrs:{horizontalAlign:null,showTime:!0,hiddenContributorIds:[]}}]}]},{type:"card",attrs:{id:"subtxtl909ov81t",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"blank",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Understanding AI: Fundamentals and Capabilities"}]},{type:"gridLayout",attrs:{colWidths:[25,25,25,25],fullWidthBlock:!1},content:[{type:"gridCell",attrs:{verticalAlign:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Machine Learning"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Algorithms learn from data to improve performance, making predictions and automating tasks."}]}]},{type:"gridCell",attrs:{verticalAlign:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Deep Learning"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Neural networks mimic the human brain, enabling complex pattern recognition and decision-making."}]}]},{type:"gridCell",attrs:{verticalAlign:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Natural Language Processing"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Enables computers to understand and interpret human language, facilitating communication and interaction."}]}]},{type:"gridCell",attrs:{verticalAlign:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Computer Vision"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:'Allows computers to "see" and interpret images and videos, opening doors for automation and analysis.'}]}]}]}]}]},{type:"card",attrs:{id:"dst7w3sibmp242d",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"left",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"7vuqd",horizontalAlign:null,savedMediaId:"qxjreo3e6ows005",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/XLtRiykvWKF70DvzIe5Rp.jpg",tempUrl:null,uploadStatus:3,meta:{width:896,height:1152},providerMeta:null,aiParams:{model:"flux-1-schnell",steps:30,width:896,height:1152,prompt:"a flowchart or diagram illustrating the software development lifecycle, showing the stages and how AI integrates into each step",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",interactionId:"q2dl35labe1zc6v",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"a flowchart or diagram illustrating the software development lifecycle, showing the stages and how AI integrates into each step",options:{model:"flux-1-schnell",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"xu1J9",name:null,query:"a flowchart or diagram illustrating the software development lifecycle, showing the stages and how AI integrates into each step",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"baseten"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"The Role of AI in Software Development Lifecycle"}]},{type:"smartLayout",attrs:{variantKey:"timeline",options:{orientation:"vertical",twoSided:!1,cellSize:"xl"},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"SvHzr",options:{},width:null,image:null,label:null},content:[{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Requirement gathering and analysis."}]}]},{type:"smartLayoutCell",attrs:{id:"cWKyF",options:{},width:null,image:null,label:null},content:[{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Code design and development."}]}]},{type:"smartLayoutCell",attrs:{id:"EfcAJ",options:{},width:null,image:null,label:null},content:[{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Testing and quality assurance."}]}]},{type:"smartLayoutCell",attrs:{id:"MXt73",options:{},width:null,image:null,label:null},content:[{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Deployment and maintenance."}]}]}]}]}]},{type:"card",attrs:{id:"7rv84ceo7lrhxcb",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"top",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"tdPKv",horizontalAlign:null,savedMediaId:"fihn4qh2q7w1oe3",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/DvbFABVzie8oFJ1YYs_dc.jpg",tempUrl:null,uploadStatus:3,meta:{width:1216,height:832},providerMeta:null,aiParams:{model:"flux-1-schnell",steps:30,width:1216,height:832,prompt:"a developer using a code editor with AI-powered code completion and suggestions, lines of code highlighted and suggestions appearing on screen",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",interactionId:"q2dl35labe1zc6v",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"a developer using a code editor with AI-powered code completion and suggestions, lines of code highlighted and suggestions appearing on screen",options:{model:"flux-1-schnell",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",aspectRatio:"landscape"}},loadImageStatus:"done",loadImageId:"KnMgT",name:null,query:"a developer using a code editor with AI-powered code completion and suggestions, lines of code highlighted and suggestions appearing on screen",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"baseten"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Enhancing Code Generation and Automation"}]},{type:"smartLayout",attrs:{variantKey:"bullets",options:{cellSize:15,numbered:!1},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"uc0WK",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Code completion"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI predicts and suggests code snippets as developers type, improving efficiency and reducing errors."}]}]},{type:"smartLayoutCell",attrs:{id:"sDMsL",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Automated code generation"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI can generate code from natural language descriptions, automating repetitive tasks and freeing up developers for more complex work."}]}]},{type:"smartLayoutCell",attrs:{id:"6_00F",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Refactoring and optimization"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI can analyze code and suggest improvements, optimizing performance and maintainability."}]}]}]}]}]},{type:"card",attrs:{id:"p5l6uht47h0ongb",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"right",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"kickO",horizontalAlign:null,savedMediaId:"p46pf7pmt8zigwu",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/h04N7s6Ww1toWmq7RSyiW.jpg",tempUrl:null,uploadStatus:3,meta:{width:896,height:1152},providerMeta:null,aiParams:{model:"flux-1-schnell",steps:30,width:896,height:1152,prompt:"a computer screen displaying a testing environment, with code highlighted and test results displayed, showing AI-powered tools in action",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",interactionId:"q2dl35labe1zc6v",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"a computer screen displaying a testing environment, with code highlighted and test results displayed, showing AI-powered tools in action",options:{model:"flux-1-schnell",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"akxtK",name:null,query:"a computer screen displaying a testing environment, with code highlighted and test results displayed, showing AI-powered tools in action",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"baseten"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Improving Software Testing and Quality Assurance"}]},{type:"smartLayout",attrs:{variantKey:"iconsText",options:{cellSize:"xl",orientation:"vertical",twoSided:!1},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"oN4Fo",options:{},width:null,image:{loadImageParams:{provider:"fontawesome",query:"bug",options:{license:"All",aspectRatio:"landscape"}},loadImageStatus:"done",loadImageId:"ozCK1",source:"image.icon",src:"https://cdn-staging.gamma.app/_app_static/icons/v0/bug.svg",tempUrl:"",meta:{height:512,width:512},query:"bug",uploadStatus:3},label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Bug detection"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI can identify potential defects and vulnerabilities in code, improving software quality and reducing risks."}]}]},{type:"smartLayoutCell",attrs:{id:"wGAuu",options:{},width:null,image:{loadImageParams:{provider:"fontawesome",query:"test",options:{license:"All",aspectRatio:"landscape"}},loadImageStatus:"done",loadImageId:"sDgNK",source:"image.icon",src:"https://cdn-staging.gamma.app/_app_static/icons/v0/vials.svg",tempUrl:"",meta:{height:512,width:512},query:"test",uploadStatus:3},label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Automated testing"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI can create and execute tests automatically, increasing test coverage and efficiency."}]}]},{type:"smartLayoutCell",attrs:{id:"goCsu",options:{},width:null,image:{loadImageParams:{provider:"fontawesome",query:"performance",options:{license:"All",aspectRatio:"landscape"}},loadImageStatus:"done",loadImageId:"JbXE0",source:"image.icon",src:"https://cdn-staging.gamma.app/_app_static/icons/v0/chart-simple.svg",tempUrl:"",meta:{height:512,width:448},query:"performance",uploadStatus:3},label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Performance analysis"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI can monitor software performance and identify bottlenecks, optimizing performance and user experience."}]}]}]}]}]},{type:"card",attrs:{id:"y4odbtb4upq3ift",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"blank",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"AI-Powered Software Maintenance and Optimization"}]},{type:"smartLayout",attrs:{variantKey:"pyramid",options:{},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"heB4z",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Predictive maintenance"}]}]},{type:"smartLayoutCell",attrs:{id:"XYkDn",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Performance optimization"}]}]},{type:"smartLayoutCell",attrs:{id:"5V7bG",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Security patching"}]}]}]}]}]},{type:"card",attrs:{id:"ixg1xiht8rgz588",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"left",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"z4IBN",horizontalAlign:null,savedMediaId:"2mbwgbdat5hbbo5",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/BTpnB4rh5sLATVKCePiCM.jpg",tempUrl:null,uploadStatus:3,meta:{width:896,height:1152},providerMeta:null,aiParams:{model:"flux-1-schnell",steps:30,width:896,height:1152,prompt:"a futuristic cityscape, showing a balance between technology and nature, a blend of AI and ethical considerations",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",interactionId:"q2dl35labe1zc6v",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"a futuristic cityscape, showing a balance between technology and nature, a blend of AI and ethical considerations",options:{model:"flux-1-schnell",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"7VF7H",name:null,query:"a futuristic cityscape, showing a balance between technology and nature, a blend of AI and ethical considerations",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"baseten"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Ethical Considerations and Responsible AI Practices"}]},{type:"smartLayout",attrs:{variantKey:"textBoxes",options:{cellSize:"xl",orientation:"vertical",twoSided:!1},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"om1EM",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Bias detection"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI models can perpetuate existing biases, necessitating careful analysis and mitigation."}]}]},{type:"smartLayoutCell",attrs:{id:"D-jOF",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Data privacy"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI systems often rely on large datasets, requiring robust data privacy and security measures."}]}]},{type:"smartLayoutCell",attrs:{id:"n7iki",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Transparency and explainability"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Understanding how AI models make decisions is crucial for trust and accountability."}]}]}]}]}]},{type:"card",attrs:{id:"5e8a3a2i4zeax4f",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"left",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"8sgUZ",horizontalAlign:null,savedMediaId:"73wqna30pkk9j1g",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/XBXNDbQuLFDPjE4LT3KWK.jpg",tempUrl:null,uploadStatus:3,meta:{width:896,height:1152},providerMeta:null,aiParams:{model:"flux-1-schnell",steps:30,width:896,height:1152,prompt:"a futuristic tech scene, showing AI-powered robots and software collaborating with human developers, with a positive and hopeful mood",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",interactionId:"q2dl35labe1zc6v",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"a futuristic tech scene, showing AI-powered robots and software collaborating with human developers, with a positive and hopeful mood",options:{model:"flux-1-schnell",stylePreset:"Theme",stylePrompt:"Subtle and professional with a modern and tech-focused design, using light shades of blue and white for a clean, corporate look.",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"2fNqi",name:null,query:"a futuristic tech scene, showing AI-powered robots and software collaborating with human developers, with a positive and hopeful mood",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"baseten"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"The Future of AI in Software Engineering: Trends and Predictions"}]},{type:"smartLayout",attrs:{variantKey:"stats",options:{cellSize:"xl",orientation:"vertical",twoSided:!1},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"eErVH",options:{},width:null,image:null,label:"1"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Increased automation"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI will continue to automate more tasks, freeing developers for creative and strategic work."}]}]},{type:"smartLayoutCell",attrs:{id:"ca3B6",options:{},width:null,image:null,label:"2"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"More personalized experiences"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI will enable the development of highly personalized software experiences tailored to individual users."}]}]},{type:"smartLayoutCell",attrs:{id:"K6Iai",options:{},width:null,image:null,label:"3"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Enhanced security"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"AI will play a crucial role in detecting and preventing cyber threats, ensuring software security."}]}]}]}]}]}]}]},eJ={type:"doc",content:[{type:"document",attrs:{aiOptions:{preserveLayouts:!1,imageOptions:{license:"All",provider:"aiGenerated",generateStyle:"light green white cool, friendly playful elegant clean modern fresh",model:"recraft-v3-svg",stylePreset:"Theme"}},docId:"u8p5nbzhww4im32",background:{type:"none"},docFlags:{cardLayoutsEnabled:!0},format:"deck",customCode:{},settings:{defaultFullBleed:"contained",stylesDerivedFrom:"deck_default",cardDimensions:"fluid",verticalAlign:"center",defaultContentWidth:"lg",fontSize:"md",scaleContentToFit:!1,animationsEnabled:!0},generateStatus:"done",generateInfo:{interactionId:"pcrgh5cmhjmbu0r",streamId:"u8p5nbzhww4im32",lastEventId:"6",lastCompletedCardId:"hm6st3psdgzor5y",lastCompletedCardIndex:5}},content:[{type:"card",attrs:{id:"7r1rzy9nzyuqjvz",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"left",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"3yTLK",horizontalAlign:null,savedMediaId:"lifgg20xpoutrce",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/T8KNdVM9zsJ9S_ym8eTyP.svg",tempUrl:null,uploadStatus:3,meta:{width:1024,height:1707},providerMeta:null,aiParams:{model:"recraft-v3-svg",steps:30,width:1024,height:1707,prompt:"Authentic Japanese sukiyaki hotpot on a traditional low table, steaming with flavorful broth and various colorful ingredients, soft warm lighting, cozy home dinning setting",stylePreset:"Theme",stylePrompt:"light green white cool, friendly playful elegant clean modern fresh",interactionId:"pcrgh5cmhjmbu0r",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"Authentic Japanese sukiyaki hotpot on a traditional low table, steaming with flavorful broth and various colorful ingredients, soft warm lighting, cozy home dinning setting",options:{model:"recraft-v3-svg",stylePreset:"Theme",stylePrompt:"light green white cool, friendly playful elegant clean modern fresh",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"I2A0Q",name:null,query:"Authentic Japanese sukiyaki hotpot on a traditional low table, steaming with flavorful broth and various colorful ingredients, soft warm lighting, cozy home dinning setting",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"recraft"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Sukiyaki: A Delicious Japanese Hotpot"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Embark on a culinary journey to Japan with the art of making sukiyaki at home. This traditional Japanese hotpot dish offers a unique dining experience that combines rich flavors, social interaction, and the pleasure of cooking together. In this presentation, we'll guide you through selecting ingredients, preparing the perfect broth, and mastering the cooking techniques for an authentic sukiyaki experience."}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Whether you're a novice cook or an adventurous foodie, sukiyaki allows you to create a customizable meal that's both nutritious and flavorful. So, gather friends and family at the table for a communal cooking experience that will leave your taste buds and your spirit enriched."}]},{type:"contributors",attrs:{horizontalAlign:null,showTime:!0,hiddenContributorIds:[]}}]}]},{type:"card",attrs:{id:"4uj9pir12jyf982",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"right",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"HOy7V",horizontalAlign:null,savedMediaId:"1w6fe4naysajnsu",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/MVt3q2RSgW2aV4NyNsWpF.svg",tempUrl:null,uploadStatus:3,meta:{width:1024,height:1707},providerMeta:null,aiParams:{model:"recraft-v3-svg",steps:30,width:1024,height:1707,prompt:"Variety of fresh ingredients for sukiyaki laid out on a wooden cutting board, including thin slices of beef, colorful vegetables, tofu, and seasonings, bright kitchen lighting",stylePreset:"Theme",stylePrompt:"light green white cool, friendly playful elegant clean modern fresh",interactionId:"pcrgh5cmhjmbu0r",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"Variety of fresh ingredients for sukiyaki laid out on a wooden cutting board, including thin slices of beef, colorful vegetables, tofu, and seasonings, bright kitchen lighting",options:{model:"recraft-v3-svg",stylePreset:"Theme",stylePrompt:"light green white cool, friendly playful elegant clean modern fresh",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"6BSwv",name:null,query:"Variety of fresh ingredients for sukiyaki laid out on a wooden cutting board, including thin slices of beef, colorful vegetables, tofu, and seasonings, bright kitchen lighting",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"recraft"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Ingredients for Authentic Sukiyaki"}]},{type:"smartLayout",attrs:{variantKey:"iconsText",options:{cellSize:"xl",orientation:"vertical",twoSided:!1},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"tS2ML",options:{},width:null,image:{loadImageParams:{provider:"fontawesome",query:"beef",options:{license:"All",aspectRatio:"landscape"}},loadImageStatus:"done",loadImageId:"QFUSR",source:"image.icon",src:"https://cdn-staging.gamma.app/_app_static/icons/v0/meat.svg",tempUrl:"",meta:{height:512,width:512},query:"beef",uploadStatus:3},label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Thinly Sliced Beef"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Use premium cuts like wagyu or ribeye for maximum flavor and tenderness. Slice against the grain for even cooking."}]}]},{type:"smartLayoutCell",attrs:{id:"p--DO",options:{},width:null,image:{loadImageParams:{provider:"fontawesome",query:"vegetables",options:{license:"All",aspectRatio:"landscape"}},loadImageStatus:"done",loadImageId:"rjjNp",source:"image.icon",src:"https://cdn-staging.gamma.app/_app_static/icons/v0/burger-lettuce.svg",tempUrl:"",meta:{height:512,width:512},query:"vegetables",uploadStatus:3},label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Colorful Vegetables"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Include a variety of colorful vegetables like shirataki, mushrooms, carrots, and lotus root for texture and flavor."}]}]},{type:"smartLayoutCell",attrs:{id:"l2zIi",options:{},width:null,image:{loadImageParams:{provider:"fontawesome",query:"tofu",options:{license:"All",aspectRatio:"landscape"}},loadImageStatus:"done",loadImageId:"kPSX8",source:"image.icon",src:"https://cdn-staging.gamma.app/_app_static/icons/v0/scanner-touchscreen.svg",tempUrl:"",meta:{height:512,width:512},query:"tofu",uploadStatus:3},label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Bland Ingredients"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Don't forget tofu and boiled eggs for protein and as mild flavors to absorb the rich broth."}]}]},{type:"smartLayoutCell",attrs:{id:"81-Il",options:{},width:null,image:{loadImageParams:{provider:"fontawesome",query:"miso",options:{license:"All",aspectRatio:"landscape"}},loadImageStatus:"done",loadImageId:"Sd5x7",source:"image.icon",src:"https://cdn-staging.gamma.app/_app_static/icons/v0/mistletoe.svg",tempUrl:"",meta:{height:512,width:576},query:"miso",uploadStatus:3},label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Seasonings"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Use soy sauce, sake, and mirin for marinades, and miso for enhancing the broth's umami flavor."}]}]}]}]}]},{type:"card",attrs:{id:"qn6znn1bychl8v2",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"blank",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Preparing the Broth and Dipping Sauce"}]},{type:"gridLayout",attrs:{colWidths:[33.33,33.33,33.33],fullWidthBlock:!1},content:[{type:"gridCell",attrs:{verticalAlign:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Classic Dashi Broth"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Start with a traditional dashi broth by simmering kombu seaweed and katsuobushi for a rich umami flavor. Add soy sauce, mirin, and sake to create a savory base for your sukiyaki."}]}]},{type:"gridCell",attrs:{verticalAlign:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Modern Variations"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Experiment with other broths like savory tonkotsu (pork bone) or light chicken-based options for different flavor profiles. Always ensure your broth is hot and flavorful before adding ingredients."}]}]},{type:"gridCell",attrs:{verticalAlign:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Perfect Ponzu Sauce"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Prepare a dipping sauce by whisking together soy sauce, vinegar, and yuzu citrus juice. This tangy ponzu complements the rich flavors of the cooked ingredients and adds brightness to every bite."}]}]}]}]}]},{type:"card",attrs:{id:"vaz2qowbjo6u8wy",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"left",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"Dr61d",horizontalAlign:null,savedMediaId:"rg9v2ib7d761apq",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/A_JAcGJeT5Vzb08u0j7MD.svg",tempUrl:null,uploadStatus:3,meta:{width:1024,height:1707},providerMeta:null,aiParams:{model:"recraft-v3-svg",steps:30,width:1024,height:1707,prompt:"Artful arrangement of thinly sliced beef ribeye, chicken thigh, pork belly, and an assortment of colorful vegetables on a large oval platter, studio lighting",stylePreset:"Theme",stylePrompt:"light green white cool, friendly playful elegant clean modern fresh",interactionId:"pcrgh5cmhjmbu0r",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"Artful arrangement of thinly sliced beef ribeye, chicken thigh, pork belly, and an assortment of colorful vegetables on a large oval platter, studio lighting",options:{model:"recraft-v3-svg",stylePreset:"Theme",stylePrompt:"light green white cool, friendly playful elegant clean modern fresh",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"I98zN",name:null,query:"Artful arrangement of thinly sliced beef ribeye, chicken thigh, pork belly, and an assortment of colorful vegetables on a large oval platter, studio lighting",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"recraft"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Choosing the Right Meat and Vegetables"}]},{type:"smartLayout",attrs:{variantKey:"bullets",options:{cellSize:"xl",numbered:!1,orientation:"vertical",twoSided:!1},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"8raJF",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Meat Showcase"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Opt for thinly sliced premium beef cuts like wagyu or ribeye for their tender texture and rich flavor. Chicken thigh and pork (especially thin belly slices) also work beautifully in sukiyaki."}]}]},{type:"smartLayoutCell",attrs:{id:"XE09H",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Vegetable Variety"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Include a colorful array of vegetables including shirataki (white konnyaku noodles), cremini mushrooms, napa cabbage, lotus root, and zucchini for texture and flavor contrast."}]}]},{type:"smartLayoutCell",attrs:{id:"ClCeh",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Seafood Addition"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Crimp shrimp, mussels, and crab legs can add seafood flair to your sukiyaki, but be mindful of cooking times to prevent overcooking."}]}]},{type:"smartLayoutCell",attrs:{id:"NNGn3",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Extra Protein"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Eggs and tofu are great additions that absorb the savory flavors of the broth and provide protein variety for a balanced meal."}]}]}]}]}]},{type:"card",attrs:{id:"bvrndod7ra8z3og",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"left",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardAccentLayoutItem",attrs:{itemId:"accent",fitType:"fill",background:{type:"image",image:{id:"TwXRr",horizontalAlign:null,savedMediaId:"91bxczdf7i0zzce",src:"https://cdn-staging.gamma.app/QWjS6fBfpt/generated-images/7WgUlbv23EbSrim9Ri_Z6.svg",tempUrl:null,uploadStatus:3,meta:{width:1024,height:1707},providerMeta:null,aiParams:{model:"recraft-v3-svg",steps:30,width:1024,height:1707,prompt:"Hands demonstrating sukiyaki cooking technique, including layering ingredients and dipping in sauce, warm lighting highlighting steam and vibrant colors",stylePreset:"Theme",stylePrompt:"light green white cool, friendly playful elegant clean modern fresh",interactionId:"pcrgh5cmhjmbu0r",upscaleFactor:1},loadImageParams:{provider:"aiGenerated",query:"Hands demonstrating sukiyaki cooking technique, including layering ingredients and dipping in sauce, warm lighting highlighting steam and vibrant colors",options:{model:"recraft-v3-svg",stylePreset:"Theme",stylePrompt:"light green white cool, friendly playful elegant clean modern fresh",aspectRatio:"portrait"}},loadImageStatus:"done",loadImageId:"32cfG",name:null,query:"Hands demonstrating sukiyaki cooking technique, including layering ingredients and dipping in sauce, warm lighting highlighting steam and vibrant colors",source:"image.ai-generated",showPlaceholder:null,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null},clickBehavior:null,href:null,provider:"recraft"},source:"image.ai-generated",mask:{effect:"faded"}}}},{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Cooking Techniques for Sukiyaki"}]},{type:"smartLayout",attrs:{variantKey:"timeline",options:{orientation:"vertical",twoSided:!1,cellSize:"xl"},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"DWv1n",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Heat Management"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Start by heating the broth to a gentle simmer. As cooking progresses, adjust the temperature to maintain a controlled bubble for even cooking of all ingredients."}]}]},{type:"smartLayoutCell",attrs:{id:"DcERF",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Layering Ingredients"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Add ingredients in order of cooking time. Begin with tough vegetables and tougher meats, then add more delicate items as the meal progresses."}]}]},{type:"smartLayoutCell",attrs:{id:"H5JS-",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Tasting and Adjusting"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Regularly taste the broth and adjust seasonings. Stir the pot occasionally to ensure even cooking, but let ingredients cook briefly for optimal texture."}]}]},{type:"smartLayoutCell",attrs:{id:"LnBta",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Serving"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"As ingredients are cooked, remove them from the pot and dip in the prepared ponzu sauce before eating. Continue until all ingredients are cooked and enjoyed."}]}]}]}]}]},{type:"card",attrs:{id:"hm6st3psdgzor5y",previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"blank",layoutTemplateColumns:null,layoutTemplateRows:null,verticalAlign:null,generatorInput:null,fontScale:null},content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:1},content:[{type:"text",text:"Mastering the Donabe Setup"}]},{type:"smartLayout",attrs:{variantKey:"textBoxes",options:{cellSize:20},fullWidthBlock:!1},content:[{type:"smartLayoutCell",attrs:{id:"pBrxI",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Choosing the Right Donabe"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Select a traditional earthenware donabe pot designed for sukiyaki. Its thick walls retain heat evenly, creating an optimal cooking environment. If unavailable, a deep cast-iron or stainless steel pot can be used as a substitute."}]}]},{type:"smartLayoutCell",attrs:{id:"5CagX",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Setup and Heating"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Place the donabe in the center of the table. Use a table-top burner for easy access and to maintain heat throughout the meal. Pre-heat the pot before adding ingredients to ensure a flavorful start."}]}]},{type:"smartLayoutCell",attrs:{id:"vWoKO",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Layering Ingredients"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Arrange ingredients in a visually appealing manner around the donabe. This encourages communal cooking and makes it easier for guests to add ingredients as they wish."}]}]},{type:"smartLayoutCell",attrs:{id:"ykwm0",options:{},width:null,image:null,label:null},content:[{type:"heading",attrs:{horizontalAlign:null,placeholder:null,level:4},content:[{type:"text",text:"Temperature Control"}]},{type:"paragraph",attrs:{horizontalAlign:null,placeholder:null,fontSize:null},content:[{type:"text",text:"Maintain a gentle simmer to prevent overcooking delicate ingredients. Adjust the heat as needed throughout the meal to maintain optimal cooking conditions for various foods."}]}]}]}]}]}]}]},e$=[{description:"replace content",userMessages:["actually we're going to lahaina, replace all the content about wailea"],editorContent:eJ},{description:"whats on second card",userMessages:["whats on second card","delete the second card"],editorContent:eX},{description:"move accent to right",userMessages:["move the first card image to the right","make the accent image 50% wide"],editorContent:eX},{description:"regenerate accent image",userMessages:["change the first card image to be of pikachu"],editorContent:eX},{description:"add a conclusion card",userMessages:["add a conclusion card"],editorContent:eX},{description:"delete all but the first card",userMessages:["delete all but the first card"],editorContent:eX},{description:"delete everything but the 5th card",userMessages:["delete everything but the 5th card"],editorContent:eX},{description:"visual appeal and undo",userMessages:["make the second slide more visually appealing","undo that"],editorContent:eX},{description:"sukiyaki - edit to ingredients",userMessages:["rewrite the broth card to be about creating a sukiyaki broth","give me a specific recipe for the sukiyaki broth, show for 2 poeple and 4 people","great now add a delicious looking sukiyaki top banner"],editorContent:eJ,themeId:"pistachio"},{description:"sukiyaki - split the first card",userMessages:["split the first card into two cards"],editorContent:eJ,themeId:"pistachio"}],eZ=e=>{let{reload:t,setMessages:n,isLoading:i}=e,r=(0,A.CU)(),o=(0,A.jL)(),l=(0,h.useRef)(1),[a,s]=(0,h.useState)(!1),d=(0,h.useRef)([]),c=(0,h.useRef)(!1),u=(0,h.useRef)(i);(0,h.useEffect)(()=>{u.current=i},[i]);let p=(0,h.useCallback)(()=>{c.current=!1},[]),m=(0,h.useCallback)(()=>{if(u.current)return;if(0===d.current.length){console.log("No remaining messages"),s(!1),g.current&&(clearInterval(g.current),g.current=null);return}console.log("send message");let[e,...i]=d.current;d.current=i;let r={id:"user-".concat(l.current++),content:e,role:"user"};c.current=!0,n(e=>[...e,r]),t()},[t,n]),g=(0,h.useRef)(null);return{startTestCase:(0,h.useCallback)((e,t)=>{if(g.current)return void console.log("NOT STARTING INTERVAL");n(()=>[]),s(!0),t.themeId&&(0,_.kl)(r.getState()).find(e=>e.id===t.themeId),d.current=t.userMessages,g.current=setInterval(m,1e3)},[o,m,n,r]),isRunning:a,markFinish:p}};var eQ=n(24302),e0=n(58809),e1=n(17074),e6=n(87996),e2=n(80180),e5=n(76694);let e4=(0,p.d_)("1234567890abcdefghijklmnopqrstuvwxyz",16),e8=e=>{let{focusInput:t}=e,n=(0,A.CU)(),r=(0,o.d)(),[l,a]=(0,h.useState)([]),s=(0,h.useCallback)(()=>{a([])},[]),d=(0,h.useCallback)(e=>{a(t=>t.filter(t=>t.id!==e))},[]),c=l.some(e=>!!e.isUploading),u=(0,h.useCallback)(e=>{var o;let s=(0,e0.Jo)(n.getState()),c=null==s||null==(o=s.organization)?void 0:o.id;if(!c)return void console.error("Could not find current doc's workspace id");if(0===e.length)return;let u=e.filter(e=>e.type.startsWith("image/"));if(0===u.length)return;let p=10-l.length;if(p<=0)return void r({title:(0,i.jsx)(b.x6,{id:"ff3IAf"}),description:(0,i.jsx)(b.x6,{id:"VzjO+n",values:{FILE_LIMIT:10}}),status:"warning",duration:3e3,isClosable:!0,position:"bottom-right"});let h=u.slice(0,p);t(),h.forEach(e=>{if("application/pdf"===e.type||e.name.toLowerCase().endsWith(".pdf")){let t={id:e4(),src:"",name:e.name,mimeType:e.type,isUploading:!0,isPdf:!0,size:e.size};a(e=>[...e,t]),(0,e6.QM)(e,c,{onUploadComplete:e=>{a(n=>n.map(n=>n.id===t.id?{...n,src:e.src,isUploading:!1}:n))},onUploadFailed:()=>d(t.id)},"node","importPdf")}else{let t=URL.createObjectURL(e),n={id:e4(),src:t,name:e.name,mimeType:e.type,isUploading:!0,isPdf:!1,size:e.size};a(e=>[...e,n]),(0,e6.QM)(e,c,{onUploadComplete:e=>{a(t=>t.map(t=>t.id===n.id?{...t,src:e.src,isUploading:!1}:t))},onUploadFailed:()=>d(n.id)},"node")}})},[t,d,n,l.length]),{inputElement:p,onClick:m}=(0,e1.c)({handleFilesCallback:u,multiple:!0,accept:"image/*"});return{uploadedFiles:l,hiddenFileInput:p,uploadFiles:u,openFilePicker:m,removeFile:d,resetFiles:s,isUploading:c}},e3=e=>{let{uploadFiles:t}=e;return{onPaste:(0,h.useCallback)(e=>{var n;let i=null==(n=e.clipboardData)?void 0:n.items;if(!i)return;let r=[];Array.from(i).forEach(e=>{if(e.type.startsWith("image/")){let t=e.getAsFile();t&&r.push(t)}}),r.length>0&&(e.preventDefault(),t(r))},[t])}},e9=e=>{let{uploadFiles:t}=e,n=(0,h.useRef)(null),i=(0,h.useCallback)(e=>e.dataTransfer.items&&Array.from(e.dataTransfer.items).some(e=>"file"===e.kind&&e.type.startsWith("image/")),[]),r=(0,h.useCallback)(e=>{var i;e.preventDefault(),null==(i=n.current)||i.classList.remove(e5.u),t(Array.from(e.dataTransfer.files))},[t]),o=(0,h.useCallback)(e=>{var t;e.preventDefault(),null==(t=n.current)||t.classList.remove(e5.u)},[]),l=(0,h.useCallback)(e=>{var t;i(e)&&((0,e2.JO)(e),null==(t=n.current)||t.classList.add(e5.u))},[i]);return{ref:n,onDragLeave:o,onDragOver:l,onDrop:r}};var e7=n(74676),te=n(39247);let tt=e=>{let{cardInView:t}=e,n=(0,A.GV)((0,te.F1)(t.cardId)),r=null!=n?n:t.cardId;return(0,i.jsx)(e7.E,{colorScheme:"blue",variant:"full"===t.inView?"solid":"outline",size:"sm",borderRadius:"md",px:2,py:1,maxW:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flexShrink:0,children:r},t.cardId)};var tn=n(17496),ti=n(29810),tr=n(19783),to=n(39892),tl=n(95889);let ta=e=>{let{handleNewChat:t,messages:n}=e,r=(0,to.ez)("unlimited_credits");return(0,i.jsx)(tn.S,{in:!0,children:(0,i.jsxs)(a.z,{mt:2,children:[n.length>0&&(0,i.jsx)(s.$,{size:"sm",variant:"link",onClick:t,leftIcon:(0,i.jsx)(c.g,{icon:d.V3T,size:"sm"}),children:(0,i.jsx)(b.x6,{id:"hIQkLb"})}),(0,i.jsx)(ti.h,{}),!r&&(0,i.jsx)(tr.f,{modalId:"ai-credits-modal-message-list",variant:"ghost",justify:"flex-end",segmentEvent:tl.VV.GAMMA_UPSELL_CALLOUT_AI_CREDITS_BUDDY_EDIT_CHAT})]})})};var ts=n(3276),td=n(16936),tc=n(26420),tu=n(55597),tp=n(91106),th=n(57963),tm=n(90184),tg=n(89942),tx=n(18833),tf=n(42328),ty=n(71093),tv=n(60908);let tb=(0,tx.P)(tc.a),tj=e=>{let{file:t,removeFile:n,boxSize:r}=e,{isZoomed:o,enterZoom:l,exitZoom:s}=(0,ty.RL)(t.id),p=(0,h.useCallback)(()=>{t.isPdf||t.isUploading||l()},[t.isPdf,t.isUploading,l]);return(0,i.jsxs)(tb,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},position:"relative",role:"group",children:[t.isPdf?(0,i.jsxs)(g.s,{boxSize:r,borderRadius:"md",border:"1px solid",borderColor:"gray.200",bg:"gray.50",display:"flex",flexDir:"column",p:2,children:[(0,i.jsx)(v.E,{fontSize:"xxs",fontWeight:"semibold",noOfLines:1,children:t.name}),(0,i.jsxs)(v.E,{fontSize:"xxs",mt:0,color:"gray.600",children:[((t.size||0)/1024).toFixed(0)," KB"]}),(0,i.jsx)(ti.h,{}),(0,i.jsx)(a.z,{children:(0,i.jsx)(e7.E,{fontSize:"xxs",colorScheme:"gray",children:"PDF"})})]}):(0,i.jsxs)(tc.a,{position:"relative",children:[(0,i.jsx)(f._,{src:t.isUploading?t.src:(0,tv.Ub)(t.src,tv.p7),fallbackSrc:t.src,alt:t.name,boxSize:r,objectFit:"cover",borderRadius:"md",border:"1px solid",borderColor:"gray.200",opacity:t.isUploading?.6:1,cursor:t.isUploading?"default":"zoom-in",onClick:p}),!t.isUploading&&(0,i.jsx)(ty.Gx,{isZoomed:o,exitZoom:s,editor:{isThumbnail:!1,isEditable:!1},children:(0,i.jsx)(g.s,{justify:"center",align:"center",h:"100%",w:"100%",children:(0,i.jsx)(f._,{src:t.src,alt:t.name,maxW:"90vw",maxH:"90vh",objectFit:"contain"})})})]}),t.isUploading&&(0,i.jsx)(tc.a,{position:"absolute",inset:0,display:"flex",justifyContent:"center",alignItems:"center",children:(0,i.jsx)(ts.y,{size:"sm",color:"deepocean.900"})}),!t.isUploading&&(0,i.jsx)(td.K,{opacity:0,_groupHover:{opacity:1},transitionProperty:"common",transitionDuration:"normal",position:"absolute",top:"-6px",insetEnd:"-6px",size:"xs",onClick:()=>n(t.id),"aria-label":u.Ru._({id:"cILfnJ"}),icon:(0,i.jsx)(c.g,{icon:d.Jyw})})]})},tw=e=>{let{uploadedFiles:t,removeFile:n,boxSize:r,...o}=e;return(0,i.jsx)(a.z,{spacing:2,flexWrap:"wrap",as:tx.P.div,layout:!0,...o,children:(0,i.jsx)(tf.N,{initial:!1,children:t.map(e=>(0,i.jsx)(tj,{file:e,removeFile:n,boxSize:r},e.id))})})},tC=e=>{let{isLoading:t,handleSubmit:n,handleStop:r,canStop:o,isDisabled:a,...s}=e,d=(0,tg.ez)("unlimited_credits");return(0,i.jsxs)(g.s,{...s,children:[(0,i.jsx)(ts.y,{boxSize:8,position:"absolute",zIndex:10,pointerEvents:"none",color:"deepocean.950",opacity:+!!t,transitionProperty:"common",transitionDuration:"normal"}),(0,i.jsx)(tp.Tz,{placement:"top",label:o?(0,i.jsx)(l.T,{spacing:0,children:(0,i.jsx)(b.x6,{id:"ygCKqB"})}):(0,i.jsxs)(l.T,{spacing:0,children:[(0,i.jsx)(b.x6,{id:"9p1o+z"}),!d&&(0,i.jsx)(v.E,{color:"gray.400",children:(0,i.jsx)(tm.G,{type:"imageChat",ms:0})}),(0,i.jsx)(tp.iM,{shortcut:"Enter"})]}),children:(0,i.jsx)(td.K,{size:"sm",icon:o?(0,i.jsx)(c.g,{icon:tu.APi}):(0,i.jsx)(c.g,{icon:tu.fmP}),isDisabled:a,"aria-label":u.Ru._({id:"hQRttt"}),onClick:e=>{if(o){e.stopPropagation(),r();return}n()}})})]})},tI=e=>{let{onSubmit:t,onStop:n,inputRef:r,input:o,setInput:l,onUploadClick:p,isLoading:h,uploadedFiles:m,uploadFiles:g,removeFile:f,canSubmit:y}=e,v=(0,eQ.dU)("deepocean.100","gray.700"),j=(0,eQ.dU)("deepocean.600","deepocean.300"),w=(0,eQ.dU)("white","elevation.1"),C=(0,eQ.dU)("rgba(255, 255, 255, 0.8)","rgba(0, 0, 0, 0.8)"),I=u.Ru._({id:"OHwVfR"}),{onPaste:S}=e3({uploadFiles:g}),{...k}=e9({uploadFiles:g});return(0,i.jsx)(x.B,{spacing:0,children:(0,i.jsx)(x.B,{...k,spacing:1,position:"relative",borderRadius:"md",border:"1px solid",borderColor:v,transitionDuration:"normal",transitionProperty:"border-color","data-drop-text":I,sx:{"&:focus-within":{borderColor:j},"&.is-dragging-over":{"&::before":{content:"attr(data-drop-text)",position:"absolute",inset:0,bg:C,backdropFilter:"blur(8px)",borderRadius:"md",pointerEvents:"none",zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"lg",fontWeight:"semibold",color:"sky.600"}}},bg:w,children:(0,i.jsxs)(tc.a,{borderRadius:"md",border:"none",p:2,pt:3,position:"relative",children:[(0,i.jsx)(th._,{ref:r,placeholder:u.Ru._({id:"xOHKQG"}),value:o,onChange:e=>l(e.target.value),onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey){var t;e.preventDefault(),null==(t=e.currentTarget.form)||t.requestSubmit()}},onPaste:S,initialHeight:"30px",resizeOnMount:!1,fontSize:"md",m:0,p:0,px:1,maxHeight:"16rem",overflowY:"auto",borderRadius:"none",border:"none",sx:{"&:focus":{border:"none",outline:"none",boxShadow:"none"}},bg:w,_hover:{bg:"transparent"},_focus:{bg:"transparent"}}),(0,i.jsx)(tn.S,{in:m.length>0,animateOpacity:!0,children:(0,i.jsx)(tw,{uploadedFiles:m,removeFile:f,py:2,boxSize:"4.5rem"})}),(0,i.jsxs)(a.z,{mt:2,zIndex:1,h:8,children:[(0,i.jsx)(s.$,{colorScheme:"gray","aria-label":"Upload files",borderRadius:"md",size:"xs",leftIcon:(0,i.jsx)(c.g,{icon:d.QLR}),onClick:p,children:(0,i.jsx)(b.x6,{id:"ONWvwQ"})}),(0,i.jsx)(ti.h,{}),(0,i.jsx)(tC,{isLoading:h,handleSubmit:t,handleStop:n,canStop:h,isDisabled:!y,top:"1.5",insetEnd:"2",zIndex:10,spacing:2})]})]})})})},tS=e=>{let{status:t,messages:n,handleNewChat:r,manualSubmit:o,handleStop:s}=e,d=(0,A.GV)(P.y3),c=(0,eo.u)("buddyDebug"),[u,p]=(0,h.useState)(""),m=(0,h.useRef)(null),{uploadedFiles:x,uploadFiles:f,openFilePicker:y,removeFile:v,resetFiles:b,isUploading:j,hiddenFileInput:w}=e8({focusInput:(0,h.useCallback)(()=>{var e;null==(e=m.current)||e.focus()},[])}),C="submitted"===t||"streaming"===t,I=!C&&!j&&(""!==u.trim()||x.length>0),S=(0,h.useCallback)(()=>{I&&(o(u,x),p(""),b())},[I,u,o,b,x]);(0,h.useEffect)(()=>{var e;null==(e=m.current)||e.focus()},[]);let k=(0,eQ.dU)("sky.100","gray.700"),E=(0,eQ.dU)("sky.50","gray.900");return(0,i.jsxs)(l.T,{direction:"column",align:"stretch",p:2,borderTop:"1px solid",borderColor:k,bg:E,children:[c&&(0,i.jsx)(a.z,{spacing:2,overflowX:"auto",py:1,children:d.map(e=>(0,i.jsx)(tt,{cardInView:e},e.cardId))}),w,(0,i.jsxs)(g.s,{as:"form",onSubmit:e=>{e.preventDefault(),S()},direction:"column",children:[(0,i.jsx)(tI,{onSubmit:S,onStop:s,inputRef:m,input:u,setInput:p,onUploadClick:y,isLoading:C,uploadedFiles:x,uploadFiles:f,removeFile:v,canSubmit:I}),(0,i.jsx)(ta,{handleNewChat:r,messages:n})]})]})},tk=e=>{let{isReceivingMessages:t,messagesLength:n}=e,i=(0,h.useRef)(null),r=(0,h.useRef)(t),o=(0,h.useRef)(!1),l=(0,h.useRef)(null),a=(0,h.useRef)(!1);return(0,h.useEffect)(()=>{let e=r.current;r.current=t,!e&&t&&(o.current=!1);let s=()=>{i.current&&i.current.scrollIntoView({behavior:"auto",block:"end"})},d=()=>{let e=l.current;if(!e)return!1;let t=e.scrollTop;return e.scrollHeight-t-e.clientHeight<200},c=()=>{t&&!d()&&(o.current=!0)};n>0&&s();let u=l.current;if(u&&u.addEventListener("scroll",c),t){s();let e=setInterval(()=>{o.current||s()},100);return()=>{clearInterval(e),u&&u.removeEventListener("scroll",c)}}if(e&&!t){let e=0,t=setInterval(()=>{s(),++e>=10&&clearInterval(t)},100);return()=>{clearInterval(t),u&&u.removeEventListener("scroll",c)}}if(!a.current){a.current=!0;let e=0,t=setInterval(()=>{s(),++e>=10&&clearInterval(t)},100);return()=>{clearInterval(t),u&&u.removeEventListener("scroll",c)}}return()=>{u&&u.removeEventListener("scroll",c)}},[n,t]),{scrollToRef:i,scrollContainerRef:l}};var tA=n(31113),tE=n(27229),t_=n(67909),tR=n(36071),tP=n(54731),tT=n(17920),tz=n(3674),tM=n(40691),tD=n(88738),tO=n(32617);let tL=e=>{let{buttonText:t="\uD83D\uDC1B",debugTitle:n,debugObject:r}=e,o=(0,tO.u)("buddyDebug"),{isOpen:l,onOpen:a,onClose:d}=(0,tE.j)(),c=(0,h.useCallback)(()=>{try{return tD.Bh(r)}catch(e){return"Error dumping YAML: ".concat(e instanceof Error?e.message:"Unknown error","\n\nRaw object:\n").concat(JSON.stringify(r,null,2))}},[r]);return o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.$,{size:"xs",onClick:a,children:t}),(0,i.jsxs)(t_.aF,{isOpen:l,onClose:d,size:"xl",children:[(0,i.jsx)(tR.m,{}),(0,i.jsxs)(tP.$,{children:[n&&(0,i.jsx)(tT.r,{children:n}),(0,i.jsx)(tz.s,{}),(0,i.jsx)(tM.c,{maxHeight:"80vh",overflow:"auto",children:(0,i.jsx)(tc.a,{overflow:"auto",as:"pre",fontSize:"xs",children:c()})})]})]})]}):null};var tN=n(9329);function tB(){let e=(0,tN._)(["\n  0% {\n    background-position: 200% 0;\n  }\n  100% {\n    background-position: -200% 0;\n  }\n"]);return tB=function(){return e},e}let tU=(0,n(83004).i7)(tB()),tF=e=>{let{children:t,...n}=e,r=(0,eQ.dU)("linear(to-r, deepocean.400 0%, deepocean.700 50%, deepocean.400 100%)","linear(to-r, deepocean.300 0%, deepocean.500 50%, deepocean.300 100%)");return(0,i.jsx)(v.E,{...n,backgroundClip:"text",bgGradient:r,backgroundSize:"200% 100%",animation:"".concat(tU," 3s linear infinite"),children:t})},tW=e=>{let{invocation:t}=e,n="result"===t.state&&t.result,r=(0,eQ.dU)("deepocean.800","deepocean.300");if(!n){let e=eN(t.toolName).present()||u.Ru._({id:"Z3FXyt"});return(0,i.jsxs)(a.z,{justify:"center",align:"center",children:[(0,i.jsx)(ts.y,{size:"xs",color:"deepocean.500"}),(0,i.jsxs)(tF,{fontSize:"sm",fontWeight:"semibold",children:[e,"..."]})]})}return eU(t)?(0,i.jsxs)(a.z,{justify:"space-between",w:"100%",children:[(0,i.jsxs)(v.E,{fontSize:"sm",color:"red.600",fontWeight:"semibold",children:["Error: ",t.result.error]}),(0,i.jsx)(tL,{buttonText:t.toolName,debugTitle:"".concat(t.toolName," (ERROR)"),debugObject:{args:t.args,...t.result}})]}):eF(t)?(0,i.jsxs)(a.z,{justify:"space-between",width:"100%",children:[(0,i.jsx)(v.E,{fontSize:"xs",color:r,fontWeight:"semibold",children:(0,i.jsxs)(a.z,{children:[(0,i.jsx)(c.g,{icon:tu.p7g}),(0,i.jsx)(v.E,{fontSize:"sm",children:eN(t.toolName).past()})]})}),(0,i.jsx)(tL,{debugTitle:t.toolName,debugObject:{args:t.args,...t.result}})]}):null};var tG=n(12417),tV=n(40240),tH=n(83743);let tq=e=>{let{variant:t,onClick:n,ariaLabel:r,...o}=e,l="go-back"===t;return(0,i.jsx)(s.$,{variant:l?"ghost":"plain",size:"xs",onClick:n,"aria-label":r||(l?"Go back":"Cancel"),rightIcon:(0,i.jsx)(c.g,{icon:l?d.U23:d.XOT,fixedWidth:!0}),...o,children:l?(0,i.jsx)(b.x6,{id:"CKyk7Q"}):(0,i.jsx)(b.x6,{id:"dEgA5A"})})};var tK=n(91792),tY=n(65950),tX=n(83049),tJ=n(11818);let t$=h.memo(e=>{let{initialContent:t,isSelected:n,showSelectedBorder:r,interactionId:o,cardIds:l,themeId:a,children:s,...d}=e,c=T(),[u,p]=(0,h.useState)(!1),m=(0,A.GV)((0,_.c8)(a));return((0,tK.rd)(),(0,tJ.NC)(m),(0,h.useEffect)(()=>{requestAnimationFrame(()=>{p(!0)})},[]),u)?(0,i.jsx)(tX.q,{initialContent:t,theme:m,onCreate:e=>{e.gammaOrgId=(0,M.gx)(),e.gammaDocId=c.editor.gammaDocId,requestAnimationFrame(()=>{(0,U.Sg)({editor:e,content:t,theme:m,interactionId:o})})},children:(0,i.jsxs)(x.B,{justify:"start",align:"start",spacing:1,pos:"relative",...d,children:[l.map(e=>(0,i.jsx)(tc.a,{borderRadius:"md",border:"1px solid",borderColor:"gray.200",overflow:"hidden",...r&&{cursor:"pointer"},...n&&r&&{borderColor:"trueblue.500",border:"2px solid"},...!n&&r&&{borderColor:"gray.200",border:"2px solid"},children:(0,i.jsx)(tY.N,{cardId:e},e)},e)),s]})}):null});t$.displayName="DocEditorPreview";let tZ=(0,h.memo)(e=>{let{variation:t}=e,n=T(),r=(0,A.GV)((0,P.B3)(t)),{themeId:o,jsonContent:l}=(0,A.GV)((0,P.BV)(t.toApplyCheckpointId)),a=[t.previewCardIds[0]],s=(0,h.useCallback)(()=>{r||Z.applyResultVariation(n,t),Z.focusResultVariation(n,t)},[n,r,t]);return(0,i.jsx)(g.s,{overflow:"hidden",role:"group",transitionProperty:"height border",transitionDuration:"0.2s",flexDirection:"column",justifyContent:"start",position:"relative",align:"center",maxH:"200px",css:{"--editor-width":"176px","--line-thickness":"1px"},children:(0,i.jsxs)(t$,{initialContent:l,themeId:o,cardIds:a,showSelectedBorder:!0,isSelected:r,onClick:s,interactionId:t.messageId,children:[(0,i.jsx)(e7.E,{colorScheme:"sky",variant:"subtle",position:"absolute",bottom:1,insetEnd:1,zIndex:1,children:t.name}),r&&(0,i.jsx)(e7.E,{colorScheme:"deepocean",bg:"deepocean.500",variant:"solid",position:"absolute",top:0,borderTopRadius:"none",color:"white",left:"50%",transform:"translateX(-50%)",zIndex:2,fontSize:"xs",opacity:0,_groupHover:{opacity:1},transition:"opacity 0.2s",children:(0,i.jsx)(b.x6,{id:"9krCfL"})})]})})});tZ.displayName="MessageResultCardVariation";let tQ=(0,h.memo)(e=>{let{variation:t}=e,n=T(),r=(0,A.GV)((0,P.B3)(t)),{themeId:o,jsonContent:l}=(0,A.GV)((0,P.BV)(t.toApplyCheckpointId)),a=t.previewCardIds,s=(0,eQ.dU)("gray.50","gray.700"),d=(0,eQ.dU)("trueblue.500","trueblue.400"),c=(0,eQ.dU)("trueblue.600","trueblue.400"),u=(0,eQ.dU)("trueblue.300","trueblue.500"),p=(0,h.useCallback)(()=>{if(!r)return void Z.applyResultVariation(n,t);Z.focusResultVariation(n,t)},[n,r,t]);return(0,i.jsxs)(g.s,{borderRadius:"md",bg:s,border:"2px solid",borderColor:r?d:"transparent",outline:r?"1px solid var(--chakra-colors-trueblue-500)":"none",_hover:{borderColor:r?c:u},p:1,overflow:"hidden",role:"group",transitionProperty:"height border",transitionDuration:"0.2s",flexDirection:"column",justifyContent:"start",onClick:p,cursor:"pointer",position:"relative",align:"center",maxH:"300px",css:{"--editor-width":"166px","--line-thickness":"1px"},children:[(0,i.jsx)(t$,{initialContent:l,themeId:o,cardIds:a,showSelectedBorder:!1,interactionId:t.messageId}),(0,i.jsx)(e7.E,{colorScheme:"sky",variant:"subtle",position:"absolute",bottom:1,insetEnd:1,zIndex:1,children:t.name}),r&&(0,i.jsx)(e7.E,{colorScheme:"deepocean",bg:"deepocean.500",variant:"solid",position:"absolute",top:0,borderTopRadius:"none",color:"white",insetStart:"50%",transform:"translateX(-50%)",zIndex:2,fontSize:"xs",opacity:0,_groupHover:{opacity:1},transition:"opacity 0.2s",children:(0,i.jsx)(b.x6,{id:"0MgdN+"})})]})});tQ.displayName="MessageResultDeckVariation";let t0=e=>{let{title:t,children:n}=e,r=(0,eQ.dU)("titanium.900","deepocean.300"),o=(0,eQ.dU)("gray.100","gray.700"),l=(0,eQ.dU)("deepocean.800","deepocean.300");return(0,i.jsx)(x.B,{p:2,border:"1px solid",borderColor:o,align:"space-between",w:"100%",borderRadius:"md",children:(0,i.jsxs)(a.z,{justify:"space-between",w:"100%",children:[(0,i.jsxs)(a.z,{children:[(0,i.jsx)(tc.a,{color:l,children:(0,i.jsx)(c.g,{icon:tu.QRE,fixedWidth:!0,size:"sm"})}),(0,i.jsx)(v.E,{fontSize:"sm",fontWeight:"semibold",color:r,children:t})]}),n]})})},t1=e=>{let{result:t,showCancelButton:n,cancelRollback:r,onGoBack:o,state:l,ratings:s}=e,u=(0,eQ.dU)("deepocean.800","deepocean.300");return"done"===l?(0,i.jsx)(t0,{title:t.title,children:(0,i.jsx)(tq,{variant:"go-back",onClick:o})}):(0,i.jsxs)(x.B,{align:"space-between",w:"100%",children:[(0,i.jsxs)(a.z,{justify:"space-between",w:"100%",py:2,pb:0,border:"1px solid",borderColor:"transparent",children:[(0,i.jsxs)(a.z,{spacing:1,children:[(0,i.jsx)(tc.a,{color:u,children:(0,i.jsx)(c.g,{icon:d.B4x,fixedWidth:!0,size:"sm"})}),(0,i.jsx)(v.E,{fontSize:"sm",fontWeight:"semibold",children:(0,i.jsx)(b.x6,{id:"kNTUcC"})})]}),n&&(0,i.jsx)(tq,{variant:"cancel",onClick:r})]}),(0,i.jsxs)(x.B,{spacing:4,children:[(0,i.jsx)(tH.r,{columns:2,spacing:1,children:t.variations.map((e,t)=>"doc"===e.previewType?(0,i.jsx)(tQ,{variation:e},t):(0,i.jsx)(tZ,{variation:e},t))}),(0,i.jsxs)(a.z,{justify:"space-between",w:"100%",children:[(0,i.jsx)(v.E,{fontSize:"xs",children:(0,i.jsx)(b.x6,{id:"5gB/9E"})}),(0,i.jsx)(tc.a,{children:s})]})]})]})};var t6=n(56570),t2=n(79536);let t5=e=>{let{result:t,state:n,ratings:r}=e,{isOpen:o,onOpen:l,onClose:u}=(0,tE.j)(),p="current"===n||o,m=(0,A.GV)(_.ST),g=(0,A.GV)(R.SJ),f=(0,E.d)(),y=(0,eQ.dU)("deepocean.800","deepocean.300"),j=(0,h.useCallback)(e=>{f(e)},[f]);return p?(0,i.jsxs)(x.B,{align:"space-between",w:"100%",children:[(0,i.jsxs)(a.z,{justify:"space-between",w:"100%",px:0,pb:0,border:"1px solid",borderColor:"transparent",children:[(0,i.jsxs)(a.z,{children:[(0,i.jsx)(tc.a,{color:y,children:(0,i.jsx)(c.g,{icon:d.B4x,fixedWidth:!0,size:"sm"})}),(0,i.jsx)(v.E,{fontSize:"sm",fontWeight:"semibold",children:(0,i.jsx)(b.x6,{id:"9KqPc+"})})]}),o&&(0,i.jsx)(s.$,{variant:"ghost",size:"xs",onClick:u,"aria-label":"close",rightIcon:(0,i.jsx)(c.g,{icon:d.bnw,fixedWidth:!0}),children:(0,i.jsx)(b.x6,{id:"yz7wBu"})})]}),(0,i.jsx)(x.B,{spacing:4,children:(0,i.jsx)(t6.x,{templateColumns:{base:"repeat(2, 1fr)",md:"repeat(2, 1fr)"},gap:3,children:t.themes.map(e=>{let{themeId:t,wasOriginal:n}=e,r=m.find(e=>e.id===t);return r?(0,i.jsxs)(tc.a,{position:"relative",children:[(0,i.jsx)(t2.e,{theme:r,isChecked:(null==g?void 0:g.id)===t,onThemeClicked:j,variant:"ghost-bordered",disableEditing:!0,previewHeightEm:6,compact:!0},t),n&&(0,i.jsx)(e7.E,{colorScheme:"sky",variant:"subtle",position:"absolute",bottom:1,insetEnd:1,zIndex:1,children:(0,i.jsx)(b.x6,{id:"HxF6Fk"})})]},t):null})})}),(0,i.jsx)(tc.a,{display:"flex",justifyContent:"flex-end",children:r})]}):(0,i.jsx)(t0,{title:t.title,children:(0,i.jsx)(s.$,{variant:"ghost",size:"xs",onClick:l,"aria-label":"Open",rightIcon:(0,i.jsx)(c.g,{icon:d.fyG,fixedWidth:!0}),children:(0,i.jsx)(b.x6,{id:"1TNIig"})})})},t4=e=>{let{message:t,lastUserMessage:n,result:r,state:o,cancelRollback:l,onGoBack:a,chatId:s}=e,d="rolling-back"===o,c=(0,i.jsx)(t3,{chatId:s,result:r,message:t,lastUserMessage:n});return"suggest-themes"===r.type?(0,i.jsx)(t5,{result:r,state:o,ratings:c}):"suggest-images"===r.type?(0,i.jsx)("div",{children:"NOT IMPLEMENTED"}):"applied-changes"===r.type?(0,i.jsx)(t1,{result:r,cancelRollback:l,showCancelButton:d,state:o,onGoBack:a,ratings:c}):null},t8=[{key:"instructions",label:(0,i.jsx)(b.x6,{id:"Tq32Jp"})},{key:"incorrect-information",label:(0,i.jsx)(b.x6,{id:"UZQ7Jv"})},{key:"too-many-changes",label:(0,i.jsx)(b.x6,{id:"YI0lXP"})},{key:"formatting",label:(0,i.jsx)(b.x6,{id:"TO8fPE"})}],t3=h.memo(e=>{var t;let{result:n,message:r,lastUserMessage:o,chatId:l}=e,[a,s]=(0,h.useState)(null),d=null==(t=r.parts)?void 0:t.filter(e=>"tool-invocation"===e.type).map(e=>e.toolInvocation),c=null==d?void 0:d.map(e=>e.toolName).reduce((e,t)=>{var n;return e[t]=(null!=(n=e[t])?n:0)+1,e.all+=1,e},{all:0}),u=(0,h.useCallback)(e=>{s(e),(0,tV.yC)({chatId:l,toolInvocations:d,toolCount:c,rating:e,interactionId:n.messageId,messageId:n.messageId,userMessage:null==o?void 0:o.content,agentType:"Buddy"})},[l,d,c,n.messageId,null==o?void 0:o.content]),p=(0,h.useCallback)((e,t,i)=>{(0,tV.Y2)({chatId:l,toolInvocations:d,toolCount:c,rating:e,interactionId:n.messageId,messageId:n.messageId,feedback:t,userMessage:null==o?void 0:o.content,tags:i,agentType:"Buddy"})},[l,d,c,n.messageId,null==o?void 0:o.content]);return(0,i.jsx)(tG.f3,{setRating:u,RatingButtons:tG.Ep,size:"xs",rating:null!=a?a:void 0,trackFeedback:p,feedbackTags:t8})});t3.displayName="MessageResultRatings";let t9=e=>e.reduce((t,n,r)=>r===e.length-1?[...t,n]:[...t,n,(0,i.jsx)("br",{},"br-".concat(r))],[]),t7=e=>{let{content:t}=e,n=t9(t.trim().split("\n"));return(0,i.jsx)(g.s,{whiteSpace:"pre-wrap",textOverflow:"ellipsis",overflow:"hidden",direction:"column",maxW:"100%",children:(0,i.jsx)(v.E,{children:n})})},ne=e=>{var t;let{message:n,chatId:r,messageIndex:o,goBackToMessage:a,isLast:s,lastUserMessage:d,...c}=e,u=(0,A.GV)(P.RR),p=(0,A.GV)((0,P.fN)(n.id)),m="done";u===o?m="rolling-back":s&&(m="current");let g=ew(),x=(0,h.useCallback)(()=>{a(n)},[a,n]);return(0,i.jsxs)(l.T,{...tA.i,p:0,alignSelf:"flex-start",width:"100%",position:"relative",align:"start",...c,children:[null==(t=n.parts)?void 0:t.map((e,t)=>{if("text"===e.type)return"USER_ABORTED"===e.text?(0,i.jsx)(v.E,{fontSize:"xs",fontWeight:"semibold",children:(0,i.jsx)(b.x6,{id:"7175a1"})},t):(0,i.jsx)(t7,{content:e.text},t);if("tool-invocation"===e.type){let t=e.toolInvocation;return(0,i.jsx)(tW,{invocation:t},"".concat(t.toolCallId,"-result"))}return null}),p&&(0,i.jsx)(t4,{chatId:r,message:n,lastUserMessage:d,result:p,state:m,onGoBack:x,cancelRollback:g})]})},nt=e=>{let t,{message:n}=e,r=n.content.replace("the current deck is ","");try{t=JSON.parse(r)}catch(e){t=null}return(0,i.jsxs)(x.B,{children:[(0,i.jsx)(tL,{buttonText:"Current Deck",debugTitle:"Current Deck",debugObject:t||{error:"Failed to parse current deck JSON",rawContent:r}}),t&&"selection"in t&&(0,i.jsxs)(x.B,{fontSize:"xs",wordBreak:"break-all",overflowY:"auto",width:"250px",children:[(0,i.jsx)(v.E,{fontSize:"xs",fontWeight:"bold",children:"Selection"}),Object.entries(t.selection||{}).map((e,t)=>{let[n,r]=e;return(0,i.jsxs)(tc.a,{children:[(0,i.jsx)("b",{children:n}),(0,i.jsx)("br",{}),r]},t)})]})]})},nn=e=>{let{url:t,name:n}=e,{isZoomed:r,enterZoom:o,exitZoom:l}=(0,ty.RL)(t),a=(0,h.useCallback)(()=>{o()},[o]);return(0,i.jsxs)(tc.a,{position:"relative",children:[(0,i.jsx)(tv.Me,{src:t,alt:n,boxSize:"64px",objectFit:"cover",borderRadius:"md",border:"1px solid",borderColor:"gray.200",cursor:"zoom-in",onClick:a,resizeParams:tv.p7}),(0,i.jsx)(ty.Gx,{isZoomed:r,exitZoom:l,editor:{isThumbnail:!1,isEditable:!1},children:(0,i.jsx)(g.s,{justify:"center",align:"center",h:"100%",w:"100%",children:(0,i.jsx)(tv.Me,{src:t,alt:n,maxW:"90vw",maxH:"90vh",objectFit:"contain"})})})]})},ni=e=>{var t,n;let{message:r,...o}=e,s=(0,eo.u)("buddyDebug"),d=(0,eQ.dU)("periwinkle.100","periwinkle.900"),c=(0,eQ.dU)("titanium.900","white");if("current-deck"===r.id)return s?(0,i.jsx)(l.T,{...tA.i,...o,bg:d,color:c,maxW:"90%",alignSelf:"flex-end",borderBottomEndRadius:"0",align:"start",children:(0,i.jsx)(nt,{message:r})}):null;let u=null!=(n=null==(t=r.experimental_attachments)?void 0:t.filter(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("image")}))?n:[];return(0,i.jsxs)(x.B,{children:[(null==u?void 0:u.length)>0&&(0,i.jsx)(a.z,{flexDirection:"row-reverse",w:"100%",children:u.map(e=>(0,i.jsx)(nn,{url:e.url,name:e.name},e.url))}),(0,i.jsx)(l.T,{...tA.i,...o,bg:d,color:c,maxW:"90%",alignSelf:"flex-end",borderBottomEndRadius:"0",align:"start",children:(0,i.jsx)(v.E,{children:r.content})})]})},nr=(0,h.memo)(e=>{let{height:t}=e;return(0,i.jsx)(tc.a,{height:t,width:"100%"})});nr.displayName="Spacer";let no=e=>{let{chatId:t,messages:n,goBackToMessage:r,isReceivingMessages:o}=e,a=(0,A.GV)(P.RR),{scrollToRef:s,scrollContainerRef:d}=tk({isReceivingMessages:o,messagesLength:n.length});return(0,i.jsxs)(l.T,{ref:d,fontSize:"14px",spacing:4,px:0,width:"100%",alignItems:"stretch",flex:1,p:4,overflowY:"auto",children:[n.map((e,o)=>{if(null!=a&&a<o)return null;if("assistant"===e.role){let l;return o>0&&"user"===n[o-1].role&&(l=n[o-1]),(0,i.jsx)(ne,{chatId:t,message:e,messageIndex:o,goBackToMessage:r,isLast:o===n.length-1,lastUserMessage:l},e.id)}return"user"===e.role?(0,i.jsx)(ni,{message:e},e.id):null}),(0,i.jsx)(nr,{height:"20px"}),(0,i.jsx)("div",{ref:s})]})};var nl=n(68917),na=n(78140),ns=n(36999),nd=n(41283),nc=n(85595);let nu=e=>{let{testCases:t,onSelectTestCase:n,isRunning:r,...o}=e;return(0,i.jsxs)(na.W,{children:[(0,i.jsx)(ns.I,{as:s.$,rightIcon:(0,i.jsx)(nl.D,{}),size:"sm",...o,children:"Test Cases"}),(0,i.jsx)(nd.c,{children:t.map((e,t)=>(0,i.jsx)(nc.D,{isDisabled:r,onClick:()=>n(e),children:(0,i.jsx)(v.E,{fontSize:"sm",children:e.description})},t))})]})},np=(0,h.memo)(e=>{var t;let{...n}=e,g=(0,A.CU)(),x=(0,A.jL)(),f=(0,A.GV)(P.eb),y=(0,A.GV)(R.sX),v=(0,o.d)(),b=(0,h.useRef)((0,I.O)()),j=(0,h.useRef)(null);(0,z.t)();let w=(0,A.GV)(P.ZT),{initialMessages:k,messagesRef:D}=eO({enabled:!1}),O=T(),L=(0,h.useRef)(),N=(0,h.useRef)(null),B=(0,h.useRef)(""),U=(0,E.d)(),F=(0,h.useCallback)(e=>{let t=(0,_.ST)(g.getState()).find(t=>t.id===e);t&&U(t)},[U,g]);ez(f);let{messages:W,setInput:G,isLoading:V,setMessages:H,reload:q,status:K,stop:Y}=(0,r.Y_)({id:"buddy",initialMessages:k,api:"".concat(m.$.API_HOST,"/ai/agent/message?agentName=Buddy"),credentials:"include",streamProtocol:"data",maxSteps:25,body:{messageId:b.current,workspaceId:(0,M.gx)(),context:{type:"doc",docId:y}},onError:e=>{v({title:"Chat error",description:e.message,position:"top",status:"error",duration:3e3})},onFinish:async(e,t)=>{let{finishReason:n}=t;b.current=(0,I.O)(),await new Promise(e=>setTimeout(e,0)),console.log("[buddy] onFinish",{message:e,finishReason:n,status:K,statusRef:B.current}),("tool-calls"!==n||"ready"===B.current)&&(eW(g,f,e,N.current),$(),N.current=null)},onToolCall:async e=>{let{toolCall:t}=e;j.current=new AbortController,console.log("[buddy] onToolCall",{messageId:L.current,toolCall:t,status:K,statusRef:B.current});try{let e=g.getState(),n=(0,P.eb)(e),i=(0,R.SJ)(e);if(!n)throw Error("Cannot perform tool call without an editor");let r=!1;N.current||(r=!0,N.current=ej(n,i.id));let o=L.current,l={editor:n,store:g,imageOptions:O.imageOptions,theme:i,abortController:j.current,applyTheme:F},a=ev[t.toolName];if(!a)throw Error("Invalid tool ".concat(t.toolName));let s=await a.execute(t.args,l,t,o);if(s.messageId=o,j.current=null,r)return{...s,beforeCheckpointId:N.current.id};return s}catch(e){var n,i;if(j.current=null,(null==(n=e.message)?void 0:n.includes("Request was cancelled"))||(null==(i=e.message)?void 0:i.includes("aborted"))||"AbortError"===e.name)throw e;return console.log(e.stack),{status:"error",error:e.message,messageId:L.current}}}});L.current=null==(t=W[W.length-1])?void 0:t.id,B.current=K;let{startTestCase:X,isRunning:J,markFinish:$}=eZ({reload:q,setMessages:H,isLoading:V}),Q=function(){let e=(0,eK.wA)(),t=T();return(0,h.useCallback)(n=>{if(!t)throw Error("Buddy editor context not available");for(let[t,i]of Object.entries(n)){let t=function(e){let t=eY[e.type];if(!t)throw Error("Unknown suggestion type: ".concat(e.type));try{return t(e.input)}catch(t){return console.error("[loadBuddySuggestion] Error loading suggestion ".concat(e.type),t),null}}(i);t&&e((0,P.Ed)(t))}},[e,t])}(),ee=(0,h.useCallback)(()=>{let e=g.getState(),t={};return Object.entries(e.Buddy.suggestions).forEach(e=>{let[n,i]=e;t[n]=i.serialize()}),{messages:W,suggestions:t,checkpoints:e.Buddy.checkpoints,chosenResultVariations:e.Buddy.chosenResultVariations,results:e.Buddy.results}},[W,g]);(0,h.useCallback)(e=>{H(e.messages),Q(e.suggestions),Object.values(e.checkpoints).forEach(e=>{x((0,P.AY)(e))}),Object.entries(e.chosenResultVariations||{}).forEach(e=>{let[t,n]=e;x((0,P.rD)({messageId:t,variationId:n}))}),Object.values(e.results||{}).forEach(e=>{x((0,P.Jw)(e))})},[H,Q,x]),(0,h.useEffect)(()=>{},[]),window.buddyDebug=()=>{let e=g.getState(),t=ee(),n=e.ThemePicker;return{messages:W,reducer:e.Buddy,serialized:t,themes:n}},D.current=W;let et=(0,h.useCallback)(e=>{x((0,P.ZQ)({isUnloading:e})),H([])},[x,H]),en=eC(W),ei=(0,h.useCallback)((e,t,n)=>{if(!f)return;let i=(0,P.KF)(g.getState()),r=(0,R.SJ)(g.getState()),o=Z.getDeckInfo({editor:f,store:g,imageOptions:O.imageOptions,theme:r},n);H(n=>{i&&(n=n.slice(0,i.messageIndex+1),x((0,P._i)()));let r=n.filter(e=>"current-deck"!==e.id),l="the current deck is ".concat(JSON.stringify(o)),a={id:(0,p.Ak)(),role:"user",content:e,experimental_attachments:t.map(e=>({url:e.src,contentType:e.mimeType,name:e.name}))};return G(""),[...r,{id:"current-deck",role:"user",content:l,parts:[{type:"text",text:l}]},a]}),q()},[x,f,q,G,H,g,O]);(0,h.useEffect)(()=>{w&&("ready"===B.current?ei(w.message,[],w.context):v({title:u.Ru._({id:"cii4bX"}),description:u.Ru._({id:"wqxsb/"}),position:"top",status:"warning",duration:5e3}),x((0,P.z8)()))},[x,ei,w,G,v]);let er=(0,h.useCallback)(()=>{var e;Y(),null==(e=j.current)||e.abort();let t=W[W.length-1];H(S.Uv),console.log("handle stop DONE",{lastMessage:t,beforeCheckpointRef:N.current,status:K,aiSdkMessageIdRef:L.current,statusRef:B.current}),eW(g,f,t,N.current),N.current=null},[Y,W,H,K,g,f]);return(0,h.useEffect)(()=>{if(!f)return;let e=()=>{et(!0)};return f.on("destroy",e),()=>{f.off("destroy",e)}},[f,et]),(0,i.jsxs)(l.T,{...n,justifyContent:"space-between",align:"stretch",position:"relative",height:"100%",spacing:0,children:[(0,i.jsxs)(a.z,{display:"none",children:[(0,i.jsx)(s.$,{position:"absolute",size:"sm",boxShadow:"base",leftIcon:(0,i.jsx)(c.g,{icon:d.V3T,fixedWidth:!0}),borderRadius:"full",variant:"plain",isDisabled:V,onClick:()=>et(!1),"aria-label":"",top:2,insetStart:4,zIndex:1,children:"reset"}),(0,i.jsx)(nu,{testCases:e$,onSelectTestCase:e=>{X(f,e)},isRunning:J,position:"absolute",top:2,insetEnd:4,zIndex:1})]}),!W.length&&(0,i.jsx)(C,{}),W.length>0&&(0,i.jsx)(no,{chatId:null!=y?y:"",messages:W,goBackToMessage:en,isReceivingMessages:V}),(0,i.jsx)(tS,{status:K,messages:W,handleNewChat:()=>et(!1),manualSubmit:ei,handleStop:er,editor:f})]})});np.displayName="Toolbar"},24037:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});let i=new(n(63867)).hs("gammaBubbleMenu")},27196:(e,t,n)=>{"use strict";n.d(t,{Li:()=>i.Li,Rf:()=>r.R,kY:()=>r.k});var i=n(60300),r=n(69764)},27250:(e,t,n)=>{"use strict";n.d(t,{q:()=>k});var i=n(6029),r=n(26420),o=n(74676),l=n(8099),a=n(40452),s=n(33787),d=n(48810),c=n(21938),u=n(19564),p=n(55729),h=n(74892),m=n(68301),g=n(90221),x=n(62452),f=n(61385),y=n(62171),v=n(82927),b=n(80812),j=n(60908),w=n(55670),C=n(95571),I=n(40077),S=n(95714);let k=(0,p.memo)(e=>{let{theme:t,variant:n="outline",children:p,heightEm:k=8,...E}=e,{contentStyles:_}=t.config,R=(0,y.fS)(t),P=(0,x.Mw)(t),T=(0,S.ZI)(t);"string"==typeof T["--card-border-radius"]&&(T["--card-border-radius"]=function(e){let t=parseFloat(e);return e.endsWith("em")&&t>1?"".concat(1,"em"):e}(T["--card-border-radius"]));let z=(0,w.S)(t,!1),M=(0,y.FD)(R,P,j.p7),{currentWorkspace:D}=(0,v.ur)(),O=(0,b.fL)(null==D?void 0:D.id),L=A(t),N=t.id===(null==O?void 0:O.defaultThemeId),B=(0,m.u)("themeTextPreviewSVGs")&&t.previewUrl,U={fontSize:"0.8em",padding:"0.2em 0.4em",borderRadius:"0.3em",insetStart:2,top:2,zIndex:1};return(0,i.jsxs)(r.a,{css:T,sx:z,w:"100%",pos:"relative",children:[L&&!N&&null===t.workspaceId&&(0,i.jsx)(o.E,{position:"absolute",colorScheme:"green",...U,children:(0,i.jsx)(u.x6,{id:"isRobC"})}),N&&(0,i.jsx)(l.m,{openDelay:300,label:(0,i.jsx)(u.x6,{id:"dWkBMI"}),placement:"top",cursor:"help",children:(0,i.jsx)(o.E,{position:"absolute",colorScheme:"gray",cursor:"help",...U,children:(0,i.jsx)(u.x6,{id:"ovBPCi"})})}),(0,i.jsxs)(a.s,{borderTopRadius:"ghost"===n?"none":"md",boxShadow:"sm",_focus:{boxShadow:"outline"},p:"".concat(k/8,"em"),transitionProperty:"common",transitionDuration:"normal",...M,backgroundAttachment:"initial",direction:"row",align:"center",overflow:"hidden",minH:"".concat(k,"em"),maxH:"".concat(k,"em"),...E,children:[!B&&(0,i.jsx)(g.m,{theme:t}),(0,i.jsx)(r.a,{sx:{...C.CO,..._},borderRadius:"base",className:"".concat(f._P," ").concat(P?"is-dark":""),color:P?"white":"gray.800",flex:1,pointerEvents:"none",dir:"ltr",children:(0,i.jsx)(r.a,{gridArea:'"body"',py:"".concat(k/8,"em"),px:"".concat(k/8,"em"),position:"relative",minH:"".concat(3*k/4,"em"),children:B?(0,i.jsx)(s._,{src:t.previewUrl,position:"absolute",width:"".concat(7.75/8*k,"em"),objectFit:"contain",inset:"".concat(k/8,"em"),fallback:(0,i.jsx)(r.a,{pos:"absolute",inset:"-".concat(k/8,"em"),bg:"gray.300",backgroundImage:h.A.src,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d.E,{className:"block-title",mt:"0 !important",mb:"var(--chakra-space-1) !important",children:(0,i.jsx)(d.E,{as:"span",className:(0,c.cx)("title",I.U6),fontSize:"1.6em !important",paddingBottom:"0 !important",children:(0,i.jsx)(u.x6,{id:"MHrjPM"})})}),(0,i.jsx)(d.E,{fontSize:"0.9em !important",noOfLines:3,className:"block block-paragraph",my:"0 !important",children:(0,i.jsx)(u.x6,{id:"U41VTK",components:{0:(0,i.jsx)(d.E,{as:"a",className:"link"})}})})]})})})]}),p]})});k.displayName="ThemePreviewThumbnail";let A=e=>{if(!e.createdTime)return!1;let t=new Date(e.createdTime),n=new Date;return n.setDate(n.getDate()-30),t>n}},30188:(e,t,n)=>{"use strict";n.d(t,{b:()=>a,o:()=>s});var i=n(22905),r=n(63867),o=n(81404);let l=new r.hs("yDocSize"),a=e=>{let t=l.getState(e.state);return t?t.getYDocSize():null},s=i.YY.create({name:"yDocSize",addProseMirrorPlugins(){let{document:e}=this.options;return[new r.k_({key:l,state:{init:()=>new d(e),apply:(e,t)=>t}})]}});class d{getYDocSize(){return o.PR(this.ydoc).byteLength}constructor(e){this.ydoc=e}}},30645:(e,t,n)=>{"use strict";n.d(t,{K:()=>c});var i=n(6029),r=n(26385),o=n(33787),l=n(23293),a=n(48810),s=n(77650),d=n(5455);let c=e=>{let{title:t,message:n,children:c,stackProps:u}=e;return(0,i.jsxs)(r.B,{spacing:4,alignItems:"center",textAlign:"center",...u,children:[(0,i.jsx)(o._,{src:d.A.src,w:{base:40,sm:60},alt:s.Ru._({id:"bHdr/A"})}),(0,i.jsx)(l.D,{size:"lg",css:{textWrap:"balance"},children:t}),n&&(0,i.jsx)(a.E,{css:{textWrap:"balance"},children:n}),c]})}},32263:(e,t,n)=>{"use strict";n.d(t,{H2:()=>il,bw:()=>Y.b,u5:()=>ip.u,k5:()=>ic,HC:()=>id,f$:()=>iu});var i=n(97255);i.Lz.prototype.updateState=function(e){this.docView&&this.updateStateInner(e,this.state.plugins!=e.plugins)};var r=n(6029),o=n(26420),l=n(53996),a=n(26385),s=n(3276),d=n(48810),c=n(40510),u=n(90865),p=n(39891),h=n(55729),m=n(57067),g=n(81404),x=n(91938),f=n(35292),y=n(82328),v=n(40452),b=n(58959),j=n(57405),w=n(77364),C=n(91106),I=n(19564),S=n(22905),k=n(23636),A=n(32617),E=n(3247),_=n(33633),R=n(647),P=n(95563),T=n(15342),z=n(91792),M=n(17928),D=n(43634),O=n(85235),L=n(47956);let N=e=>{let{closePanel:t}=e,n=(0,z.rd)();return(0,r.jsx)(C.L8,{isDark:n,children:(0,r.jsx)(R.Z,{bgColor:n?"gray.800":"white",w:"100%",color:n?"white":"titanium.900",children:(0,r.jsxs)(v.s,{direction:"column",w:"100%",h:"100%",children:[(0,r.jsxs)(b.z,{position:"relative",py:2,px:4,children:[(0,r.jsx)(v.s,{flex:1,children:(0,r.jsx)(j.T,{align:"start",spacing:0,children:(0,r.jsx)(P.N,{children:(0,r.jsx)(I.x6,{id:"mw/rmM"})})})}),(0,r.jsx)(w.J,{onClick:t})]}),(0,r.jsx)(v.s,{direction:"column",h:"100%",overflowY:"auto",overflowX:"hidden",className:"".concat("design-partner-panel-wrapper"," buddy-scroll"),w:"100%",children:(0,r.jsx)(k.BuddyChatPane,{})})]})})})};N.panelPosition="right",N.panelName="buddy-chat",N.canCollapse=!1,N.minWidth=400,N.alwaysDocked=!0;let B=()=>{let e=(0,T.jL)(),t=(0,T.GV)(D.wC),n=(0,T.GV)(D.Ik),i=t!==O.w.SLIDE_VIEW&&n,{togglePanel:r,isPanelOpen:o}=(0,_.ww)(N,i);return(0,h.useEffect)(()=>M.LF.on("queueBuddyEditMessage",t=>{e((0,L.R)(t)),r({disableTransition:!0,override:"open"})}),[e,r]),{toggleBuddyChatPanel:r,isBuddyChatPanelOpen:o}},U=()=>{let e=(0,A.u)("buddyEdit"),{toggleBuddyChatPanel:t}=B();(0,h.useEffect)(()=>{if(e)return E.WC.on("keydown","buddy-chat",e=>(!!(0,S.U0)()&&!!e.metaKey||!!e.ctrlKey)&&"e"===e.key&&(e.preventDefault(),t({disableTransition:!0}),!0))},[t,e])};var F=n(65280),W=n(68301),G=n(5291),V=n(59190),H=n(30188),q=n(82927),K=n(85057),Y=n(10817),X=n(63867),J=n(53907),$=n(91242),Z=n(47665);let Q=()=>{let e=document.createElement("span");e.classList.add("collaboration-cursor__caret","streaming-cursor"),e.setAttribute("style","border-color: var(--chakra-colors-trueblue-100)");let t=document.createElement("div");return t.classList.add("collaboration-cursor__label","streaming-cursor__label"),t.setAttribute("style","background-color: var(--chakra-colors-trueblue-100); color: var(--chakra-colors-trueblue-400)"),e.insertBefore(t,null),e},ee=S.YY.create({name:"aiGeneration",addOptions:()=>({provider:null}),addStorage:()=>({generationEnabled:!1}),onCreate(){let{provider:e}=this.options;e&&e.awareness&&e.awareness.on("change",()=>{if(!e.awareness)return;let t=!1;for(let[n,i]of e.awareness.getStates())i.isStreaming&&n!==e.awareness.clientID&&(t=!0);let n=(0,T.KA)();(0,J.kg)(n.getState())!==t&&n.dispatch((0,J.gR)(t))})},addCommands(){return{setAIGenerationRunning:e=>()=>{var t,n;return this.storage.generationEnabled=e,null==(n=this.options.provider)||null==(t=n.awareness)||t.setLocalStateField("isStreaming",e),!0}}},addProseMirrorPlugins(){let{storage:e}=this;return[new X.k_({key:new X.hs("aiGeneration"),props:{decorations(t){if(!e.generationEnabled)return i.zF.empty;let n=[],r=t.doc.content.size-2,o=(0,S.eL)(t.doc.resolve(r),Z.jg),l=o?(0,$.s)(t.doc.resolve(o.pos),-1):null;return l&&o&&(n.push(i.NZ.widget(l.from,Q,{key:"sal",side:10})),n.push(i.NZ.node(o.pos,o.pos+o.node.nodeSize,{class:"ai-generate-streaming-card"}))),i.zF.create(t.doc,n)}}})]}});var et=n(15440);let en=()=>new X.k_({key:et.G,state:{init:()=>new et.Z,apply:(e,t,n,i)=>t.apply(e,i)}}),ei=S.YY.create({name:"aiModifications",onCreate(){this.options.document.on("afterAllTransactions",e=>{let t=et.G.getState(this.editor.view.state);t&&t.flushMoveInstructionQueue(this.editor.view.state)})},addProseMirrorPlugins:()=>[en()],addCommands:()=>({setInteractionRange:(e,t)=>n=>{let{tr:i}=n;return i.setMeta("aiModificationAction",{type:"setInteractionRange",rangeId:e,range:t}),!0}})});var er=n(6956),eo=n(67733),el=n(40240),ea=n(41427),es=n(46609),ed=n(77711);let ec=e=>e.pos+e.node.nodeSize-1;class eu{initialize(e){let{buttonElement:t,tippyTarget:n,onHide:i}=e;if(this.isFlagEnabled){if(!t||!n)return void console.warn("[AutocompleteButtonView] initialize. No element provided");this.element=t,this.target=n,this.onHide=i,this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.createTooltip(),this.element.style.visibility="visible"}}createTooltip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!this.isFlagEnabled)return;let n=t||this.view.dom.parentElement;n&&this.element&&(this.tippy=(0,eo.Ay)(n,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",offset:[0,8],...e}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){if(!this.isFlagEnabled)return;let{state:n,composing:i}=e,{doc:r,selection:o}=n,l=t&&ed.f.getState(t),a=ed.f.getState(e.state),s=t&&t.doc.eq(r)&&t.selection.eq(o)&&this.isEditable===this.editor.isEditable&&(null==l?void 0:l.forceHide)===a.forceHide;if(!this.element||!this.target){if(!a.buttonElement||!a.tippyTarget)return;this.initialize(a)}let d=!(null==t?void 0:t.selection.eq(o)),c=!(null==t?void 0:t.doc.eq(r));if(this.isEditable=this.editor.isEditable,!this.editor.isEditable||!0===a.forceHide)return void this.hide();if(!i&&!s)if(d&&!c){if(!this.shouldShow({view:e,state:n}))return void this.hide();this.show()}else c&&(this.hide(),this.typingTimeout&&clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout(()=>{this.editor&&this.view.hasFocus()&&this.shouldShow({view:e,state:this.editor.state})&&this.show()},750))}show(){var e,t;if(!this.isFlagEnabled||!this.validParentNode||(this.nodeEndPos=ec(this.validParentNode),!this.nodeEndPos))return;let n=(0,ea.KQ)(this.validParentNode.node);null==(e=this.tippy)||e.setProps({getReferenceClientRect:()=>(0,S.MG)(this.editor.view,this.nodeEndPos||0,this.nodeEndPos||0),placement:"rtl"===n?"left":"right"}),this.element&&(this.element.style.transform="rtl"===n?"scaleX(-1)":"none"),null==(t=this.tippy)||t.show()}hide(){var e;this.isFlagEnabled&&(this.onHide&&"function"==typeof this.onHide&&this.onHide(),null==(e=this.tippy)||e.hide())}destroy(){var e,t,n;this.isFlagEnabled&&(this.typingTimeout&&clearTimeout(this.typingTimeout),(null==(e=this.tippy)?void 0:e.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null==(t=this.tippy)||t.destroy(),null==(n=this.element)||n.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler))}constructor({editor:e,view:t}){this.element=null,this.target=null,this.preventHide=!1,this.typingTimeout=null,this.validParentNode=null,this.nodeEndPos=null,this.mousedownHandler=()=>{this.nodeEndPos&&this.isFlagEnabled&&(this.preventHide=!0,this.editor.commands.setTextSelection(this.nodeEndPos),setTimeout(()=>{(0,el.py)(),this.editor.commands.autoComplete(),this.hide()}))},this.focusHandler=()=>{setTimeout(()=>this.update(this.view))},this.blurHandler=e=>{var t,n;let{event:i}=e;if(this.preventHide){this.preventHide=!1;return}(null==i?void 0:i.relatedTarget)&&(null==(n=this.element)||null==(t=n.parentNode)?void 0:t.contains(i.relatedTarget))||(null==i?void 0:i.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=e=>{this.blurHandler({event:e})},this.shouldShow=e=>{let{view:t,state:n}=e;return!!this.isFlagEnabled&&(this.validParentNode=(0,es.B)({view:t,state:n,isFlagEnabled:this.isFlagEnabled,editor:this.editor}),!!this.validParentNode)},this.isFlagEnabled=W.of.get("arrowAutocomplete"),this.editor=e,this.view=t,this.isEditable=e.isEditable}}let ep=S.YY.create({name:"autocompleteButton",addCommands:()=>({forceHideAutocompleteButton:e=>t=>{let{tr:n}=t;return n.setMeta(ed.f,{forceHide:e}),!0}}),addProseMirrorPlugins(){let{editor:e}=this;return[new X.k_({key:ed.f,state:{init:()=>({buttonElement:null,tippyTarget:null,forceHide:!1,onHide:()=>{}}),apply(e,t){let n=e.getMeta(ed.f);return n?{...t,...n}:t}},view:t=>new eu({view:t,editor:e})})]}});var eh=n(21938),em=n(55084),eg=n(22249),ex=n(15607);let ef=(e,t)=>new X.k_({props:{attributes:()=>{let e=(0,T.KA)().getState(),n=(0,eg.iZ)("buddy-chat")(e);return t.salPanelOpen?{class:"sal-active"}:n?{class:"buddy-active"}:{class:""}},decorations:n=>{let{doc:r,selection:o}=n;if(!e.isEditable)return;let{from:l,to:a}=o,s=[],d=(0,T.KA)().getState(),c=(0,em.yZ)(d);if((0,eg.iZ)("image-chat")(d)&&c&&o instanceof X.nh)return s.push(i.NZ.node(o.from,o.to,{class:"is-selecting-node"})),i.zF.create(r,s);let u=(0,eg.iZ)("buddy-chat")(d);return t.salPanelOpen||u?((0,ex.IV)(o.$from,Z.jg).forEach((e,t)=>{s.push(i.NZ.node(e.pos,e.pos+e.node.nodeSize,{class:(0,eh.cx)(0==t?"sal-active-card buddy-active-card":"sal-active-card-parent")}))}),(0,ex.We)(e)||(o instanceof X.U3?s.push(i.NZ.inline(l,a,{class:(0,eh.cx)("sal-selection-text")})):o instanceof X.nh&&s.push(i.NZ.node(l,a,{class:(0,eh.cx)("sal-selection-node")}))),i.zF.create(r,s)):void 0}}}),ey=S.YY.create({name:"salExtension",addStorage:()=>({salPanelOpen:!1}),addProseMirrorPlugins(){return[ef(this.editor,this.storage)]},addCommands(){return{setSalOpen:e=>t=>{let{state:n,dispatch:i}=t;return this.storage.salPanelOpen=e,!0}}}});var ev=n(78116),eb=n(60122),ej=n(12364),ew=n.n(ej),eC=n(62040),eI=n(73364);class eS extends eI.c{[Symbol.iterator](){return this.yarray[Symbol.iterator]()}values(){let e=this.yarray.length,t=-1;return{[Symbol.iterator]:()=>({next(){return++t===e?{value:void 0,done:!0}:{value:this.yarray.get(t),done:!1}}})}}forEach(e){return this.yarray.forEach(e)}set(e,t){return this.doc.transact(n=>{this.map.has(e)&&this.delete(e),this.yarray.push([{key:e,val:t}])}),t}delete(e){let t=0;for(let n of this.yarray){if(n.key===e){this.yarray.delete(t);break}t++}}get(e){let t=this.map.get(e);return t&&t.val}has(e){return this.map.has(e)}constructor(e){super(),this.yarray=e,this.doc=e.doc,this.map=new Map;let t=e.toArray();this.doc.transact(n=>{for(let n=t.length-1;n>=0;n--){let i=t[n];this.map.has(i.key)?e.delete(n):this.map.set(i.key,i)}}),e.observe(t=>{let n=new Map,i=Array.from(t.changes.added);t.changes.deleted.forEach(e=>{e.content.getContent().forEach(e=>{this.map.get(e.key)===e&&(this.map.delete(e.key),n.set(e.key,{action:"delete",oldValue:e.val}))})});let r=new Map;i.map(e=>e.content.getContent()).flat().forEach(e=>{r.set(e.key,e)});let o=new Set,l=e.toArray();this.doc.transact(t=>{for(let t=l.length-1;t>=0&&(r.size>0||o.size>0);t--){let i=l[t];if(o.has(i.key))o.delete(i.key),e.delete(t,1);else if(r.get(i.key)===i){let e=this.map.get(i.key);if(e)o.add(i.key),n.set(i.key,{action:"update",oldValue:e.val,newValue:i.val});else{let e=n.get(i.key);e&&"delete"===e.action?n.set(i.key,{action:"update",newValue:i.val,oldValue:e.oldValue}):n.set(i.key,{action:"add",newValue:i.val})}r.delete(i.key),this.map.set(i.key,i)}else r.has(i.key)&&(o.add(i.key),r.delete(i.key))}}),n.size>0&&this.emit("change",[n])})}}class ek{run(e){}}class eA extends ek{createKeyValue(e,t){return new eS(e.getArray(t))}getRestoreMap(e){return e.getMap("annotationsAbsolute")}run(e){let t=this.createKeyValue(e,"annotationsAbsoluteKV");for(let[n,i]of this.getRestoreMap(e).entries())t.set(n,i)}constructor(...e){super(...e),this.name="AnnotationsYKeyValue"}}class eE{runMigrations(){let e=this.getMigrationsMap();for(let t of this.migrations)if(!this.hasRunMigration(t.name))try{t.run(this.document),e.set(t.name,!0)}catch(e){}}getMigrationsMap(){return this.document.getMap(eE.ANNOTATION_MIGRATIONS_KEY)}hasRunMigration(e){return this.getMigrationsMap().get(e)||!1}constructor(e){this.migrations=[new eA],this.document=e,this.document.transact(()=>{this.runMigrations()}),this.annotations=this.document.getMap("annotations"),this.annotationsAbsolute=new eS(this.document.getArray("annotationsAbsoluteKV"))}}eE.ANNOTATION_MIGRATIONS_KEY="annotationMigrations";class e_{get id(){return this.decoration.type.spec.id}get from(){return this.decoration.from}get data(){return this.decoration.type.spec.data}get HTMLAttributes(){return this.decoration.type.attrs}toString(){return JSON.stringify({id:this.id,data:this.data,from:this.from,HTMLAttributes:this.HTMLAttributes})}constructor(e){this.decoration=e}}var eR=n(53885),eP=n(46814),eT=n(9922),ez=n.n(eT),eM=n(35342),eD=n.n(eM),eO=n(831),eL=n.n(eO),eN=n(56603),eB=n(67200),eU=n(67864);function eF(e){let t=[];for(let n=e.length-1;n>=0;n--){let i=e[n];t.push({...i,prev:i.next,next:i.prev})}return t}class eW{flushUndoQueue(){let{undoQueue:e}=this;return this.undoQueue=[],e}set(e,t){let n=this.map.get(e);return this.undoQueue.unshift({type:"set",key:e,next:n,prev:t}),this.map.set(e,t)}delete(e){let t=this.map.get(e);return void 0===t||this.undoQueue.unshift({type:"set",key:e,next:t,prev:void 0}),this.map.delete(e)}constructor(e){this.map=e,this.undoQueue=[]}}class eG{persistRestoreMap(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={deletion:0,relToAbs:0,setting:0,total:0},i=performance.now();(t||this.hasChanges)&&(this.transactYDoc(()=>{let t=performance.now();for(let{key:e}of this.restoreMap)this.restoreMap.delete(e);n.deletion=performance.now()-t,this.map.forEach(t=>{let{id:i,pos:r,data:o}=t;try{let t=performance.now(),l=this.relToAbs(e,r);n.relToAbs+=performance.now()-t;let a=performance.now();this.restoreMap.set(i,{id:i,data:o,absPos:l}),n.setting+=performance.now()-a}catch(e){console.error("[Annotations] persistRestoreMap error: ",e.message)}})}),n.total=performance.now()-i,this.log("[Annotations] persistRestoreMap in ".concat(n.total,"ms"),{values:this.restoreMap.yarray.toArray(),performance:n}),this.hasChanges=!1)}flushMoveInstructionQueue(){let{moveInstructionMap:e}=this;return this.moveInstructionMap={},Object.values(e)}clearCutData(){this.cutData=null,this.filmstripCutData=null}getAnnotationsBetween(e,t,n){let i=[];for(let r of this.map.values())try{let o=this.relToAbs(e,r.pos);if(null===o)continue;t<=o&&o<n&&i.push({id:r.id,data:r.data,pos:o,relativePos:r.pos})}catch(e){console.warn("[Annotations] getAnnotationsBetween error: ",e.message)}return i}apply(e,t){if((0,eB.LP)(e)){try{this.createDecorations(t)}catch(e){console.warn("[Annotations] handle remote change, not create decorations: ".concat(e.message))}return this}let n=e.getMeta(eR.q);if(n){switch(n.type){case"addAnnotation":this.addAnnotation(n,t);break;case"restoreAnnotations":this.restoreAnnotations(n);break;case"clearAnnotations":this.clearAnnotations();break;case"deleteAnnotation":this.deleteAnnotation(n.id);break;case"refreshAnnotationDecorations":try{this.createDecorations(t)}catch(e){console.warn("could not create decorations: ".concat(e.message))}break;case"moveAnnotations":this.moveAnnotations(t,n.toMove)}return this.hasChanges=!0,this}switch(e.getMeta("uiEvent")){case"cut":this.handleCutTransaction(t,e);break;case"paste":this.handlePasteTransaction(t,e)}let i=e.getMeta("annotationEvent");switch(null==i?void 0:i.type){case"split-card":this.handleSplitCard(t,e,i);break;case"split-block":this.handleSplitBlock(t,e,i);break;case"join-forward":this.handleJoinForward(t,e,i);break;case"join-backward":this.handleJoinBackward(t,e,i);break;case"update-node-attrs":this.handleUpdateNodeAttrs(t,e,i);break;case"rearrange-cards":this.handleRearrangeCards(t,e,i);break;case"move":this.handleMove(t,e,i);break;case"merge-cards":this.handleMergeCards(t,e,i);break;case"drop":this.handleDropAnnotations(t,e,i);break;case"unwrap-node":this.handleUnwrapNode(t,e,i);break;case"wrap-nodes":this.handleWrapNodes(t,e,i);break;case"filmstrip-cut":this.handleFilmstripCut(t,e,i);break;case"filmstrip-paste":this.handleFilmstripPaste(t,e,i);break;default:e.getMeta("appendedTransaction")||(this.handleReplaceTransaction(t,e),this.handleReplaceAroundTransaction(t,e))}return e.docChanged&&(this.hasChanges=!0),this.handleLocalChange(e)}restore(e,t){t.forEach(t=>{let{next:n,key:i}=t;void 0===n?this.map.delete(i):this.map.set(i,{...n,pos:this.refreshRelativePos(e,n.pos)})}),this.persistRestoreMap(e,!0)}handleUnwrapNode(e,t,n){let{pos:i}=n,r=t.before.resolve(i),o=r.start(r.depth+1),l=t.before.resolve(o).end(),a=this.getAnnotationsBetween(e,o,l).map(t=>{let{id:n,relativePos:r}=t,l=this.relToAbs(e,r);return null===l?null:{id:n,newPos:i+(l-o)}}).filter(e=>!!e);this.log("%c[Annotations] unwrap node","color: green",{tr:t,pos:i,start:o,end:l,toMove:a}),a.length>0&&this.enqueueMoveInstructions(a)}handleWrapNodes(e,t,n){let{start:i,end:r,level:o}=n,l=this.getAnnotationsBetween(e,i,r).map(e=>{let{id:t,pos:n}=e;return{id:t,newPos:n+o}}).filter(e=>!!e);this.log("%c[Annotations] wrap nodes","color: green",{tr:t,start:i,end:r,toMove:l}),l.length>0&&this.enqueueMoveInstructions(l)}handleMergeCards(e,t,n){let{insertPos:i,contentPos:r}=n,o=t.before.nodeAt(r);if(!o)return void console.error("[AnnotationState] trying to merge cards, but cannot resolve content wrapper");let l=this.getAnnotationsBetween(e,r,r+o.nodeSize).map(e=>{let{id:t,pos:n}=e;return{id:t,newPos:i+(n-r-1)}});this.log("%c[Annotations] merge cards","color: green",{transaction:t,insertPos:i,contentPos:r,toMove:l}),l.length>0&&this.enqueueMoveInstructions(l)}handleRearrangeCards(e,t,n){let{rearrangedCardPositions:i,insertPos:r}=n,o=i.flatMap(n=>{let{newPos:i,oldPos:r}=n,o=t.before.resolve(r);return this.getAnnotationsBetween(e,r,r+o.nodeAfter.nodeSize).map(e=>{let{id:t,pos:n}=e;return{id:t,newPos:i+(n-r)}})}),l=[],a=(0,Z.aJ)(t.before);if(a){let n=i[0].oldPos,o=Math.min(n,r),s=Math.max(n,r);l=a.flatMap(n=>{let{node:r,pos:l}=n;if(!(l>=o&&l<=s&&!i.find(e=>e.id===r.attrs.id)))return[];{let n=t.before.resolve(l),i=l+n.nodeAfter.nodeSize;return this.getAnnotationsBetween(e,l,i).map(e=>{let{id:n,pos:i}=e;return{id:n,newPos:t.mapping.map(i)}})}})}this.log("%c[Annotations] rearrange cards","color: green",{transaction:t,rearrangedCardPositions:i,annotationsInRearrangedCards:o,jumpedAnnotations:l});let s=[...o,...l];s.length>0&&this.enqueueMoveInstructions(s)}handleMove(e,t,n){let{insertPos:i,insertPosRaw:r,pos:o,end:l}=n,a=this.getAnnotationsBetween(e,o,l).map(e=>{let{id:t,pos:n}=e;return{id:t,newPos:i+(n-o)}}),s=this.getAnnotationsBetween(e,Math.min(r,l),Math.max(r,o)).map(e=>{let{id:n,pos:i}=e;return{id:n,newPos:t.mapping.map(i)}});this.log("%c[Annotations] move","color: green",{transaction:t,insertPos:i,insertPosRaw:r,pos:o,end:l,annotationsInCard:a,jumpedAnnotations:s});let d=[...a,...s];d.length>0&&this.enqueueMoveInstructions(d)}handleUpdateNodeAttrs(e,t,n){let{pos:i}=n,r=t.doc.nodeAt(i);if(!r)return;let o=this.getAnnotationsBetween(e,i,i+r.nodeSize).map(e=>{let{id:t,pos:n}=e;return{id:t,newPos:n}});this.log("%c[Annotations] update node attrs","color: green",{transaction:t,pos:i,toMove:o}),o.length>0&&this.enqueueMoveInstructions(o)}handleJoinBackward(e,t,n){let{atBeginning:i,joinPos:r}=n;if(!i)return;let o=t.before.resolve(r),l=t.before.resolve(o.before()),a=l.nodeBefore,s=l.nodeAfter;if(!a||!s)return;let d=l.pos+s.nodeSize,c=l.pos-a.nodeSize,u=e.selection.from;this.log("%c[Annotations] join backward","color: green",{transaction:t,prevBlock:a,nextBlock:s,nextBlockPos:l.pos,nextBlockEnd:d,prevBlockPos:c,joinPoint:u});let p=this.getAnnotationsBetween(e,l.pos,d);if(0===p.length)return void this.enqueueRefreshDecorations();0===s.content.size?(p.forEach(e=>{let{id:t}=e;return this.undoableMap.delete(t)}),requestAnimationFrame(()=>{this.writeUndoStack(e)})):this.enqueueMoveInstructions(p.map(e=>{let{id:t,pos:n}=e,i=Math.max(n-l.pos-1,0);return{id:t,newPos:(0===a.content.size?c:u)+i}}))}handleJoinForward(e,t,n){let{atEnd:i,joinPos:r}=n;if(!i)return;let o=t.before.resolve(r),{pos:l,node:a}=(0,ex.TK)(o,e=>e.isBlock)[0],s=t.before.resolve(o.after()),d=s.nodeAfter;if(!d)return;let c=s.pos+d.nodeSize;this.log("%c[Annotations] join forward","color: green",{sel:e.selection,prevBlock:a,transaction:t,deleteAnnotations:!!d.isAtom,joinPos:o.pos,prevBlockPos:l,nextBlockPos:s.pos,nextBlock:d});let u=this.getAnnotationsBetween(e,l,l+a.nodeSize),p=this.getAnnotationsBetween(e,s.pos,c);if(0===p.length&&0===u.length)return void this.enqueueRefreshDecorations();let h=t=>{t.forEach(e=>{let{id:t}=e;return this.undoableMap.delete(t)}),requestAnimationFrame(()=>{this.writeUndoStack(e)})};d.isAtom&&a.content.size>0?h(p):0===a.content.size?h(u):this.enqueueMoveInstructions(p.map(e=>{let{id:t,pos:n}=e,i=Math.max(n-s.pos-1,0);return{id:t,newPos:(0===a.content.size?l:r)+i}}))}handleSplitBlock(e,t,n){let{splitPos:i,atBeginning:r}=n;if(r)return void this.enqueueRefreshDecorations();let o=t.before.resolve(i),{pos:l,node:a}=(0,ex.TK)(o,e=>e.isBlock)[0],{$from:s}=e.selection,d=(0,ex.TK)(s,e=>e.isBlock)[0],c=this.getAnnotationsBetween(e,i,l+a.nodeSize).map(e=>{let{id:t,pos:n}=e,r=n-i;return{id:t,newPos:d.pos+(0===r?r:r+1)}});c.length>0?this.enqueueMoveInstructions(c):this.enqueueRefreshDecorations(),this.log("%c[Annotations] split block","color: green",{sel:e.selection,transaction:t,splitPos:i,toMove:c,$before:o})}handleSplitCard(e,t,n){let{splitPos:i}=n,r=t.before.resolve(i),o=(0,ex.TK)(r,Z.jg)[0];if(!o)return;let l=o.pos,a=o.pos+o.node.nodeSize,s=this.getAnnotationsBetween(e,l,a).map(e=>{let{id:n,pos:r}=e;return{id:n,newPos:r===i?t.mapping.map(r+1)-1:t.mapping.map(r)}});this.log("%c[Annotations] split card","color: green",{transaction:t,splitPos:i,parentEnd:a,toMove:s}),this.enqueueMoveInstructions(s)}handlePasteTransaction(e,t){if(!this.cutData&&!this.filmstripCutData)return;let n=t.steps.find(e=>"replace"===e.jsonID);if(!n)return;let{from:i,to:r,slice:{openStart:o}}=n,l=e.doc.resolve(n.from),a=r===i?i:i+1,s=null==l.nodeBefore&&l.parent.isBlock,d=!o||s;if(this.log("%c[Annotations] paste transaction","color: green",{transaction:t,insertPos:i,resolved:l,isPasteBeginning:s,pasteType:this.cutData?"cut":"filmstrip-cut"}),this.cutData){let e=this.cutData;this.cutData=null;let t=e.toMove.map(e=>{let{id:t,offset:n}=e;return{id:t,newPos:a+(d?n:Math.max(0,n))}});t&&t.length>0&&(this.log("[Annotations] paste from cut final move",t),this.enqueueMoveInstructions(t))}else if(this.filmstripCutData){let n=this.filmstripCutData;this.filmstripCutData=null;let i=a-1;for(;i<e.doc.nodeSize;){let t=e.doc.nodeAt(i);if(t&&(0,Z.jg)(t))break;i++}let r=this.getMoveInstructionsForFilmstripPaste(t,n,i);r&&r.length>0&&(this.log("[Annotations] paste from filmstrip cut final move",r),this.enqueueMoveInstructions(r))}}getMoveInstructionsForFilmstripPaste(e,t,n){if(!t)return;let i=(0,S.xe)(e.doc,Z.jg);if(!i)return;let r=e.doc.resolve(n).depth,o=i.filter(t=>{let{pos:n}=t;return e.doc.resolve(n).depth===r}),l=o.findIndex(e=>e.pos===n);if(-1===l)return;let a=o.slice(l);return t.flatMap(e=>{let{cardIndex:t,annotations:n}=e;return n.map(e=>{let{id:n,offset:i}=e,r=a[t];if(r)return{id:n,newPos:r.pos+i}}).filter(e=>!!e)})}handleFilmstripPaste(e,t,n){if(!this.cutData&&!this.filmstripCutData)return;let{insertPos:i}=n;if(this.cutData){let e=this.cutData;this.cutData=null;let n=e.toMove.map(e=>{let{id:t,offset:n}=e;return{id:t,newPos:i+n}});n&&n.length>0&&(this.log("[Annotations] filmstripPaste from cut final move",{tr:t,cutData:e,moveInstructions:n}),this.enqueueMoveInstructions(n))}else if(this.filmstripCutData){let e=this.filmstripCutData;this.filmstripCutData=null;let n=this.getMoveInstructionsForFilmstripPaste(t,e,i);n&&n.length>0&&(this.log("%c[Annotations] filmstripPaste from filmstrip cut final move","color: green",{tr:t,filmstripCutData:e,moveInstructions:n}),this.enqueueMoveInstructions(n))}}handleFilmstripCut(e,t,n){this.cutData=null,this.filmstripCutData=n.deleted.map(n=>{let{cardIndex:i,pos:r}=n,o=t.before.resolve(r),l=r+o.nodeAfter.nodeSize;return{cardIndex:i,annotations:this.getAnnotationsBetween(e,r,l).map(e=>{let{id:t,pos:n}=e;return{id:t,offset:n-r}})}}),this.log("%c[Annotations] filmstripCut","color: green",{tr:t,filmstripCutData:this.filmstripCutData})}handleCutTransaction(e,t){let n=t.steps.find(e=>"replace"===e.jsonID);if(!n)return;this.filmstripCutData=null;let{from:i,to:r}=n,o=e.doc.resolve(i),l=null==o.nodeAfter&&null==o.nodeBefore&&o.parent.isBlock,a=this.getAnnotationsBetween(e,i-!!l,r),s=a.map(t=>{let n=this.relToAbs(e,t.relativePos);return{id:t.id,offset:n-i}});this.cutData={slice:n.slice,toMove:s},this.log("%c[Annotations] cut transaction","color:green",{isWholeBlock:l,resolved:o,transaction:t,annotations:a,moveData:s})}handlePrependContentToBlock(e,t){let n=t.steps.find(e=>"replace"===e.jsonID);if(!n)return;let{from:i}=n,r=t.before.resolve(i);if(!r.nodeAfter)return;let o=this.getAnnotationsBetween(e,i,i+r.nodeAfter.nodeSize).map(n=>{let{id:r,relativePos:o}=n,l=this.relToAbs(e,o);return{id:r,newPos:l===i?t.mapping.map(l+1)-1:t.mapping.map(l)}});o.length>0&&(this.log("%c[Annotations] replace transaction - prepend content","color:green",{tr:t,annotationsToMove:o}),this.enqueueMoveInstructions(o))}handleReplaceTransaction(e,t){let n=t.steps.find(e=>"replace"===e.jsonID);if(!n)return;let{from:i,to:r}=n,o=t.before.resolve(i),l=t.before.resolve(r),a=o.parent!==l.parent,s=0==n.slice.content.size,d=0===o.parentOffset&&r>=i+o.parent.nodeSize-2,c=d&&s;if(0===l.parentOffset&&l.depth===o.depth+1&&l.pos-o.pos==1)return this.handlePrependContentToBlock(e,t);let u=!1;if(a){var p;let n=[...c?[]:this.getAnnotationsBetween(e,i-o.parentOffset-1,i).map(t=>{let{id:n,relativePos:i}=t;return{id:n,newPos:this.relToAbs(e,i)}}),...this.getAnnotationsBetween(e,r,r+(null==(p=l.nodeAfter)?void 0:p.nodeSize)+1).map(n=>{let{id:i,relativePos:r}=n;return{id:i,newPos:t.mapping.map(this.relToAbs(e,r))}})];this.log("[Annotations] multiline to move",n),n.length>0&&(u=!0,this.enqueueMoveInstructions(n))}let h=this.getAnnotationsBetween(e,i-(c||a&&0===o.parentOffset?1:0),r);h.length>0&&(u=!0,this.log("[Annotations] to delete",h),h.forEach(e=>{this.undoableMap.delete(e.id)})),u&&(this.log("%c[Annotations] replace transaction","color:green",{tr:t,annotationsToDelete:h,isWholeBlock:c,isMultiline:a,replacingEntireFromBlock:d,replacingWithNothing:s}),requestAnimationFrame(()=>{this.writeUndoStack(e)}))}handleReplaceAroundTransaction(e,t){let n=eD()(t.steps.filter(e=>"replaceAround"===e.jsonID),t=>{let{from:n,to:i}=t;return this.getAnnotationsBetween(e,n,i)}),i=eL()(n,e=>e.id).map(e=>{let{id:n,pos:i}=e;return{id:n,newPos:t.mapping.map(i)}});return i.length>0&&this.log("%c[Annotations] replaceAround transaction","color:green",{tr:t,moveInsturctions:i}),0!==i.length&&(this.enqueueMoveInstructions(i),!0)}clearAnnotations(){this.transactYDoc(()=>{this.map.forEach((e,t)=>{this.map.delete(t)})})}restoreAnnotations(e){this.log("%c[Annotations] restoreAnnotations","color: green",e);let{toRestore:t}=e;this.clearAnnotations(),this.enqueueMoveInstructions(t.filter(e=>{let{absPos:t}=e;return null!=t}).map(e=>{let{absPos:t,id:n}=e;return{id:n,newPos:t}}))}addAnnotation(e,t){this.log("%c[Annotations] addAnnotation","color: green",e);let{pos:n,id:i,data:r}=e,o=this.absToRel(t,n);this.map.set(i,{id:i,pos:o,data:r})}deleteAnnotation(e){this.log("%c[Annotations] deleteAnnotation","color: green",e),this.map.delete(e)}moveAnnotations(e,t){let{map:n}=this;this.log("%c[Annotations] moveAnnotations","color: green",t),this.transactYDoc(()=>{t.forEach(t=>{let{id:i,newPos:r}=t,o=n.get(i)||{id:i};this.undoableMap.set(i,{...o,pos:this.absToRel(e,r)})})}),this.writeUndoStack(e)}writeUndoStack(e){let t=eb.Mj.getState(e).undoManager;if(0===t.undoStack.length)return;let n=this.undoableMap.flushUndoQueue();if(0===n.length)return;let i=t.undoStack[t.undoStack.length-1],r="annotations",o=i.meta.get(r)||[];o.length>0&&this.log("[Annotations] existing undo stack",{existing:o,toWrite:n,stack:t.undoStack});let l=[...n,...o];i.meta.set(r,l),this.log("[Annotations] writing to undo stack",l)}createDecorations(e){let{map:t}=this.options;this.refreshDecorations=!1;let n=[],r=[];t.forEach((t,o)=>{let l=(0,eN.d_)(e,t.pos);if(null==l)return;let a=e.doc.nodeAt(l);a&&((null==a?void 0:a.isInline)?n.push(i.NZ.inline(l,l+1,{class:"debug-comment-cursor"})):n.push(i.NZ.node(l,l+a.nodeSize,{class:"debug-comment-block"}))),r.push({id:o,data:t.data,relativePos:t.pos,pos:l})}),e.doc.descendants((e,t,o)=>(!(t>0)||!!(0,eU.cE)(o)||!!(0,eU.cE)(e))&&(r.filter(n=>n.pos>=t&&n.pos<t+e.nodeSize).forEach(r=>{let{id:o,data:l}=r;n.push(i.NZ.node(t,t+e.nodeSize,{},{isAnnotation:!0,id:o,data:l}))}),!0)),this.decorations=i.zF.create(e.doc,n),this.annotations=r}handleDropAnnotations(e,t,n){let{dragging:{origNodePos:i,inBlock:r,inCard:o},droppedBlockPos:l}=n,a=[];r.forEach(e=>{let t=e.pos-i;a.push({id:e.id,newPos:l+t})}),this.getAnnotationsBetween(e,l,l+1).filter(e=>!a.find(t=>t.id===e.id)).forEach(e=>{a.push({id:e.id,newPos:t.mapping.map(e.pos)})}),o.filter(e=>!a.find(t=>t.id===e.id)).forEach(e=>{let n=t.mapping.map(e.pos);a.push({newPos:n,id:e.id})}),this.log("%c[Annotations] handleDropAnnotations","color: green",{action:n,tr:t,toMove:a}),a.length>0&&this.enqueueMoveInstructions(a)}handleLocalChange(e){let t=[...this.decorations.find(void 0,void 0,e=>e.isAnnotation&&this.moveInstructionMap[e.id])],n=this.decorations.remove(ez()(t)).map(e.mapping,e.doc).add(e.doc,t);return this.decorations=n,this}absToRel(e,t){let n=(0,eN.JO)(e,t);if(!n)throw Error("Y.State non initialized");return n}relToAbs(e,t){return(0,eN.d_)(e,t)}refreshRelativePos(e,t){let{doc:n,type:i,binding:r}=eb.pJ.getState(e),o=(0,eP.bL)(n,i,t,r.mapping);return(0,eP.Bw)(o,i,r.mapping)}enqueueMoveInstructions(e){e.forEach(e=>{this.moveInstructionMap[e.id]&&console.error("[AnnotationState] trying to enqueue two move instructions for annotation with targetId=".concat(e.id)),this.moveInstructionMap[e.id]=e})}enqueueRefreshDecorations(){this.refreshDecorations=!0}transactYDoc(e){this.options.document.transact(e)}log(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];W.of.get("debugComments")?console.log(...t):console.debug(...t)}constructor(e){this.options=e,this.decorations=i.zF.empty,this.annotations=[],this.refreshDecorations=!1,this.hasChanges=!1,this.filmstripCutData=null,this.cutData=null,this.moveInstructionMap={},this.map=e.map,this.restoreMap=e.restoreMap,this.undoableMap=new eW(this.map)}}let eV=e=>{let t=ew()(e=>{eR.q.getState(e.state).persistRestoreMap(e.state)},500);return new X.k_({key:eR.q,state:{init:()=>new eG(e),apply:(e,t,n,i)=>t.apply(e,i)},view:()=>({update(e){t(e)}}),props:{transformPasted(t){var n;let i=this.getState(e.editor.state),r=null==(n=t.content.firstChild)?void 0:n.attrs.docId;return r&&r!==e.editor.gammaDocId&&i.clearCutData(),t},handleDOMEvents:{copy(e){return this.getState(e.state).clearCutData(),!1}},decorations(t){let{decorations:n,annotations:i}=this.getState(t);return e.onUpdate&&e.onUpdate(n.find().map(e=>new e_(e)),i),n}}})},eH=S.YY.create({name:"annotation",onCreate(){let e=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];W.of.get("debugComments")?console.log(...t):console.debug(...t)};this.options.document.on("afterAllTransactions",t=>{let n=eR.q.getState(this.editor.view.state),i=n.flushMoveInstructionQueue();i.length>0?(e("%c[Annotations] afterAllTransactions handling queued moves","color:pink",i),this.editor.commands.moveAnnotations(i)):n.refreshDecorations&&(e("%c[Annotations] afterAllTransactions refreshDecorations","color:pink"),this.editor.commands.refreshDecorations())});let t=eR.q.getState(this.editor.state);window.gammaAnnotations=t;let n=eb.Mj.getState(this.editor.state).undoManager;setTimeout(()=>{n.on("stack-item-popped",e=>{let i=e.stackItem.meta.get("annotations");if(!i)return void t.persistRestoreMap(this.editor.state,!0);let{undoStack:r,redoStack:o}=n;"undo"===e.type&&o.length>0?o[o.length-1].meta.set("annotations",eF(i)):"redo"===e.type&&r.length>0&&r[r.length-1].meta.set("annotations",eF(i)),t.restore(this.editor.state,i)})},0),t.map.observe(ew()(()=>{e("[Annotations] map observe -> resfreshDecorations"),this.editor.commands.refreshDecorations()})),this.editor.commands.refreshDecorations()},addCommands:()=>({restoreAnnotations:e=>t=>{let{dispatch:n,tr:i}=t;return n&&(i.setMeta(eR.q,{type:"restoreAnnotations",toRestore:Object.values(e)}),n(i)),!0},updateAttributes:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{var i,r;let{tr:o,state:l,dispatch:a}=n,s=null,d=null,c=(i="string"==typeof e?e:e.name,(r=l.schema).nodes[i]?"node":r.marks[i]?"mark":null);return!!c&&("node"===c&&(s=(0,S.Pg)(e,l.schema)),"mark"===c&&(d=(0,S.I2)(e,l.schema)),a&&o.selection.ranges.forEach(e=>{let n=e.$from.pos,i=e.$to.pos;l.doc.nodesBetween(n,i,(e,r)=>{s&&s===e.type&&o.setNodeMarkup(r,void 0,{...e.attrs,...t}).setMeta("annotationEvent",{type:"update-node-attrs",pos:r}),d&&e.marks.length&&e.marks.forEach(l=>{if(d===l.type){let a=Math.max(r,n),s=Math.min(r+e.nodeSize,i);o.addMark(a,s,d.create({...l.attrs,...t}))}})})}),!0)}},wrapWithAnnotations:(e,t)=>n=>{let{state:i,tr:r,dispatch:o}=n,l=i.schema.nodes[e],{$from:a,$to:s}=i.selection,d=a.blockRange(s),c=d&&(0,eC.oM)(d,l,t);if(!c||!d)return!1;let{start:u,end:p}=d;return!o||(r.wrap(d,c).setMeta("annotationEvent",{type:"wrap-nodes",start:u,end:p,level:1}).scrollIntoView(),!0)},moveAnnotations:e=>t=>{let{dispatch:n,tr:i}=t;return n&&(i.setMeta(eR.q,{type:"moveAnnotations",toMove:e}),n(i)),!0},clearAnnotations:()=>e=>{let{dispatch:t,tr:n}=e;return t&&(n.setMeta(eR.q,{type:"clearAnnotations"}),t(n)),!0},refreshDecorations:()=>e=>{let{dispatch:t,tr:n}=e;return t&&(n.setMeta(eR.q,{type:"refreshAnnotationDecorations"}),t(n)),!0},addAnnotation:e=>{let{pos:t,id:n,data:i}=e;return e=>{let{dispatch:r,state:o}=e;return r&&o.tr.setMeta(eR.q,{type:"addAnnotation",id:n,data:i,pos:t}),!0}},deleteAnnotation:e=>t=>{let{dispatch:n,state:i}=t;return n&&i.tr.setMeta(eR.q,{type:"deleteAnnotation",id:e}),!0}}),addProseMirrorPlugins(){let{document:e,onUpdate:t}=this.options,n=new eE(e);return[eV({document:e,editor:this.editor,map:n.annotations,restoreMap:n.annotationsAbsolute,onUpdate:t})]}});var eq=n(36271);let eK=S.YY.create({name:"draftComments",addCommands:()=>({removeDraftComments:e=>t=>{let{dispatch:n,tr:i}=t;if(n){let t={type:"removeDraftComment",comments:Array.isArray(e)?e:[e]};i.setMeta(eq._,t),n(i)}return!0},createDraftComment:e=>t=>{let{dispatch:n,tr:i}=t;return n&&(i.setMeta(eq._,{type:"createDraftComment",comment:e}),n(i)),!0}}),addProseMirrorPlugins:()=>[(0,eq.h)()]});var eY=n(29608);let eX=new X.hs("mobileAnnotationPluginKey");class eJ{apply(e,t){let n=e.getMeta(eX);return n&&"setPos"in n&&(this.pos=n.setPos),this}constructor(){this.pos=null}}let e$=S.YY.create({name:"mobileAnnotation",addCommands:()=>({setMobileAddBlockComment:e=>t=>{let{dispatch:n,tr:i,view:r}=t;if(!n)return!1;if(null===e)return i.setMeta(eX,{setPos:null}),n(i),!0;let{clientX:o,clientY:l}=e,a=r.posAtCoords({left:o,top:l});if(null===a)return!0;let s=(0,eU.CS)(a.inside,r);if(!s)return!1;let d=r.coordsAtPos(s.pos),c=o-d.left,u=l-d.top;return i.setMeta(eX,{setPos:{pos:s.pos,end:s.end,offsetX:c,offsetY:u}}),n(i),!0}}),addProseMirrorPlugins(){var e;return[(e=this.editor,new X.k_({key:eX,state:{init:()=>new eJ,apply:(e,t,n,i)=>t.apply(e,i)},props:{handleDOMEvents:{click(t,n){if(!(0,eY.Xb)())return!1;if(n.target.closest("[data-comments-wrapper]"))return;let i=eX.getState(t.state);i.pos||(i.timeout?(clearTimeout(i.timeout),i.timeout=null,e.commands.setMobileAddBlockComment(n)):i.timeout=setTimeout(()=>{i.timeout=null},300))}},decorations(e){let t=eX.getState(e).pos;if(null===t)return i.zF.empty;let n=i.NZ.node(t.pos,t.end,{},{isMobileAnnotation:!0,type:"show-buttons",offsetX:t.offsetX,offsetY:t.offsetY});return i.zF.create(e.doc,[n])}}}))]}});var eZ=n(50764);let eQ=S.YY.create({name:"BlockHover",addProseMirrorPlugins(){return[(0,eZ.bA)(this.editor)]}});var e0=n(48993),e1=n(95889),e6=n(74677);let e2=S.YY.create({name:"editCardAI",onTransaction(e){var t;let{transaction:n}=e;if(!(!n.docChanged||n.getMeta("isEditCardVariant"))&&this.editor.isEditable&&W.of.get("editCard2"))if(null==(t=n.getMeta(eb.pJ))?void 0:t.isUndoRedoOperation)e4(n);else{if(!1===n.getMeta("addToHistory"))return;e5(n)}}}),e5=ew()(e=>{try{let t=(0,T.KA)(),n=t.getState(),i=(0,e0.yL)(n);if(0===Object.keys(i).length)return;(0,e6.A)(e).forEach(n=>{let r={from:n.newStart,to:n.newEnd},o=(0,S.Nx)(e.doc,r,e=>(0,Z.jg)(e)&&!!i[e.attrs.id]);o.length&&o.forEach(e=>{var n;let{node:r}=e,o=r.attrs.id;console.debug("Clearing suggestions for card",o),null===e1.zS||void 0===e1.zS||e1.zS.track(e1.VV.AI_CARD_VARIATION_KEPT,{cardId:o,variantId:i[o].selected,isOriginal:null==(n=i[o].variants.find(e=>e.id===i[o].selected))?void 0:n.isOriginal,interactionId:i[o].interactionId,source:"edit"}),t.dispatch((0,e0.YB)({cardId:o}))})})}catch(e){console.error("[caught] EditCard clearSuggestions error",e)}},250),e4=e=>{try{let t=e.steps[0];if(!t||!(t instanceof eC.Ln))return;let n=t.slice.content,i=(0,T.KA)(),r=i.getState(),o=(0,e0.yL)(r);if(0===Object.keys(o).length)return;n.descendants(e=>{if(!(0,Z.jg)(e))return;let t=e.attrs.id,n=o[t];if(!n)return;let r=n.variants.find(t=>JSON.stringify(t.card)===JSON.stringify(e.toJSON()));r&&i.dispatch((0,e0.S6)({cardId:t,variantId:r.id}))})}catch(e){console.error("[caught] EditCard updateVariations error",e)}},e8=S.YY.create({name:"generateCard",addCommands:()=>({removeGeneratorInputsOnLoad:()=>e=>{let{tr:t,state:n,editor:i}=e;return!!i.isEditable&&((0,S.xe)(n.doc,e=>{var t;return(0,Z.jg)(e)&&(null==(t=e.attrs.generatorInput)?void 0:t.status)==="done"}).forEach(e=>{let{pos:n}=e;t.setNodeAttribute(n,"generatorInput",null)}),!0)}})});var e3=n(32380),e9=n(86083),e7=n(38934);let te=S.YY.create({name:"collaboration",priority:e7.y.Collaboration,addOptions:()=>({document:null,field:"default",fragment:null}),onCreate(){this.editor.extensionManager.extensions.find(e=>"history"===e.name)&&console.warn('[tiptap warn]: "@tiptap/extension-collaboration" comes with its own history support and is not compatible with "@tiptap/extension-history".')},addCommands:()=>({undo:()=>e=>{let{tr:t,state:n,dispatch:i}=e;return t.setMeta("preventDispatch",!0),0!==eb.Mj.getState(n).undoManager.undoStack.length&&(!i||(0,e3.tN)(n)||!0)},redo:()=>e=>{let{tr:t,state:n,dispatch:i}=e;return t.setMeta("preventDispatch",!0),0!==eb.Mj.getState(n).undoManager.redoStack.length&&(!i||(0,e3.ZS)(n)||!0)}}),addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo()}},addProseMirrorPlugins(){let e=this.options.fragment?this.options.fragment:this.options.document.getXmlFragment(this.options.field);return[(0,e9.YZ)(e),(0,e3.$J)()]}}),tt=()=>new X.k_({key:new X.hs("undoHistoryPlugin"),appendTransaction(e,t,n){if(e.some(e=>!1==e.getMeta("addToHistory"))){let e=n.tr;return e.setMeta("addToHistory",!1),e}return null}}),tn=S.YY.create({name:"undoHistory",priority:e7.y.UndoHistory,addProseMirrorPlugins:()=>[tt()],addCommands:()=>({noUndo:()=>e=>{let{tr:t}=e;return t.setMeta("addToHistory",!1),!0}})});var ti=n(97481),tr=n.n(ti),to=n(33612),tl=n.n(to);let ta=(e,t,n)=>{let i=e.resolve(t),r=e.resolve(n),o=i.nodeAfter,l=r.nodeBefore;return!!(o&&(0,Z.jg)(o)&&l&&(0,Z.jg)(l)&&o===l)};var ts=n(30963);let td=(e,t,n)=>e!==t,tc=e=>{let t=document.createElement("span");t.classList.add("ProseMirror-yjs-cursor"),t.setAttribute("style","border-color: ".concat(e.color));let n=document.createElement("div");n.setAttribute("style","background-color: ".concat(e.color)),n.insertBefore(document.createTextNode(e.name),null);let i=document.createTextNode(""),r=document.createTextNode("");return t.insertBefore(i,null),t.insertBefore(n,null),t.insertBefore(r,null),t},tu=e=>({style:"background-color: ".concat(e.color,"70"),class:"ProseMirror-yjs-selection"}),tp=(e,t)=>(n,r,o,l)=>{let a=[];a.push(i.NZ.widget(l,()=>t(n),{key:r+"",side:10}));let s=ts.jk(o,l),d=ts.T9(o,l);return a.push(i.NZ.inline(s,d,e(n),{inclusiveEnd:!0,inclusiveStart:!1})),a},th=/^#[0-9a-fA-F]{6}$/,tm=(e,t,n,r)=>{let o=eb.pJ.getState(e),l=o.doc,a=[];return null!=o.snapshot||null!=o.prevSnapshot||null===o.binding?i.zF.create(e.doc,[]):(t.getStates().forEach((t,i)=>{if(n(l.clientID,i,t)&&null!=t.cursor){let n=t.user||{};null==n.color?n.color="#ffa500":th.test(n.color)||console.warn("A user uses an unsupported color format",n),null==n.name&&(n.name="User: ".concat(i));let s=(0,eP.bL)(l,o.type,g.sH(t.cursor.anchor),o.binding.mapping),d=(0,eP.bL)(l,o.type,g.sH(t.cursor.head),o.binding.mapping);if(null!==s&&null!==d){let t=ts.T9(e.doc.content.size-1,0);s=ts.jk(s,t),d=ts.jk(d,t),a.push(...r(e,n,i,s,d))}}}),i.zF.create(e.doc,a))},tg=function(e){let{awarenessStateFilter:t=td,cursorBuilder:n=tc,selectionBuilder:i=tu,getSelection:r=e=>e.selection,createCursorDecorations:o=tp(i,n)}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cursor";return new X.k_({key:eb.S6,state:{init:(n,i)=>tm(i,e,t,o),apply(n,i,r,l){let a=eb.pJ.getState(l),s=n.getMeta(eb.S6);return a&&a.isChangeOrigin||s&&s.awarenessUpdated?tm(l,e,t,o):i.map(n.mapping,n.doc)}},props:{decorations:e=>eb.S6.getState(e)},view:t=>{let n=()=>{t.docView&&(0,eP.iZ)(t,eb.S6,{awarenessUpdated:!0})},i=()=>{let n=eb.pJ.getState(t.state),i=e.getLocalState()||{};if(null!=n.binding)if(t.hasFocus()){let o=r(t.state),a=(0,eP.Bw)(o.anchor,n.type,n.binding.mapping),s=(0,eP.Bw)(o.head,n.type,n.binding.mapping);null!=i.cursor&&g.uG(g.sH(i.cursor.anchor),a)&&g.uG(g.sH(i.cursor.head),s)||e.setLocalStateField(l,{anchor:a,head:s})}else null!=i.cursor&&null!==(0,eP.bL)(n.doc,n.type,g.sH(i.cursor.anchor),n.binding.mapping)&&e.setLocalStateField(l,null)};return e.on("change",n),t.dom.addEventListener("focusin",i),t.dom.addEventListener("focusout",i),{update:i,destroy:()=>{t.dom.removeEventListener("focusin",i),t.dom.removeEventListener("focusout",i),e.off("change",n),e.setLocalStateField(l,null)}}}})},tx=()=>null,tf=e=>Array.from(e.entries()).map(e=>{let[t,n]=e;return{clientId:t,...n.user}}),ty=S.YY.create({name:"collaborationCursor",addOptions:()=>({provider:null,user:{name:null,color:null},render:e=>{let t=document.createElement("span");if(!e.isReady)return t;t.classList.add("collaboration-cursor__caret"),t.setAttribute("style","border-color: ".concat(e.color));let n=document.createElement("div");n.classList.add("collaboration-cursor__label"),n.setAttribute("style","background-color: ".concat(e.color,"; color: ").concat(tl()(e.color).isDark()?"white":"black"));let i=e.name.split(" ")[0];return n.insertBefore(document.createTextNode(i),null),t.insertBefore(n,null),t},buildSelection:e=>({style:"background-color: ".concat(e.color,"70"),class:"ProseMirror-yjs-selection"}),onUpdate:tx}),addStorage:()=>({users:[]}),addCommands(){return{user:e=>()=>(this.options.user=tr()({},this.options.user,e),this.options.provider.awareness.setLocalStateField("user",this.options.user),!0)}},addProseMirrorPlugins(){return[tg((this.options.provider.awareness.setLocalStateField("user",this.options.user),this.storage.users=tf(this.options.provider.awareness.states),this.options.provider.awareness.on("update",()=>{this.storage.users=tf(this.options.provider.awareness.states)}),this.options.provider.awareness),{createCursorDecorations:(e,t,n,r,o)=>{let l=[];if(ta(e.doc,r,o))return l;l.push(i.NZ.widget(o,()=>this.options.render(t),{key:n+"",side:10}));let a=r<o?r:o,s=r>o?r:o;return l.push(i.NZ.inline(a,s,this.options.buildSelection(t),{inclusiveEnd:!0,inclusiveStart:!1})),l}})]}});var tv=n(7915);let tb=S.YY.create({name:"globalDragHandle",priority:e7.y.GlobalDragHandle,addOptions:()=>({scrollerSelector:"body"}),addStorage:()=>({enabled:!0}),addProseMirrorPlugins(){return[(0,tv.l)({editor:this.editor,storage:this.storage,scrollerSelector:this.options.scrollerSelector})]},extendNodeSchema(e){var t;return{containerHandle:null!=(t=(0,S.gk)((0,S.iI)(e,"containerHandle",e)))&&t}}});var tj=n(1739),tw=n(24926),tC=n(55452);let tI=new X.hs("erasingContent");class tS{toJSON(){return{datetime:this.timestamp.toISOString(),meta:this.tr.meta,steps:this.tr.steps.map(e=>e.toJSON())}}constructor(e){this.tr=e,this.timestamp=new Date(new Date().toLocaleString("en-US",{timeZone:"America/Los_Angeles"}))}}class tk{apply(e,t){return e.docChanged&&(this.transactions.unshift(new tS(e)),this.transactions.length>5&&this.transactions.pop()),this}constructor(){this.transactions=[]}}class tA extends Error{constructor(e){super(e||"Content erased"),this.name="ContentErasedError"}}let tE=S.YY.create({name:"ErasingContent",addProseMirrorPlugins(){let e=this,t=t=>{try{var n;let i=(0,q.HW)();for(let t of this.options.messageLogger.flushMessages()){let n={...t.toDebugObject(),clientID:e.options.provider.document.clientID};tw.yf.logger.info(t.toString(),n),console.log(t.toString(),n)}let r=Math.floor(performance.now()-this.options.startTime),o={event:"CONTENT_ERASED",didFilterTransaction:t.didFilterTransaction,tr:t.tr.toJSON(),prevTrs:null==(n=t.prevTrs)?void 0:n.map(e=>e.toJSON()),timeSinceOpened:r,isBackgrounded:!!document.hidden,docId:this.options.provider.configuration.name,clientID:this.options.provider.document.clientID,userId:null==i?void 0:i.id};tw.yf.logger.error("[ErasingContent] ".concat(r," content erased (FILTERED: ").concat(t.didFilterTransaction,")"),o),tC.Cp(new tA)}catch(e){console.error("Failed to log content erased",e),tC.Cp(e)}};return[new X.k_({key:tI,filterTransaction:(e,n)=>{if(!e.docChanged)return!0;let i=n.doc.type.createAndFill().content;if(null===e.doc.content.findDiffStart(i)){let i=new tS(e),r=tI.getState(n),o=W.of.get("filterContentErasingTrs");return t({tr:i,didFilterTransaction:o,prevTrs:null==r?void 0:r.transactions}),!o}return!0},state:{init:()=>new tk,apply:(e,t,n,i)=>t.apply(e,i)}})]}});var t_=n(86932),tR=n(64084);let tP=S.YY.create({name:"filmstrip",onCreate(){let e=eb.Mj.getState(this.editor.state).undoManager;e.on("stack-item-popped",t=>{let{undoStack:n,redoStack:i}=e,r=t.stackItem.meta.get("filmstripState");if(!r)return;let o=(0,tR.Tz)((0,T.KA)().getState());"undo"===t.type&&i.length>0?i[i.length-1].meta.set("filmstripState",o):"redo"===t.type&&n.length>0&&n[n.length-1].meta.set("filmstripState",o),(0,T.KA)().dispatch((0,tR.Uy)(r))})}});var tT=n(2426),tz=n(24037);class tM{initialize(e){let{element:t,tippyTarget:n,tippyOptions:i}=e;if(!t||!n)return void console.warn("[BubbleMenuView] initialize. No element provided");this.element=t,this.target=n,this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.createTooltip(i),this.element.style.visibility="visible"}createTooltip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t||this.view.dom.parentElement;n&&this.element&&(this.tippy=(0,eo.Ay)(n,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"bottom",hideOnClick:"toggle",offset:[0,5],...e}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e){let t=tz.X.getState(e.state);if(!this.element||!this.target){if(!t.element||!t.tippyTarget)return;this.initialize(t)}let n=t.getNodePos();if(!n)return void this.hide();this.show(n)}show(e){var t,n;let i=this.editor.view.state.doc.nodeAt(e),r=i?(0,ea.KQ)(i):"ltr";null==(t=this.tippy)||t.setProps({getReferenceClientRect:()=>(0,S.MG)(this.editor.view,e,e),placement:"rtl"===r?"bottom-start":"bottom-end"}),null==(n=this.tippy)||n.show()}hide(){var e;this.onHide&&"function"==typeof this.onHide&&this.onHide(),null==(e=this.tippy)||e.hide()}destroy(){var e,t;(null==(e=this.tippy)?void 0:e.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null==(t=this.tippy)||t.destroy(),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}constructor({editor:e,view:t}){this.element=null,this.target=null,this.getNodePos=()=>null,this.preventHide=!1,this.onHide=()=>{},this.focusHandler=()=>{setTimeout(()=>this.update(this.view))},this.blurHandler=e=>{var t,n;let{event:i}=e;if(this.preventHide){this.preventHide=!1;return}(null==i?void 0:i.relatedTarget)&&(null==(n=this.element)||null==(t=n.parentNode)?void 0:t.contains(i.relatedTarget))||(null==i?void 0:i.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=e=>{this.blurHandler({event:e})},this.editor=e,this.view=t}}let tD=S.YY.create({name:"gammaBubbleMenu",addCommands:()=>({forceHideGammaBubbleMenu:e=>t=>{let{tr:n}=t;return n.setMeta(tz.X,{forceHide:e}),!0}}),addProseMirrorPlugins(){let{editor:e}=this;return[new X.k_({key:tz.X,state:{init:()=>({element:null,tippyTarget:null,forceHide:!1,getNodePos:()=>null,tippyOptions:{}}),apply(e,t){let n=e.getMeta(tz.X);return n?{...t,...n}:t}},view:t=>new tM({view:t,editor:e})})]}});var tO=n(43028),tL=n(45574),tN=n(2320),tB=n(61385);let tU=S.YY.create({name:"scrollMargin",addProseMirrorPlugins:()=>[new X.k_({props:{scrollMargin:tB.E0,scrollThreshold:tB.E0}})]});var tF=n(25600),tW=n(25105),tG=n(27196),tV=n(51817),tH=n(12514),tq=n(74676),tK=n(21157),tY=n.n(tK),tX=n(80911);let tJ=e=>{let{editor:t}=e,[n,i]=(0,h.useState)(null);(0,h.useEffect)(()=>{if(!t)return;let e=()=>{i(t.state.selection)};return e(),t.on("selectionUpdate",e),()=>{t.off("selectionUpdate",e)}},[t]);let o=n instanceof X.nh,l=n instanceof tX.J,s=tY()((null==n?void 0:n.toJSON().type)||"none"),d=tY()(o&&(null==n?void 0:n.node.type.name)||""),c=l?void 0:o?"blue":"green";return(0,r.jsx)(tH.Z,{children:(0,r.jsx)(v.s,{className:"selection-debugger",position:"absolute",top:"50px",left:"10px",zIndex:"999999",children:(0,r.jsxs)(a.B,{direction:"column",children:[(0,r.jsxs)(tq.E,{colorScheme:c,children:[s,d&&(0,r.jsxs)("i",{children:[" (",d,")"]})]}),n&&(0,r.jsxs)(tq.E,{colorScheme:"gray",children:["f:",n.from," - t:",n.to,l&&" | side:".concat(n.side)]})]})})})};var t$=n(58495),tZ=n(74158),tQ=n(68986),t0=n(65148);let t1=(0,t$.d_)("1234567890",10),t6=()=>{let e=tQ.e.getItem(t0.E.sessionId);if(e)return e;let t="".concat(+new Date,"__").concat(t1());return tQ.e.setItem(t0.E.sessionId,t),t},t2=(e,t)=>{let{user:n,isUserLoading:i,anonymousUser:r,color:o}=(0,q.ur)(),l=(0,h.useRef)(!1),a=(0,tZ.wA)(),s=(0,h.useMemo)(()=>t6(),[]),d=(0,T.GV)(D.l$),c=(0,h.useMemo)(()=>({id:(null==n?void 0:n.id)||r.id,color:o.value,sessionId:d?s+"__pv":s,isPresenterView:d,idleSince:null,name:(null==n?void 0:n.displayName)||r.displayName||"",profileImageUrl:(null==n?void 0:n.profileImageUrl)||"",isReady:!i,spotlight:{pos:null,cardId:null}}),[n,o,i,d,r,s]);(0,h.useEffect)(()=>{if(!e||e.isDestroyed||!(null==t?void 0:t.awareness))return;e.commands.user(c),!l.current&&c.isReady&&(e.chain().blur().focusDelayed().run(),l.current=!0),a((0,D.vK)({sessionId:c.sessionId}));let n=(e,n)=>{let{added:i,updated:r,removed:o}=e;requestIdleCallback(()=>{if(!t.awareness)return;let e=tf(t.awareness.states);a((0,D._)({collaborators:e}))},{timeout:500})};t.awareness.on("change",n);let i=ew()(n,D.Y5);return t.awareness.on("update",i),()=>{var e,r;null==(e=t.awareness)||e.off("change",n),null==(r=t.awareness)||r.off("update",i)}},[c,e,t,a]),(0,h.useEffect)(()=>{if(!e)return;let t=ew()(t=>{e.commands.user(t)},10);return(0,T.oM)(D.kM,t)},[e])};var t5=n(96284),t4=n(22448),t8=n(10612),t3=n.n(t8),t9=n(42721);let t7=e=>JSON.stringify(Array.from(e.entries())),ne=e=>JSON.stringify(Array.from(e)),nt=e=>Array.from(e.entries()),nn=e=>e instanceof g.q7?{__type:e.constructor.name,id:e.id,length:e.length,info:e.info,parent:e.parent,parentSub:e.parentSub,content:{__type:e.content.constructor.name,...e.content}}:e,ni=()=>{let e=(0,t4.xv)();return(0,t4.Qj)(e,""),(0,t4.zd)(e,u.Go.Sync),(0,t4.zd)(e,1),(0,t4.Gu)(e,new Uint8Array([])),(0,t4.Fo)(e)};class nr{setTransaction(e){this.transaction=e}shouldAssociateTransaction(){return!1}getPayload(){return{}}toString(){let e="in"===this.dir?"\uD83D\uDFE9":"\uD83D\uDFE6",t=t3()(String(this.timestamp),5);return"".concat("[HocuspocusMessage]"," ").concat(t," ").concat(e," ").concat(this.typeName)}toDebugObject(){var e;return{event:"hocuspocus-message",docId:this.docId,userId:null==(e=(0,t9.HW)())?void 0:e.id,hocuspocusMessage:{dir:this.dir,timestamp:this.timestamp,typeName:this.typeName,messageType:this.messageType,payload:this.getPayload()}}}static fromOutgoingMessage(e,t){let n=0===e.encoder.cpos&&0===e.encoder.bufs.length?ni():(0,t4.Fo)(e.encoder);return nr.fromData("out",n,t)}static fromIncomingMessage(e,t){return nr.fromData("in",new Uint8Array(e),t)}static fromData(e,t,n){let i=(0,t5.$C)(t),r=(0,t5.t3)(i);switch((0,t5.cw)(i)){case u.Go.Sync:return new no(r,e,i,n);case u.Go.Awareness:return new nl(r,e,i,n);case u.Go.Auth:return new na(r,e,i,n);case u.Go.QueryAwareness:return new ns(r,e,i,n);case u.Go.Stateless:return new nd(r,e,i,n);case u.Go.CLOSE:return new nc(r,e,i,n);case u.Go.SyncStatus:return new nu(r,e,i,n);default:return new nr(r,e,n)}}constructor(e,t,n){this.docId=e,this.dir=t,this.timestamp=n,this.messageType=null,this.typeName="DebugHocuspocusMessage",this.transaction=null}}class no extends nr{getPayload(){let{transaction:e}=this,t=null,n=null;if(0===this.syncStep){var i;i=this.update,t=JSON.stringify(nt(g.Zx(i)))}else this.syncStep>0&&(n=function(e){try{let t=g.W3(new Uint8Array(e));return{ds:JSON.stringify(nt(t.ds.clients)),structs:JSON.stringify(t.structs.map(nn))}}catch(e){return{}}}(this.update));let r={syncStepName:this.syncStepName,syncStep:this.syncStep,update:ne(this.update),stateVector:t,decodedUpdate:n,transaction:null};return null!==e&&(r.transaction={beforeState:t7(e.beforeState),beforeStateSize:e.beforeState.size,afterState:t7(e.afterState),afterStateSize:e.afterState.size,changed:t7(e.changed),changedSize:e.changed.size,deleteSet:t7(e.deleteSet.clients),deleteSetSize:e.deleteSet.clients.size}),r}shouldAssociateTransaction(){return 2===this.syncStep}toString(){let e=super.toString();return"".concat(e," [step=").concat(this.syncStepName,"]")}constructor(e,t,n,i){super(e,t,i),this.messageType=u.Go.Sync,this.typeName="Sync",this.syncStep=(0,t5.cw)(n),this.syncStepName=0===this.syncStep?"SyncStep1":1===this.syncStep?"SyncStep2":"Update",this.update=(0,t5.bo)(n)}}class nl extends nr{getPayload(){return{len:this.states.length,states:this.states}}constructor(e,t,n,i){super(e,t,i),this.messageType=u.Go.Awareness,this.typeName="Awareness",this.states=[];let r=(0,t5.bo)(n),o=(0,t5.$C)(r),l=(0,t5.cw)(o);for(let e=0;e<l;e++){let e=(0,t5.cw)(o),t=(0,t5.cw)(o),n=(0,t5.t3)(o);this.states.push({clientId:e,clock:t,state:n})}}}class na extends nr{getPayload(){return{authMessageType:this.authMessageTypeName,scope:this.scope}}toString(){let e=super.toString();return"".concat(e," [authType=").concat(this.authMessageTypeName,"]")}constructor(e,t,n,i){super(e,t,i),this.messageType=u.Go.Auth,this.typeName="Auth",this.authMessageType=(0,t5.cw)(n),this.authMessageTypeName=0===this.authMessageType?"Token":1===this.authMessageType?"PermissionDenied":"Authenticated",this.scope=(0,t5.t3)(n)}}class ns extends nr{constructor(e,t,n,i){super(e,t,i),this.messageType=u.Go.QueryAwareness,this.typeName="QueryAwareness"}}class nd extends nr{constructor(e,t,n,i){super(e,t,i),this.messageType=u.Go.Stateless,this.typeName="Stateless"}}class nc extends nr{constructor(e,t,n,i){super(e,t,i),this.messageType=u.Go.CLOSE,this.typeName="Close"}}class nu extends nr{getPayload(){return{saved:this.saved}}constructor(e,t,n,i){super(e,t,i),this.messageType=u.Go.SyncStatus,this.typeName="SyncStatus",this.saved=1===(0,t5.cw)(n)}}let np=()=>{let e=(0,h.useRef)(null);return{onTransaction:(0,h.useCallback)(t=>{e.current=t},[]),getTransaction:(0,h.useCallback)(()=>{let t=e.current;return e.current=null,t},[])}};class nh{onMessage(e){e.messageType!==u.Go.Awareness&&(this.buffer.push(e),this.buffer.length>this.bufferSize&&this.buffer.shift())}getMessages(){return this.buffer}flushMessages(){let e=this.buffer;return this.buffer=[],e}constructor(e=50){this.bufferSize=e,this.buffer=[]}}var nm=n(50333),ng=n.n(nm);let nx=e=>{let[t,n]=(0,h.useState)([]);return{logMessages:t,logPerfMessage:(0,h.useCallback)(t=>{if(!e)return;let i=performance.now(),r={msg:t,timestamp:i};n(e=>0===e.length?[...e,r]:e.find(e=>e.msg===t)||e[e.length-1].msg===t?e:(r.duration=ng()(i-e[e.length-1].timestamp,2),[...e,r]))},[e]),dumpLog:(0,h.useCallback)(()=>{e&&n(e=>{try{console.table(e)}catch(e){}return[]})},[e])}};var nf=n(80314),ny=n(46898),nv=n(99038),nb=n(37605);let nj="not-connecting-toast",nw=()=>{let e="dev"===x.$.APPLICATION_ENVIRONMENT||"staging"===x.$.APPLICATION_ENVIRONMENT;return(0,r.jsx)(v.s,{direction:"column",p:4,color:"white",bg:"yellow.500",borderRadius:"md",children:(0,r.jsxs)(v.s,{alignItems:"center",children:[(0,r.jsx)(s.y,{mr:4}),(0,r.jsxs)(o.a,{ml:3,children:[(0,r.jsx)(d.E,{lineHeight:6,fontSize:"sm",fontWeight:"bold",children:(0,r.jsx)(I.x6,{id:"9tGBiL",values:{GAMMA_ARTIFACT_PROPER_NOUN:nv.TP}})}),(0,r.jsx)(d.E,{lineHeight:6,fontSize:"sm",children:(0,r.jsx)(I.x6,{id:"xpqx+T"})}),e&&(0,r.jsx)(b.z,{children:(0,r.jsxs)(nf.N,{href:"https://github.com/gamma-app/gamma/blob/main/packages/client/src/modules/tiptap_editor/CollaborativeEditor/DEBUG_NOT_CONNECTING_TOAST.md",color:"deepocean.500",children:[(0,r.jsx)(tq.E,{colorScheme:"orange",fontSize:"xxs",me:1,children:"Gamma Only"}),"Debug Developer Connection Issues"]})})]})]})})},nC=e=>{let{enabled:t,docId:n}=e,i=(0,ny.d)(),r=(0,h.useRef)(null),o=(0,h.useCallback)(()=>{i.close(nj),r.current&&(clearTimeout(r.current),r.current=null)},[i]);return(0,h.useEffect)(()=>{if(t)return r.current=setTimeout(()=>{i.isActive(nj)||(i({render:nw,duration:null,id:nj}),tw.yf.logger.info("Editor slow load toast shown",{event:nb.ng.EDITOR_SLOW_LOAD,docId:n}))},15e3),()=>{r.current&&(clearTimeout(r.current),r.current=null)}},[n,t,i]),o};var nI=n(12733),nS=n(67604),nk=n(81141),nA=n(88586),nE=n(25991),n_=n(86497);let nR=e=>{let t=(0,nS.A)(e),n=new Date;return 4>=Math.abs((0,nk.A)(n,t))},nP=(e,t)=>{let[n,i]=(0,h.useState)(!1),r=(0,h.useRef)(null);(0,h.useEffect)(()=>{if(t){r.current&&clearTimeout(r.current),i(!1);return}return r.current=setTimeout(()=>{i(!0)},1e4),()=>{r.current&&clearTimeout(r.current)}},[t]);let o=(0,T.GV)(nE.TT)[e];if(!o)return!1;let l=o.lastSynced;return!!(l&&nR(l))||n},nT=(e,t)=>{let{isInOfflineMode:n}=(0,nA.utY)(),i=(0,n_.O)(),r=(0,T.GV)(nE.yy),o=nP(e,t);return n||(i||r)&&o};var nz=n(96500),nM=n(64268),nD=n(51504),nO=n(5221),nL=n(99745),nN=n(51684),nB=n(48621),nU=n(65905);let nF=()=>!!window.navigator&&!1===window.navigator.onLine,nW=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4,[t,n]=(0,h.useState)(nF),i=(0,h.useRef)(null);return(0,nU.LQ)("offline",()=>{i.current=setTimeout(()=>{n(!0)},e)}),(0,nU.LQ)("online",()=>{i.current&&(clearTimeout(i.current),i.current=null),n(!1)}),t};var nG=n(88608),nV=n(43607),nH=n(69138),nq=n(29238);let nK=async(e,t,n,i)=>{try{let{id:r,length:o}=n||{},l=await fetch("".concat(x.$.MULTIPLAYER_WS_URL.replace("wss","https"),"/").concat(e,"/verify/").concat(t),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:r,length:o,clientCount:null==i?void 0:i.clientCount,totalCount:null==i?void 0:i.totalCount})});return await l.json()}catch(e){}},nY=e=>{let t=e.document.store.clients.get(e.document.clientID);if(t&&t.length)return t[t.length-1]},nX=e=>({clientCount:e.document.store.clients.size,totalCount:[...e.document.store.clients.values()].reduce((e,t)=>e+t.reduce((e,t)=>e+t.length,0),0)}),nJ=async(e,t,n)=>{let i=nY(t),r=nX(t),o=await nK(e.gammaDocId,t.document.clientID,i,r);if(!o)return console.warn("[compareClocks] Failed to fetch remote clock"),!1;try{var l;let e=((null==i?void 0:i.id.clock)||0)+((null==i?void 0:i.length)||0),t=((null==o||null==(l=o.lastKnownItem.id)?void 0:l.clock)||0)+((null==o?void 0:o.lastKnownItem.length)||0),a=e-t;a>0&&console.warn("[compareClocks] Clock drift detected",{diffLastItem:a});let s=r.clientCount-(o.itemSummary.clientCount||0),d=r.totalCount-(o.itemSummary.totalCount||0);return s>0&&console.warn("[compareClocks] clientCount drift detected",{diffClientCount:s}),d>0&&console.warn("[compareClocks] totalCount drift detected",{diffTotalCount:d}),0===s&&d<=n&&a<=n}catch(e){console.warn("[compareClocks] Failed to fetch remote clock")}return!1},n$=e=>{let[t,n]=(0,h.useState)(null==e?void 0:e.status);return(0,h.useEffect)(()=>{if(!e)return;let t=e=>{let{status:t}=e;n(t)};return e.on("status",t),()=>{e.off("status",t)}},[e]),t},nZ=e=>{let{editor:t,yProvider:n,enabled:i}=e,r=(0,T.CU)(),[o,l]=(0,h.useState)(Date.now()),[a,s]=(0,h.useState)(0),d=n$(n),[c,u]=(0,h.useState)(i);(0,h.useEffect)(()=>{if(!i)return void u(!1);u(!1);let e=m.wg(()=>{u(!0)},5e3);return()=>{m.DJ(e)}},[i,d]);let p=(0,W.u)("dataSyncClockDriftTolerance"),g=(0,h.useCallback)(async()=>{if(!t||!n||!t.gammaDocId)return;let{online:e,backgrounded:i}=(0,nq.mN)(r.getState());e&&!i&&(await nJ(t,n,p)?(s(0),l(Date.now())):(s(e=>e+1),console.warn("[useDataPersistenceSync_2] Clocks out of sync for doc",t.gammaDocId)))},[p,t,r,n]),x=0===a?2e4:4e3;return(0,h.useEffect)(()=>{if(!t||!n||!c)return;let e=setInterval(()=>{g()},x);return()=>{e&&clearInterval(e)}},[t,n,c,x,p,g]),{errorCount:a,yDocLastSynced:o,checkDataInSync:g}},nQ="data-sync-error-toast",n0="data-sync-not-saved-toast",n1=(0,r.jsx)(nB.g,{icon:nN.lEd,size:"2x"}),n6=(0,r.jsx)(nB.g,{icon:nN.JAe,size:"2x"}),n2=e=>{let{type:t,yDocLastSynced:n}=e;return()=>(0,r.jsx)(v.s,{direction:"column",p:4,color:"white",bg:"warn"===t?"yellow.500":"red.500",borderRadius:"md",children:(0,r.jsxs)(v.s,{alignItems:"center",children:["warn"===t?n1:n6,(0,r.jsxs)(o.a,{ml:3,children:[(0,r.jsx)(d.E,{lineHeight:6,fontSize:"sm",fontWeight:"bold",children:"warn"===t?(0,r.jsx)(I.x6,{id:"BM8j3v",values:{GAMMA_PROPER_NOUN:nv.On}}):(0,r.jsx)(I.x6,{id:"DgKz0c",values:{GAMMA_PROPER_NOUN:nv.On}})}),n&&(0,r.jsx)(d.E,{lineHeight:6,fontSize:"sm",children:(0,r.jsx)(I.x6,{id:"VxWwaW",values:{0:(0,nG.Bo)(new Date(n).toISOString())}})}),"error"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(nz.c,{pt:2}),(0,r.jsx)(d.E,{lineHeight:6,fontSize:"sm",pt:2,children:(0,r.jsx)(I.x6,{id:"Pw5K5r"})})]})]})]})})},n5=e=>{let{onClose:t}=e;return(0,r.jsxs)(nM.F,{status:"info",colorScheme:"gray",alignItems:"start",borderRadius:"md",boxShadow:"lg",paddingEnd:8,textAlign:"start",width:"auto",children:[(0,r.jsx)(nD._,{}),(0,r.jsxs)(o.a,{flex:"1",maxWidth:"100%",children:[(0,r.jsx)(nO.X,{children:(0,r.jsx)(I.x6,{id:"BM8j3v",values:{GAMMA_PROPER_NOUN:nv.On}})}),(0,r.jsx)(nL.T,{display:"block",children:(0,r.jsx)(I.x6,{id:"I1QCnH"})})]}),(0,r.jsx)(w.J,{size:"sm",onClick:t,position:"absolute",insetEnd:1,top:1})]})},n4=e=>{let{enabled:t,errorCount:n,errorCountThreshold:i,isPresentModeAndNotEditing:r,background:o,offline:l}=e;return!t||r||o||l||-1===i?"ignored":n>2*i?"error":n>i?"warn":"ok"},n8=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3,[t,n]=(0,h.useState)(!0),i=(0,h.useRef)(null);return(0,nU.LQ)("foreground",t=>{let{timeInBackground:r}=t;if(null===r)return void n(!0);if(r>6e4){i.current=setTimeout(()=>{n(!0)},e);return}n(!0)}),(0,nU.LQ)("background",()=>{i.current&&(clearTimeout(i.current),i.current=null),n(!1)}),t},n3=e=>{let{offline:t,yDocLastSynced:n}=e,i=(0,ny.d)(),[o,l]=(0,h.useState)(!1),a=(0,n_.O)(),s=(0,T.GV)(nE.yy),d=(a||s)&&!t;return(0,h.useMemo)(()=>({warnOrError:e=>{if(d)return!i.isActive(n0)&&!o&&(i({id:n0,duration:null,render:e=>{let{onClose:t}=e;return n5({onClose:()=>{t(),l(!0)}})}}),!0);let t=n2({type:e,yDocLastSynced:n});return i.isActive(nQ)?(i.update(nQ,{render:t}),!1):(i({render:t,duration:null,id:nQ}),!0)},recovered:e=>!!(d?i.isActive(n0)||o:i.isActive(nQ))&&((i.isActive(nQ)||i.isActive(n0))&&i.closeAll(),"ignored"!==e&&(d&&(i({title:(0,r.jsx)(I.x6,{id:"flElqq",values:{GAMMA_PROPER_NOUN:nv.On}}),description:(0,r.jsx)(I.x6,{id:"Gm5OG1"}),status:"success",duration:5e3,id:"data-sync-saved-toast",isClosable:!0}),l(!1)),!0))}),[o,i,d,n])},n9=e=>{let{editor:t,yProvider:n,enabled:i}=e,r=(0,T.GV)(D.VJ),o=(0,nV.UT)("comment"),l=(0,T.GV)(D.jn),a=(0,e1.st)(),{user:s}=(0,q.ur)(),d=(0,h.useRef)(),c=(0,W.u)("dataSyncErrorThreshold"),{errorCount:u,yDocLastSynced:p}=nZ({editor:t,yProvider:n,enabled:i&&o}),m={docSavedTime:l,yDocLastSynced:p,errorCount:u,clientID:null==n?void 0:n.document.clientID,userId:null==s?void 0:s.id},g=(0,h.useRef)(m);g.current=m;let x=nW(),f=n8(),y=(0,h.useRef)();y.current={errorCount:u,enabled:i,errorCountThreshold:c,isPresentModeAndNotEditing:r,background:!f,offline:x};let v=n4(y.current),b=n3({offline:x,yDocLastSynced:p});return(0,nH.V)(()=>{if("ok"===v||"ignored"===v){if(!b.recovered(v))return;let e=d.current?new Date-d.current:void 0;null==a||a.trackDocEvent(e1.ng.DATA_SYNC_RECOVER,{...g.current,duration:e}),tw.yf.logger.info("Data sync recovered",{event:e1.ng.DATA_SYNC_RECOVER,docId:null==t?void 0:t.gammaDocId,errorStatusInput:y.current,docEventData:g.current}),d.current=void 0;return}b.warnOrError(v)&&(null==a||a.trackDocEvent(e1.ng.DATA_SYNC_ERROR,g.current),tw.yf.logger.info("Data sync error",{event:e1.ng.DATA_SYNC_ERROR,docId:null==t?void 0:t.gammaDocId,dataSyncErrorType:v,errorStatusInput:y.current,docEventData:g.current}),"error"===v&&tC.Cp("[useDataPersistenceSync] ERROR_THRESHOLD_EXCEEDED. docId: ".concat(null==t?void 0:t.gammaDocId)))},[a,null==t?void 0:t.gammaDocId,v,b],[v]),"error"===v},n7=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=(0,h.useRef)(0),i=(0,h.useRef)(0),[r,o]=(0,h.useState)(!1),[l,a]=(0,h.useState)(0),[s,d]=(0,h.useState)(document.hidden),c=(0,h.useRef)(()=>{n.current++,n.current>=t&&(console.warn("[useRateLimiter] Limit hit! (".concat(t," per ").concat(e/1e3,"s)")),r||(o(!0),a(e=>e+1))),i.current||(i.current=m.yb(()=>{n.current>0?n.current--:(o(!1),m.vG(i.current),i.current=0)},e/t))});return(0,h.useEffect)(()=>{let e=()=>{d(document.hidden),c.current()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),[c.current,r,l,s]};var ie=n(49611);let it=()=>(0,r.jsxs)(j.T,{align:"flex-end",borderRadius:"base",shadow:"lg",p:3,bg:"gray.50",spacing:4,maxW:"300px",direction:"row",children:[(0,r.jsxs)(o.a,{children:[(0,r.jsx)(d.E,{fontSize:"md",fontWeight:"bold",children:(0,r.jsx)(I.x6,{id:"8kh5VW",values:{GAMMA_PROPER_NOUN:nv.On}})}),(0,r.jsxs)(d.E,{fontSize:"sm",children:[(0,r.jsx)(I.x6,{id:"CDva2g"})," ",(0,r.jsx)("em",{children:(0,r.jsx)(I.x6,{id:"/vuJlA"})})," ","\uD83D\uDE0E"]})]}),(0,r.jsx)(o.a,{children:(0,r.jsx)(ie.$,{size:"sm",onClick:()=>{window.location.reload()},children:(0,r.jsx)(I.x6,{id:"HpK/8d"})})})]}),ii=e=>{let t=(0,ny.d)(),[n,i]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{if(!e)return;let t=()=>{let t=e.getMap("SCHEMA_VERSION").get("REQUIRED_VERSION"),n=!!(t&&t>tV.f$);i(n),console[n?"warn":"debug"]("[SchemaVerifier] onUpdate",{requiredVersion:t,MY_VERSION:tV.f$,outdated:n})};return e.on("update",t),()=>{e.off("update",t)}},[e]),(0,h.useEffect)(()=>{n&&!t.isActive("schema_outdated")&&t({id:"schema_outdated",duration:null,status:"warning",isClosable:!1,position:"bottom-left",render:it})},[n,t]),n},ir="staging"===x.$.APPLICATION_ENVIRONMENT&&x.$.API_HOST.endsWith("api-custom-backend.staging.gamma.app"),io=e=>({DOC_ID:e,SCHEMA_VERSION:String(tV.f$),SHARE_TOKEN:x.$.SHARE_TOKEN,...ir?{API_HOST:x.$.API_HOST}:{}}),il=(0,h.memo)(e=>{let{doc:t,docId:n,onCreate:i,readOnly:v=!1,scrollingParentSelector:b,hideForPreview:j=!1,animationsExtensionEnabled:w=!1}=e,[C]=(0,h.useState)(()=>performance.now()),{timeOnCreate:I,timeOnSetupProvider:S,timeOnDownloadDoc:k}=(0,V.n6)(),E=(0,z.rd)(),{isUserLoading:_}=(0,q.ur)(),[R,P]=(0,h.useState)(!1),O=(0,h.useRef)(!1);O.current=R;let[L,N]=(0,h.useState)(!1),[B,X]=(0,h.useState)(!1),J=(0,h.useRef)([]),[$,Z]=(0,h.useState)(),[Q,et]=(0,h.useState)(),[en,eo]=(0,h.useState)(),[el]=(0,h.useState)(()=>new nh),{onTransaction:ea,getTransaction:es}=np(),ed=(0,G.iJ)(),ec=(0,G.iO)(),{isConnected:eu}=(0,y.u)(),eh=nT(n,L),em=ii(Q);t2($,en);let eg=n9({editor:$,yProvider:en,enabled:L&&!v});(0,tG.Rf)($);let[ex,ef,eb,ej]=n7(),ew=t&&t.organization&&t.organization.id,eC=nC({docId:n,enabled:!L}),eI=(0,A.u)("debugLogging"),eS=(0,T.GV)(W.Gm),ek=(0,A.u)("waitForGammaPersistenceMeta"),eA=(0,T.jL)(),{logMessages:eE,logPerfMessage:e_,dumpLog:eR}=nx(eI);(0,K.C)((0,h.useCallback)(()=>{en&&(en.disconnect(),en.configuration.parameters=io(n),setTimeout(()=>en.connect(),500))},[en,n])),(0,f.A)(),(0,nI.W)($),(0,h.useEffect)(()=>{let e;if(!en)return;let t=eb>10;if(ef){console.warn("[CollaborativeEditor] Attempted to re-connect while rate limited (".concat(eb," of ").concat(10,").")),en.disconnect();return}if(t){console.error("[CollaborativeEditor - RECONNECT_RATE_LIMIT] Max rate limit violations reached (".concat(10,"). Will reload.")),setTimeout(()=>{window.location.reload()},500);return}if(O.current)return ej?(console.debug("[CollaborativeEditor] Backgrounded, will wait ".concat(12e4,"s before disconnect")),e=m.wg(()=>{console.debug("[CollaborativeEditor] Disconnecting after grace period"),en.disconnect()},12e4)):(console.debug("[CollaborativeEditor] Foregrounded, so re-connecting"),en.connect()),()=>{e&&m.DJ(e)}},[en,ej,ef,eb]),(0,h.useEffect)(()=>{$&&!$.isDestroyed&&ew&&($.commands.initializeUploadExtension(ew),$.commands.removeGeneratorInputsOnLoad())},[$,ew]),(0,h.useEffect)(()=>{Q&&n&&eh&&ed.loadYDoc(n,Q,()=>{console.debug("offlineMode - [ydocOfflineApi] YDoc loaded from indexeddb"),N(!0),P(!0)})},[eh,Q,n,ed]),(0,h.useEffect)(()=>{console.debug("[CollaborativeEditor] Creating yProvider for doc",n);let e=new g.JA({});e.getXmlFragment("default").observeDeep((e,t)=>{ea(t)}),et(e),e.getMap("GammaPersistenceMeta").observeDeep((t,n)=>{e.getMap("GammaPersistenceMeta").get("READY")&&(e_("Document data downloaded"),X(!0))}),e_("Setting up hocuspocus"),S();let t=new u.m({name:n,document:e,forceSyncInterval:15e3,token:io(n).SHARE_TOKEN||"null",websocketProvider:new u.nU({url:x.$.MULTIPLAYER_WS_URL,parameters:io(n)}),preserveConnection:!1,onOutgoingMessage(e){let{message:t}=e;try{let e=Math.floor(performance.now()-C),n=nr.fromOutgoingMessage(t,e);n.shouldAssociateTransaction()&&n.setTransaction(es()),el.onMessage(n)}catch(e){console.error("[CollaborativeEditor] Error processing outgoing message for debug",e)}},onMessage(e){let{message:t}=e;try{let e=Math.floor(performance.now()-C),n=nr.fromIncomingMessage(t.data,e);n.shouldAssociateTransaction()&&n.setTransaction(es()),el.onMessage(n)}catch(e){console.error("[CollaborativeEditor] Error processing incoming message for debug",e)}},onOpen(){if(!0===W.of.get("hocuspocusOnAuthenticate"))return void console.log("[CollaborativeEditor] Provider opened. onAuthenticate is enabled so this is a no-op.");t.isAuthenticated=!0,console.log("[CollaborativeEditor] Provider opened.  Setting isAuthenticated to true.")},onStatus(e){let{status:t}=e;console.debug("[CollaborativeEditor][onStatus]",{status:t}),"connected"===t?(e_("Hocuspocus connected"),P(!0),O.current=!0):"connecting"===t&&(e_("Hocuspocus connecting"),ex())},onSynced(){console.debug("[CollaborativeEditor] Provider synced"),N(!0),eC(),e_("Document data downloaded"),ed.syncYDoc(n,e)},onDisconnect(e){let{event:n}=e;n.code===c.hR.code?console.error('[CollaborativeEditor] Provider disconnected with "Unauthorized.code", which is unexpected.',n):1008===n.code&&(t.disconnect(),M.LF.emit(M.DN.Y_DOC_IS_TOO_LARGE,{}),console.error("[CollaborativeEditor][onDisconnect] Document is too large, disconnecting"))}});return t.subscribeToBroadcastChannel(),eo(t),eA((0,D.gS)({hocuspocusProvider:t})),x.$.DEBUG_ENABLED&&(window.gammaEditorProvider=t),J.current=[...w?[ev.Q]:[],tO.EX,tU,tG.Li.configure({scrollerSelector:b}),te.configure({document:e}),tn,ee.configure({provider:t}),ty.configure({provider:t}),eH.configure({document:e}),e$,eQ,eK.configure(),ep,tT.bY,tD,tW.V,ei.configure({document:e}),ey,tN.c,tj.mk,tL.Q8,t_.wg,tF.bU,p.o5.configure({openDoubleQuote:!1,closeDoubleQuote:!1,openSingleQuote:!1,closeSingleQuote:!1}),tb.configure({scrollerSelector:b}),er.j,e8,e2,tP,H.o.configure({document:e}),tE.configure({startTime:C,messageLogger:el,provider:t})],()=>{console.warn("[CollaborativeEditor] Destroying yProvider for doc ",n),t.disconnect(),t.destroy(),delete window.gammaEditorProvider,eo(void 0),N(!1),P(!1),X(!1),setTimeout(()=>{if(t&&t.awareness)try{t.awareness.destroy()}catch(e){console.warn("[CollaborativeEditor] Error destroying awareness provider.")}})}},[]);let eP=!!(R&&L&&(!ek||B)&&t&&!_);(0,h.useEffect)(()=>{eP&&(e_("Is ready for TipTap"),k())},[eP,k,e_]),U();let eT=(0,F.K)();return(0,r.jsxs)(o.a,{display:j?"none":"block",w:"100%","data-testid":"collaborative-editor-wrapper",children:[eP&&eS&&(0,r.jsx)(tJ,{editor:$}),!$&&(0,r.jsx)(o.a,{flexDirection:"column",flex:"1",w:"100%",h:"var(--100vh)",bg:E?"gray.800":"gray.50",zIndex:"overlay","data-testid":"collaborative-editor-skeleton",inset:0,children:(0,r.jsx)(l.o,{h:"100%",children:(0,r.jsxs)(a.B,{align:"center",children:[(0,r.jsx)(s.y,{}),eE.map((e,t)=>{let{msg:n}=e;return(0,r.jsx)(d.E,{children:n},t)})]})})}),eP&&(0,r.jsx)(Y.b,{extensions:J.current,doc:t,docId:n,editorId:"main",onCreate:e=>{let{editor:t}=e;setTimeout(()=>{Z(t),i&&i(t),requestAnimationFrame(()=>{eu&&ec(n),eT(t),e_("Editor rendered"),I(),eR()})},10)},readOnly:em||v||!eh&&eg,shouldSupportComments:!0,shouldSupportMenus:!0,scrollingParentSelector:b})]})});var ia=n(87386),is=n(82059);let id=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{docFlags:{}};return(0,ia.createDocWithCards)(t,[{type:"card",content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"title",attrs:{level:is.f.DefaultTitle}},{type:"contributors"}]}]},{type:"card",content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading"}]}]}])},ic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ia.createDocWithCards)(e,[{type:"card",content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"title",attrs:{level:is.f.DefaultTitle}}]}]}])},iu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{docFlags:{}};return{type:"doc",content:[{type:"document",attrs:t,content:[{type:"card",content:[{type:"title",attrs:{level:is.f.DefaultTitle}},{type:"contributors"}]},{type:"card",attrs:{previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"blank"},content:[{type:"heading",attrs:{horizontalAlign:null,level:2},content:[{type:"text",text:"Quick Start Checklist"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"zap",native:""}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Type "},{type:"text",marks:[{type:"code"}],text:"/"},{type:"text",marks:[{type:"bold"}],text:" in a card to open the slash menu"}]},{type:"bullet",attrs:{indent:1,fontSize:null},content:[{type:"text",text:"It lets you browse and add content blocks quickly"}]},{type:"bullet",attrs:{indent:1,fontSize:null},content:[{type:"text",text:"Content blocks can be added from the "},{type:"text",marks:[{type:"footnoteLabel",attrs:{noteId:"7jZEg"}}],text:"insert menu"},{type:"footnote",attrs:{noteId:"7jZEg"},content:[{type:"image",attrs:{id:"Y3FmX",horizontalAlign:null,src:"https://cdn.gamma.app/zc87vhr30n8uf3n/b98e59519a994c7abd900f44683bbb5d/optimized/insert-menu-explainer.gif",tempUrl:"blob:https://gamma.app/983566b4-f21e-4d28-bc69-d448c1976833",uploadStatus:0,meta:{width:700,height:459,date_file_modified:"2023/01/20 23:08:42 GMT",duration:4.42,aspect_ratio:1.525,has_clipping_path:!1,frame_count:36,colorspace:"RGB",average_color:"#f7f5f5"},providerMeta:null,name:"insert-menu-explainer.gif",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null}}}]},{type:"text",text:" if you prefer to drag"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"heavy_plus_sign",native:""}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Add a new card"},{type:"text",text:" (type "},{type:"text",marks:[{type:"code"}],text:"/card"},{type:"text",text:") or select a template via the "},{type:"text",marks:[{type:"footnoteLabel",attrs:{noteId:"xLt8J"}}],text:"plus button"},{type:"footnote",attrs:{noteId:"xLt8J"},content:[{type:"image",attrs:{id:"3CSXR",horizontalAlign:null,src:"https://cdn.gamma.app/zc87vhr30n8uf3n/a8d6b7149f75401ebd54e6b022670a3e/optimized/image.png",tempUrl:"blob:https://gamma.app/5368f25a-cf30-4410-bf62-bd26080b01f5",uploadStatus:0,meta:{width:844,height:608,date_file_modified:"2023/01/20 21:38:09 GMT",aspect_ratio:1.388,has_clipping_path:!1,frame_count:1,colorspace:"RGB",average_color:"#f7f5f5"},providerMeta:null,name:"image.png",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null}}}]}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"newspaper",native:"\uD83D\uDCF0"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Create multi-column layouts"},{type:"text",text:" (type "},{type:"text",marks:[{type:"code"}],text:"/columns"},{type:"text",text:") or "},{type:"text",marks:[{type:"footnoteLabel",attrs:{noteId:"JyryA"}}],text:"drag blocks"},{type:"footnote",attrs:{noteId:"JyryA"},content:[{type:"image",attrs:{id:"iJXTh",horizontalAlign:null,src:"https://cdn.gamma.app/zc87vhr30n8uf3n/3e47c137ba5d4d13bdafda584b3a8f94/optimized/drag-columns-optimized.gif",tempUrl:"blob:https://gamma.app/654cd2e0-6972-4a24-a7c0-25eff0cf9050",uploadStatus:0,meta:{width:500,height:313,date_file_modified:"2023/01/20 21:35:04 GMT",duration:9.83,aspect_ratio:1.597,has_clipping_path:!1,frame_count:62,colorspace:"RGB",average_color:"#e8cac5"},providerMeta:null,name:"drag-columns-optimized.gif",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null}}}]},{type:"text",text:" side by side"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"bridge_at_night",native:"\uD83C\uDF09"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Add an image "},{type:"text",text:"(type "},{type:"text",marks:[{type:"code"}],text:"/image"},{type:"text",text:"). You can drag in or paste image files too!"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"art",native:"\uD83C\uDFA8"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Change the deck "},{type:"text",marks:[{type:"bold"},{type:"footnoteLabel",attrs:{noteId:"mTOBc"}}],text:"theme"},{type:"footnote",attrs:{noteId:"mTOBc"},content:[{type:"paragraph",attrs:{horizontalAlign:null,fontSize:null},content:[{type:"text",text:"Click the "},{type:"text",marks:[{type:"code"}],text:"Theme"},{type:"text",text:" button in the top toolbar, then try clicking some of the different options"}]},{type:"image",attrs:{id:"GHNdu",horizontalAlign:"center",src:"https://cdn.gamma.app/zc87vhr30n8uf3n/db839cee72b7497b9ff1424987641ed5/optimized/image.png",tempUrl:null,uploadStatus:0,meta:{width:806,height:1678,date_file_modified:"2022/08/01 23:13:09 GMT",aspect_ratio:.48,has_clipping_path:!1,frame_count:1,colorspace:"RGB",average_color:"#ccc7ca"},providerMeta:null,name:"image.png",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:"inset",clipPath:["17.31441903150651%","0%","41.5572854690296%","0%"],clipAspectRatio:1.1678975712005124,width:209.77777777777777}}}]},{type:"text",text:" to give it a different look and feel"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"arrow_forward",native:""}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Try present mode"},{type:"text",text:" and use your arrow keys and "},{type:"text",marks:[{type:"footnoteLabel",attrs:{noteId:"UGnAU"}}],text:"spotlight"},{type:"footnote",attrs:{noteId:"UGnAU"},content:[{type:"paragraph",attrs:{horizontalAlign:null,fontSize:null},content:[{type:"text",text:"Spotlight lets you"},{type:"text",marks:[{type:"bold"}],text:" focus "},{type:"text",text:"on"},{type:"text",marks:[{type:"bold"}],text:" one piece of content at a time. "},{type:"text",text:"While presenting, press "},{type:"text",marks:[{type:"code"}],text:"s"},{type:"text",text:" to enter spotlight mode."}]},{type:"image",attrs:{id:"YOFhU",horizontalAlign:null,src:"https://cdn.gamma.app/zc87vhr30n8uf3n/ed0b362f6c2f4a438cd3188ba7697a02/optimized/spotlight-compressed.gif",tempUrl:"blob:https://gamma.app/d2eaae7f-515e-4e06-b396-4b0551a5a999",uploadStatus:0,meta:{width:1200,height:750,date_file_modified:"2023/01/13 21:48:00 GMT",duration:6.66,aspect_ratio:1.6,has_clipping_path:!1,frame_count:34,colorspace:"RGB",average_color:"#323030"},providerMeta:null,name:"spotlight-compressed.gif",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null}}}]},{type:"text",text:" to move around"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"tada",native:"\uD83C\uDF89"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Share your deck"},{type:"text",text:"."},{type:"text",marks:[{type:"bold"}],text:" "},{type:"text",text:"Publish it to the world, invite others, or export a PDF"}]}]}]}]}};var ip=n(74127)},34647:(e,t,n)=>{"use strict";n.d(t,{B:()=>o,S:()=>r});var i=n(50488);let r=()=>"indexedDB"in window&&"localStorage"in window&&i.P,o=()=>"undefined"!=typeof navigator&&"serviceWorker"in navigator&&r()},38055:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});let i="tour"},41215:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(55729),r=n(73110),o=n(5061);let l=()=>{let e=(0,r.O)();(0,i.useEffect)(()=>{let t=(0,o.D8)(e);document.documentElement.setAttribute("lang",e),document.documentElement.setAttribute("dir",t?"rtl":"ltr")},[e])}},41471:(e,t,n)=>{"use strict";n.d(t,{A:()=>_,L:()=>A});var i=n(6029),r=n(49611),o=n(67909),l=n(36071),a=n(54731),s=n(17920),d=n(26420),c=n(3674),u=n(40691),p=n(26385),h=n(58959),m=n(48810),g=n(2241),x=n(36218),f=n(16426),y=n(81107),v=n(48621),b=n(91106),j=n(19564),w=n(77650),C=n(55729),I=n(60120),S=n(11916),k=n(91792);let A={linkedin:{label:"LinkedIn",cta:()=>w.Ru._({id:"Ck0vYl"}),exportFormat:"pdf",localizedCTA:(0,i.jsx)(j.x6,{id:"Ck0vYl"}),inProgressLabel:(0,i.jsx)(j.x6,{id:"iPHeYN"}),icon:y.IAJ,iconColor:"linkedin.700",maxLength:3e3,thingsToNote:(0,i.jsx)(j.x6,{id:"N/TitX"})}},E=e=>{let{socialPlatform:t,doc:n,message:o,cardRangesInput:l,modalClose:a}=e,{handleExport:s,exportInProgress:d}=(0,S.Up)({doc:n,source:"share_panel",format:A[t].exportFormat,formatLabel:A[t].label,cardRanges:l,socialPlatform:t,socialPost:!0,shareMessage:o});return(0,i.jsxs)(r.$,{w:"100%",variant:"solid",onClick:()=>{s(),setTimeout(()=>{a()},2e3)},isDisabled:d,children:[d&&A[t].inProgressLabel,!d&&A[t].localizedCTA]})},_=e=>{let{socialPlatform:t,isSocialPostModalOpen:n,onSocialPostModalClose:y,cardRangesInput:S,doc:_}=e,[R,P]=(0,C.useState)(""),T=(0,k.rd)(),z=(0,C.useCallback)(e=>{P(e.target.value.substring(0,A[t].maxLength))},[t]),M=_.title;return(0,i.jsx)(b.L8,{isDark:T,children:(0,i.jsxs)(o.aF,{isOpen:n,onClose:y,trapFocus:!0,returnFocusOnClose:!1,size:"xl",children:[(0,i.jsx)(l.m,{}),(0,i.jsxs)(a.$,{children:[(0,i.jsxs)(s.r,{children:[(0,i.jsx)(d.a,{display:"inline-block",me:"2.5",color:A[t].iconColor,children:(0,i.jsx)(v.g,{icon:A[t].icon,size:"lg"})})," ",A[t].localizedCTA]}),(0,i.jsx)(c.s,{}),(0,i.jsx)(u.c,{children:(0,i.jsxs)(p.B,{spacing:2,width:"100%",children:[(0,i.jsxs)(h.z,{alignItems:"center",justifyContent:"space-between",children:[(0,i.jsxs)(m.E,{flex:"1",noOfLines:1,children:[(0,i.jsx)(j.x6,{id:"sNsWEI",values:{docTitle:M}}),S&&(0,i.jsxs)(g.B.span,{color:"gray.600",children:[" ",(0,i.jsx)(j.x6,{id:"gFo4O3",values:{cardRangesInput:S}})]})]}),(0,i.jsx)(I.H,{length:R.length||0,maxLength:A[t].maxLength})]}),(0,i.jsx)(x.T,{height:"10em",placeholder:w.Ru._({id:"p4W7fL"}),value:R,onChange:z}),A[t].thingsToNote&&(0,i.jsx)(m.E,{fontSize:"sm",color:"gray.500",children:A[t].thingsToNote})]})}),(0,i.jsx)(f.j,{pb:"5",children:(0,i.jsx)(r.$,{w:"100%",variant:"solid",children:(0,i.jsx)(E,{doc:_,socialPlatform:t,message:R,cardRangesInput:S,modalClose:y})})})]})]})})}},43728:(e,t,n)=>{"use strict";n.d(t,{FM:()=>p,Ts:()=>i.T});var i=n(50472),r=n(6029),o=n(91938),l=n(15342),a=n(29608),s=n(11403),d=n(85732),c=n(37377);let u="\n(function(){var w=window;var ic=w.Intercom;if(typeof ic===\"function\"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/".concat(o.$.INTERCOM_APP_ID,"';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();\n"),p=()=>{let e=!(0,a.rA)()&&!(0,d.NF)();(0,s.WM)(e,u);let t=(0,l.GV)(c.w8);return(0,s.En)()&&e?(0,r.jsx)("style",{children:"\n       #intercom-container > div {\n         display: ".concat(t?"block":"none"," !important;\n       }\n       div.intercom-app .intercom-borderless-frame,\n       div.intercom-app .intercom-messenger-frame  {\n         transform: translateY(calc(").concat(t?"0px":"100% + 20px",")) !important;\n       }\n     ")}):null}},48561:(e,t,n)=>{"use strict";n.d(t,{F$:()=>ez,ef:()=>eM,qk:()=>eD,_Z:()=>eF,li:()=>nt,_j:()=>ni});var i=n(6029),r=n(90394),o=n(46898),l=n(67909),a=n(36071),s=n(54731),d=n(17920),c=n(26420),u=n(3674),p=n(96500),h=n(40691),m=n(26385),g=n(41781),x=n(29810),f=n(49611),y=n(16426),v=n(40452),b=n(99492),j=n(48621),w=n(91106),C=n(19564),I=n(55729),S=n(7761),k=n(82328),A=n(68301),E=n(22445),_=n(39892),R=n(46091),P=n(20715),T=n(24729),z=n(72737),M=n(96804),D=n(44141),O=n(91792),L=n(82927),N=n(2942),B=n(29608),U=n(70006),F=n(48810),W=n(17496),G=(n(77364),n(23293)),V=n(64268),H=n(51504),q=n(96990),K=n(58297),Y=(n(51684),n(77650)),X=n(38822),J=n.n(X),$=n(88586),Z=n(99038),Q=n(75748),ee=n(11403),et=n(6807),en=n(65148),ei=n(58959),er=n(80314),eo=n(18351);let el=e=>{let{icon:t,showDisabled:n=!1,size:r=8}=e;return(0,i.jsx)(K.j,{color:"gray.700",textAlign:"center",bg:"gray.200",size:r,opacity:n?.5:1,children:n?(0,i.jsxs)("span",{className:"fa-stack",children:[(0,i.jsx)(j.g,{icon:b.$Dv,className:"fa-stack-1x"}),(0,i.jsx)(j.g,{icon:t,className:"fa-stack-1x"})]}):(0,i.jsx)(j.g,{size:"1x",icon:t})})},ea=e=>{let{channel:t,doc:n,isDisabled:r,showDisabledIcon:o=!1}=e,{removeDocChannel:l}=(0,eo.k)(),a=(0,I.useCallback)(()=>{n&&l(n,t.id)},[t.id,n,l]),s=(0,U.gU)({slug:t.slug,id:t.id});return(0,i.jsxs)(ei.z,{py:2,w:"100%",justify:"space-between","data-testid":"workspace-row-".concat(t.id),children:[(0,i.jsx)(c.a,{children:(0,i.jsxs)(v.s,{alignItems:"center",children:[(0,i.jsx)(el,{icon:T.$Q,showDisabled:o}),(0,i.jsx)(c.a,{ml:3,opacity:o?.5:1,children:(0,i.jsx)(er.N,{href:s,target:"_blank",children:t.name})})]})}),(0,i.jsx)(f.$,{size:"sm",variant:"hazardous",onClick:a,isDisabled:r,children:(0,i.jsx)(C.x6,{id:"t/YqKh"})})]},t.id)};var es=n(78686),ed=n(24302),ec=n(61204),eu=n(72470),ep=n(3276),eh=n(77979),em=n(40913),eg=n(24351);let ex=e=>{let{workspaceId:t,docId:n,existingChannels:r,isDisabled:o}=e,l=(0,I.useRef)(null),[a,s]=(0,I.useState)(""),[d,u]=(0,I.useState)([]),[p,h]=(0,I.useState)(!1),{addDocChannel:g}=(0,eo.k)(),{data:x,loading:f}=(0,$.FKb)({variables:{query:a,workspaceId:t},skip:!a});(0,I.useEffect)(()=>{if(f||!x)return;let e=x.search.filter(Boolean);u(e),h(0===e.length)},[x,f]);let y=(0,I.useMemo)(()=>a?d.filter(e=>!r.find(t=>t.id===e.id)):[],[r,a,d]),b=(0,I.useCallback)(e=>{let t=y.find(t=>t.id===e);if(!t)return void console.error("[ChannelSearchBar.addSelectedChannel] No matching channel found");g({docId:n,channel:t,existingChannels:r})},[g,n,r,y]),S=(0,ed.dU)("gray.50","gray.600"),k=(0,ed.dU)("light","dark"),A=(0,ed.dU)("trueblue.50","whiteAlpha.100");return(0,i.jsx)(ec.e,{w:"100%",mb:2,alignItems:"flex-start","data-testid":"sharepanel-channel-search-bar",children:(0,i.jsx)(c.a,{flex:1,children:(0,i.jsxs)(eu.M,{w:"100%",justifyContent:"center",zIndex:1,children:[(0,i.jsx)(v.s,{display:"none",position:"absolute",h:"100%",w:"100%",alignItems:"center",justifyContent:"center",bg:S,zIndex:"overlay",opacity:.4,children:(0,i.jsx)(ep.y,{})}),(0,i.jsxs)(em.j9,{rollNavigation:!0,multiple:!0,emptyState:()=>!!p&&(0,i.jsx)(v.s,{direction:"column",justify:"center",align:"center",w:"100%",my:6,children:(0,i.jsx)(c.a,{w:"80%",maxW:"200px",mb:6,alignContent:"center",children:(0,i.jsx)(eg.p,{size:"sm",title:(0,i.jsx)(C.x6,{id:"aywdyd"}),description:(0,i.jsx)(C.x6,{id:"kXnLEt"})})})}),suggestWhenEmpty:!1,openOnFocus:!0,filter:()=>!0,onSelectOption:e=>{let{item:t}=e;b(t.value),s("")},children:[(0,i.jsxs)(eh.W,{pointerEvents:"none",color:(0,ed.dU)("gray.300","gray.600"),h:"100%",flexDirection:"column",children:[(0,i.jsx)(v.s,{flex:1}),(0,i.jsx)(v.s,{h:10,py:4,alignItems:"center",children:(0,i.jsx)(es.W,{w:10})})]}),(0,i.jsx)(em.Rv,{ref:l,"data-testid":"autocomplete-channels-input",cursor:o?"not-allowed":void 0,disabled:o,w:"100%",paddingInlineStart:5,wrapStyles:{px:2},fontSize:"md",placeholder:Y.Ru._({id:"KmCmUJ"}),transition:"width 1s ease-in-out",value:a,onChange:e=>{let{target:t}=e,{value:n}=t;s(n),n||u([])}}),(0,i.jsx)(em.HN,{w:"100%",mt:0,display:a.length>0?"flex":"none","data-theme":k,children:y.length>0&&y.map(e=>{let{id:t,name:n,memberCount:r,isMember:o,members:l}=e;return(0,i.jsx)(em.qF,{"data-testid":"autocomplete-item-channel-".concat(t),value:{id:e.id},getValue:e=>e.id,align:"center",_focus:{bg:A},children:(0,i.jsxs)(ei.z,{spacing:4,p:0,flex:1,children:[(0,i.jsx)(c.a,{color:"gray.600",children:(0,i.jsx)(j.g,{icon:T.$Q})}),(0,i.jsxs)(m.B,{spacing:0,flex:"1",children:[(0,i.jsx)(F.E,{children:n}),(0,i.jsx)(F.E,{fontSize:"sm",color:"gray.400",children:o?(0,i.jsx)(C.x6,{id:"tWPlLK",values:{0:r||0}}):(0,i.jsx)(C.x6,{id:"pkIIls",values:{0:r||0}})})]}),(0,i.jsx)(w.KZ,{size:"xs",overflowTooltipLabel:Y.Ru._({id:"25VyZX"}),avatars:l||[],max:3,onClick:e=>{e.preventDefault(),e.stopPropagation()}})]})},t)})})]})]})})})};var ef=n(27229),ey=n(1139),ev=n(66897),eb=n(18833),ej=n(36216);let ew=e=>{let{invitationCount:t,isOpen:n,onClose:r,onSendInvitationsClick:o,onDiscardClick:c}=e;return n?(0,i.jsxs)(l.aF,{returnFocusOnClose:!1,onClose:r,closeOnOverlayClick:!0,isOpen:!0,isCentered:!0,children:[(0,i.jsx)(a.m,{}),(0,i.jsxs)(s.$,{children:[(0,i.jsx)(d.r,{children:(0,i.jsx)(C.x6,{id:"tW/kB6",values:{invitationCount:t}})}),(0,i.jsx)(u.s,{}),(0,i.jsx)(h.c,{children:(0,i.jsx)(F.E,{children:(0,i.jsx)(C.x6,{id:"qxNK2k",values:{invitationCount:t}})})}),(0,i.jsx)(y.j,{children:(0,i.jsxs)(m.B,{spacing:2,direction:"row",align:"center",children:[(0,i.jsx)(f.$,{onClick:c,children:(0,i.jsx)(C.x6,{id:"bzSI52"})}),(0,i.jsx)(f.$,{variant:"solid",onClick:o,children:(0,i.jsx)(C.x6,{id:"6dWGPZ",values:{invitationCount:t}})})]})})]})]}):null};var eC=n(95889),eI=n(75570),eS=n(43787),ek=n(78140),eA=n(36999),eE=n(41283),e_=n(37930),eR=n(48478),eP=n(6760),eT=n(85595),ez=function(e){return e.NoAccess="no_access",e}({});let eM={[$.aXG.Manage]:{title:()=>Y.Ru._({id:"DZfDCl"}),description:()=>Y.Ru._({id:"r59J7Q"}),longDescription:e=>e?Y.Ru._({id:"CoURkK",values:{orgName:e}}):Y.Ru._({id:"MZxW5I"})},[$.aXG.Edit]:{title:()=>Y.Ru._({id:"ePK91l"}),description:()=>Y.Ru._({id:"kuZsYI"}),longDescription:e=>e?Y.Ru._({id:"+9AXnp",values:{orgName:e}}):Y.Ru._({id:"NY9Lty"})},[$.aXG.Comment]:{title:()=>Y.Ru._({id:"NBdIgR"}),description:()=>Y.Ru._({id:"IwFh5+"}),longDescription:e=>e?Y.Ru._({id:"0wXxLJ",values:{orgName:e}}):Y.Ru._({id:"3F9J6L"})},[$.aXG.View]:{title:()=>Y.Ru._({id:"jpctdh"}),description:()=>Y.Ru._({id:"yzFEXd"}),longDescription:e=>e?Y.Ru._({id:"7jJ4tD",values:{orgName:e}}):Y.Ru._({id:"Cxivg8"})},no_access:{title:()=>Y.Ru._({id:"oPoLg+"}),description:()=>Y.Ru._({id:"Vcif8/"}),longDescription:()=>Y.Ru._({id:"Vcif8/"})}},eD=e=>{let{isDisabled:t,options:n,disabledOptions:r=[],selected:o,variant:l="ghost",onClick:a=()=>{},onRemove:s}=e;return(0,i.jsxs)(ek.W,{closeOnSelect:!0,isLazy:!0,children:[(0,i.jsx)(eA.I,{"data-testid":"permission-menu-value-".concat(o),as:f.$,display:"flex",size:"sm",isDisabled:t,variant:l,rightIcon:(0,i.jsx)(j.g,{icon:b.Jt$}),children:eM[o||"no_access"].title()}),(0,i.jsx)(eE.c,{textAlign:"start",zIndex:"overlay",children:(0,i.jsxs)(e_.i,{defaultValue:o,value:o,title:Y.Ru._({id:"9cDpsw"}),type:"radio",onChange:e=>{a(e)},children:[n.map(e=>{let t=r.find(t=>t.permission===e),n=t&&t.reason;return(0,i.jsx)(eR.k,{isDisabled:!!t,value:e,alignItems:"start",pt:3,children:(0,i.jsx)(w.Tz,{label:n,"aria-label":n,isDisabled:!t,placement:"top",children:(0,i.jsxs)(c.a,{children:[(0,i.jsx)(F.E,{mt:-1,children:eM[e].title()}),(0,i.jsx)(F.E,{fontSize:"sm",color:"gray.500",mt:1,children:eM[e].description()})]})},e)},e)}),s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eP.N,{}),(0,i.jsx)(eT.D,{color:"red.500",onClick:s,icon:(0,i.jsx)(j.g,{icon:b.yLS,fixedWidth:!0}),children:(0,i.jsx)(C.x6,{id:"t/YqKh"})})]})]})})]})};var eO=n(13006);let eL=(0,eb.P)(c.a),eN=(e,t,n)=>{if(!n)return e;let i=[...e],r=e.findIndex(e=>"email"in e&&e.email===n),o=t.find(e=>e.email===n);return -1!==r&&i.splice(r,1),[...i,o||{email:n}]},eB=(e,t)=>{let n=(0,eS.e7)(t.map(e=>"displayName"in e?e.displayName:e.email),3);return e===$.aXG.Manage?Y.Ru._({id:"4bKxWq",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}}):e===$.aXG.Edit?Y.Ru._({id:"3rbi6Y",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}}):e===$.aXG.Comment?Y.Ru._({id:"uGWY40",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}}):e===$.aXG.View?Y.Ru._({id:"p5IG6F",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}}):Y.Ru._({id:"Ai1TAT",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}})},eU=e=>{let{workspaceId:t,docId:n,user:r,existingDocCollaborators:l,existingInvitations:a,registerDoneFn:s,isDisabled:d}=e,u=(0,o.d)(),[p,h]=(0,I.useState)(!1),m=(0,I.useRef)(),g=(0,I.useRef)(null),[x,y]=(0,I.useState)(""),[S,k]=(0,I.useState)([]),[A,E]=(0,I.useState)($.aXG.Edit),[_,R]=(0,I.useState)(new eI.c),[P,T]=(0,I.useState)([]),z=P.filter(e=>"email"in e),M=(0,eC.st)(),D=l.map(e=>e.user),{isOpen:O,onOpen:L,onClose:N}=(0,ef.j)({id:"unsentInvitationsModalDisclosure"}),[B,{loading:U,error:W}]=(0,$.VXs)();(0,ee.KW)("Error inviting collaborators.",W);let G=(0,ej.t)($.HdQ),{data:V,loading:H}=(0,$.puH)({variables:{query:x,workspaceId:t},skip:!x});(0,I.useEffect)(()=>{!H&&V&&k(V.search.filter(Boolean))},[V,H]);let X=(0,I.useMemo)(()=>x?S.filter(e=>"User"===e.__typename&&e.id!==r.id&&!z.concat(D).find(t=>t.email===e.email)):[],[S,D,x,z,r.id]),J=!!x&&!X.find(e=>e.email===x),Z=A===$.aXG.Manage&&z.some(e=>!("__typename"in e&&"User"===e.__typename)),Q=P.concat({email:x}).filter(e=>!("email"in e)||(0,ev.t)(e.email||"")),et=!!P.length,en=!!Q.length;(0,I.useEffect)(()=>{s(()=>()=>(en?L():_.resolve(),_.promise))},[s,_,en,L]);let er=(0,I.useCallback)(async e=>{h(!0),T(t=>e.reduce((e,t)=>eN(e,X,t.trim()),t));let n=(await Promise.all(e.map(e=>G({workspaceId:t,query:e}).then(t=>{var n;return null==(n=t.data)?void 0:n.search.find(t=>"User"===t.__typename&&t.email===e)})))).filter(Boolean);T(t=>e.reduce((e,t)=>eN(e,n,t.trim()),t)),h(!1)},[X,G,t]),eo=(0,I.useCallback)(async()=>{if(0===z.length)return;let e=eN(z,X,x.trim()).filter(e=>"email"in e&&(0,ev.t)(e.email||"")),t=[...l,...e.map(e=>{if("id"in e)return{docId:n,user:e,guest:!1,permission:A,__typename:"DocCollaborator"}})].filter(e=>!!e),i=[...a,...e.map(e=>{if(!("id"in e))return{id:"temp",docTitle:"temp-title",invitedBy:r,docId:n,email:e.email,permission:A,__typename:"DocInvitation"}})].filter(e=>!!e);return B({variables:{docId:n,collaborators:e.map(e=>({..."id"in e?{userId:e.id}:{email:e.email},permission:A}))},update:(e,t)=>{let{data:i}=t;e.writeFragment({id:"Doc:".concat(n),fragment:$.rgw,data:null==i?void 0:i.addCollaborators})},optimisticResponse:{addCollaborators:{id:n,collaborators:t,invitations:i}}}).then(()=>{u({title:Y.Ru._({id:"Ka86rB",values:{0:e.length}}),description:eB(A,e),status:"success",duration:5e3,isClosable:!0,position:"top"}),null==M||M.track(eC.VV.DOC_COLLABORATOR_INVITED,{doc_id:n,source:"share-panel",number_of_invites_sent:e.length,permissions:A})})},[B,n,x,A,X,z,l,a,u,r,M]),el=(0,I.useCallback)(async()=>Promise.all([eo()]).then(()=>{var e;T([]),y(""),null==(e=m.current)||e.resetItems(!0),_.resolve(),R(new eI.c)}).catch(e=>{console.warn(e)}),[eo,_]),ea=d||U||p,eg=(0,ed.dU)("light","dark"),ex=(0,ed.dU)("trueblue.50","whiteAlpha.100"),eb=(0,ed.dU)("trueblue.100","whiteAlpha.200");return(0,i.jsxs)(ec.e,{w:"100%",mb:2,alignItems:"flex-start","data-testid":"sharepanel-search-bar",children:[(0,i.jsx)(c.a,{flex:1,children:(0,i.jsxs)(eu.M,{w:"100%",justifyContent:"center",zIndex:2,children:[(0,i.jsx)(v.s,{display:p?"flex":"none",position:"absolute",h:"100%",w:"100%",alignItems:"center",justifyContent:"center",zIndex:"overlay",opacity:.4,children:(0,i.jsx)(ep.y,{})}),(0,i.jsxs)(em.j9,{ref:m,values:P,maxSelections:100,maxSuggestions:20,creatable:!0,multiple:!0,freeSolo:!0,suggestWhenEmpty:!1,openOnFocus:!0,filter:(e,t)=>!z.find(e=>e.email===t),onSelectOption:e=>{let{item:t}=e,{type:n}=t.originalValue;"collaborator"===n&&T(e=>eN(e,X,t.value)),y("")},onTagRemoved:e=>{T(t=>[...t].filter(t=>"email"in t?t.email!==e:!("id"in t)||t.id!==e))},children:[(0,i.jsxs)(eh.W,{pointerEvents:"none",color:(0,ed.dU)("gray.300","gray.600"),h:"100%",flexDirection:"column",children:[(0,i.jsx)(v.s,{flex:1}),(0,i.jsx)(v.s,{h:10,py:4,alignItems:"center",children:(0,i.jsx)(es.W,{w:10})})]}),(0,i.jsx)(em.Rv,{ref:g,"data-testid":"autocomplete-collaborators-input",cursor:ea?"not-allowed":void 0,disabled:ea,w:"100%",paddingInlineStart:5,wrapStyles:{px:2},fontSize:"md",placeholder:Y.Ru._({id:"P8H57Z"}),transition:"width 1s ease-in-out",value:x,onKeyDown:e=>{let{key:t}=e;if("Backspace"===t&&0===x.length&&P.length>0){let e=P.slice(-1).pop();if(e){var n;null==(n=m.current)||n.removeItem("email"in e?e.email:e.id)}}},onPaste:e=>{e.preventDefault(),e.stopPropagation(),er(e.clipboardData.getData("Text").trim().split(/[,|;\s]+/)),y(""),k([])},onChange:e=>{let{target:t}=e,{value:n}=t;y(n),n||k([])},children:P.map((e,t)=>(0,i.jsx)(eO.w,{idx:t,selectedCollaborator:e,handleRemoveClick:()=>{var t;null==(t=m.current)||t.removeItem(e.email)}},"id"in e?e.id:e.email))}),(0,i.jsx)(em.HN,{w:"100%",mt:0,display:x.length>0?"flex":"none","data-theme":eg,children:X.map(e=>{let{id:t,email:n,displayName:r,profileImageUrl:o}=e;return(0,i.jsx)(em.qF,{fixed:!0,"data-testid":"autocomplete-item-user-".concat(t),value:{email:n,type:"collaborator"},getValue:e=>e.email,align:"center",_focus:{bg:ex},children:(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(q.e,{size:"sm",name:r,src:o}),(0,i.jsxs)(c.a,{children:[(0,i.jsx)(F.E,{textTransform:"capitalize",children:r}),(0,i.jsx)(F.E,{fontSize:"xs",color:"gray.500",children:null==n?void 0:n.toLowerCase()})]})]})},t)}).concat((0,i.jsx)(em.qF,{value:{email:x,type:"collaborator"},align:"center",display:J?"flex":"none",_focus:{bg:ex},children:(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(K.j,{bg:eb,size:8,children:(0,i.jsx)(j.g,{icon:b.y_8})}),(0,i.jsx)(F.E,{size:"md",children:x})]})},x))})]}),(0,i.jsx)(ey.z,{in:et,unmountOnExit:!0,children:(0,i.jsx)(eh.t,{w:"auto",justifyContent:"flex-end",pe:1,children:(0,i.jsx)(eD,{isDisabled:U,options:[$.aXG.Manage,$.aXG.Edit,$.aXG.Comment,$.aXG.View],variant:"ghost",selected:A,onClick:e=>E(e)})})})]})}),(0,i.jsx)(eL,{overflowX:"hidden",me:-2,transition:"slow",animate:{maxWidth:et?"200px":"0px"},children:(0,i.jsx)(w.Tz,{label:(0,i.jsx)(C.x6,{id:"Rxin92"}),"aria-label":Y.Ru._({id:"Rxin92"}),isDisabled:!Z,placement:"top",children:(0,i.jsx)(c.a,{children:(0,i.jsx)(f.$,{variant:"solid",onClick:el,isDisabled:!en||Z,isLoading:U,"data-testid":"add-selected-items",children:(0,i.jsx)(C.x6,{id:"m16xKo"})})})})}),(0,i.jsx)(w.L8,{isDark:!1,children:(0,i.jsx)(ew,{invitationCount:Q.length,onDiscardClick:()=>{N(),_.resolve(),R(new eI.c)},onSendInvitationsClick:()=>{N(),el()},onClose:()=>{N(),_.reject(),R(new eI.c)},isOpen:O})})]})},eF=e=>{let{title:t,subtitle:n,img:r,isDisabled:o=!1,disabledText:l,tooltipText:a,testId:s,infoIcon:d,permissionsControl:u,workspaceGuestInvite:p}=e,h="string"==typeof n?(0,i.jsx)(F.E,{fontSize:"xs",color:"gray.500",children:n}):n,m=(0,i.jsx)(w.Tz,{isDisabled:!a,label:a,placement:"top",children:(0,i.jsx)(c.a,{children:u})});return(0,i.jsxs)(ei.z,{w:"100%",justify:"space-between",py:2,"data-testid":"permission-settings-row".concat(s?"-"+s:""),children:[(0,i.jsx)(c.a,{children:(0,i.jsxs)(v.s,{alignItems:"center",children:[r,(0,i.jsxs)(c.a,{marginInlineStart:3,children:[(0,i.jsx)(F.E,{wordBreak:"break-word",noOfLines:1,children:t}),(0,i.jsxs)(v.s,{align:"center",children:[p&&p,h&&h]})]})]})}),(0,i.jsx)(c.a,{children:(0,i.jsx)(w.Tz,{isDisabled:!a,label:(0,i.jsx)(F.E,{children:a}),placement:"top",children:o?(0,i.jsx)(F.E,{size:"sm",color:"gray.500","data-testid":"permission-controls-disabled-".concat(s),children:l}):d?(0,i.jsxs)(ei.z,{children:[d,m]}):m})})]})};var eW=n(57405);let eG=e=>{let{children:t,showDivider:n=!0,isDark:r=!1,...o}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eW.T,{spacing:1,align:"stretch",py:4,...o,children:t}),n&&(0,i.jsx)(p.c,{borderColor:r?"gray.600":"gray.200"})]})};var eV=n(94740),eH=n(66199),eq=n(18078),eK=n(88136),eY=n(38676),eX=n(25311);let eJ=e=>{let{email:t,name:n,workspaceName:r,workspaceId:l}=e,[a]=(0,$.B74)(),[s,d]=(0,I.useState)(!1),c=(0,o.d)(),u=(0,ed.dU)(!1,!0),p=u?"gray.800":void 0,h=u?"white":void 0,m=u?"gray.600":void 0,g=u?"var(--chakra-colors-gray-600)":void 0;return(0,i.jsx)(eV.A,{closeOnBlur:!0,children:e=>{let{onClose:o}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eH.W,{children:(0,i.jsx)(f.$,{leftIcon:(0,i.jsx)(j.g,{icon:b.AQM}),size:"xs",colorScheme:"gray",mr:1,px:2,h:"auto",py:1,children:(0,i.jsx)(C.x6,{id:"O1wAlQ"})})}),(0,i.jsxs)(eq.h,{color:h,bgColor:p,borderColor:m,children:[(0,i.jsx)(eK.R,{bgColor:p,sx:g&&{"--popper-arrow-shadow-color":g}}),(0,i.jsx)(eY.D,{fontWeight:"bold",borderColor:m,children:(0,i.jsx)(C.x6,{id:"XYV7FR"})}),(0,i.jsxs)(eX.e,{children:[(0,i.jsx)(F.E,{fontSize:"sm",children:(0,i.jsx)(C.x6,{id:"hJZ5XP",values:{name:n,workspaceName:r,GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:Z.Ix}})}),(0,i.jsx)(f.$,{isDisabled:s,w:"100%",mt:2,onClick:()=>{l&&t&&(d(!0),a({variables:{workspaceId:l,invitees:[{email:t}]}}).then(()=>{c({title:Y.Ru._({id:"oNCcm2"}),status:"success",duration:5e3,isClosable:!0,position:"top"})}).catch(e=>{console.error(e),c({title:Y.Ru._({id:"h37zlR",values:{0:e.message}}),status:"error",isClosable:!0,position:"top"})}).finally(()=>{d(!1),o()}))},children:(0,i.jsx)(C.x6,{id:"qVqqmP"})})]})]})]})}})},e$=(e,t)=>{var n,i;let r="DocCollaborator"===e.__typename?null==(n=e.user.displayName)?void 0:n.toUpperCase():"DocInvitation"===e.__typename?e.email.toUpperCase():"",o="DocCollaborator"===t.__typename?null==(i=t.user.displayName)?void 0:i.toUpperCase():"DocInvitation"===t.__typename?t.email.toUpperCase():"";return!o||r&&r<o?-1:!r||o&&r>o?1:0},eZ=(e,t)=>{if(e.permission!==t.permission){if("manage"===e.permission)return -1;if("manage"===t.permission)return 1}return e$(e,t)},eQ=e=>{var t,n;let{workspaceId:r,isFromOtherOrg:l,doc:a,user:s,setVerifySearchDone:d,canManage:u,isDark:p=!1}=e,h=(0,o.d)(),[m,g]=(0,et.M)(en.E.hasDismissedDocWorkspaceNotice,!1),{isConnected:x}=(0,$.utY)(),[f,{error:y}]=(0,$.VXs)(),[w,{error:I}]=(0,$.AmA)();(0,ee.KW)("Error updating collaborator.",y),(0,ee.KW)("Error removing collaborator.",I);let[S]=(0,$.Ix6)(),k=u&&x,A=!l,E=(A&&!m&&a&&a.orgAccess,!!(!(null==a?void 0:a.orgAccess)&&(null==a?void 0:a.channels)&&(null==a?void 0:a.channels.length)>0&&(null==a?void 0:a.channels.every(e=>J()(e.permission))))),_=(0,z.vz)(a),R=(null==a?void 0:a.collaborators)||[],P=(null==a?void 0:a.invitations)||[],T=R.filter(e=>e.permission===$.aXG.Manage).length,M=[...R,...P].sort(eZ),D=e=>()=>{h({title:"updated"===e?Y.Ru._({id:"Xpw8aE"}):Y.Ru._({id:"jwO7L7"}),status:"success",duration:5e3,isClosable:!0,position:"top"})},O=a.orgAccess?a.orgAccess:ez.NoAccess,L=O!==ez.NoAccess;return(0,i.jsxs)(v.s,{direction:"column",maxH:"max(calc(100dvh - 390px), 500px)",children:[k&&(0,i.jsx)(eU,{workspaceId:r,docId:a.id,user:s,existingDocCollaborators:R,existingInvitations:P,registerDoneFn:d,isDisabled:!u}),(0,i.jsx)(Q.r,{description:(0,i.jsx)(C.x6,{id:"i5bpoc"}),isConnected:x,mb:4}),_&&(0,i.jsx)(F.E,{fontSize:"sm",pt:2,children:_}),(0,i.jsxs)(eG,{isDark:p,children:[!1,(0,i.jsx)(eF,{testId:"workspace",title:(0,i.jsx)(C.x6,{id:"wtxjAY"}),subtitle:L?eM[O].longDescription(null==a||null==(t=a.organization)?void 0:t.name):"",img:(0,i.jsx)(el,{icon:b.URI,showDisabled:!L}),isDisabled:!k,disabledText:eM[O].title(),permissionsControl:(0,i.jsx)(eD,{isDisabled:!k,selected:O,options:[$.aXG.Manage,$.aXG.Edit,$.aXG.Comment,$.aXG.View,ez.NoAccess],onClick:e=>{let t={id:a.id,orgAccess:e===ez.NoAccess?null:e};S({variables:t,optimisticResponse:{updateDoc:{...t,__typename:"Doc"}},refetchQueries:["GetDocs"]}).then(D(e===ez.NoAccess?"removed":"updated"))}})}),A&&(null==(n=a.channels)?void 0:n.map(e=>(0,i.jsx)(ea,{channel:e,doc:a,isDisabled:!x,showDisabledIcon:E},e.id))),!!a.orgAccess&&A&&!a.site&&!E&&(0,i.jsx)(c.a,{w:"100%",mt:2,children:(0,i.jsx)(ex,{existingChannels:a.channels,workspaceId:r,docId:a.id,isDisabled:!x})}),(0,i.jsx)(W.S,{in:A&&E,children:(0,i.jsxs)(V.F,{status:"warning",children:[(0,i.jsx)(H._,{}),(0,i.jsx)(C.x6,{id:"RZRM4l",values:{GAMMA_ARTIFACT_PROPER_NOUN:Z.TP}})]})})]}),M&&(0,i.jsx)(c.a,{overflowY:"auto",children:(0,i.jsx)(eG,{showDivider:!1,isDark:p,children:M.map(e=>{let t=e.permission===$.aXG.Manage&&T<2,n=!k||t,o=t?Y.Ru._({id:"0q0LJR"}):void 0,l=eM[e.permission].title();if("DocCollaborator"===e.__typename){var d;let t=e.user;return(0,i.jsx)(eF,{testId:t.email,title:"".concat(t.displayName," ").concat(t.id===s.id?Y.Ru._({id:"dDUgzP"}):""),img:(0,i.jsx)(q.e,{name:t.displayName,src:t.profileImageUrl,size:"sm"}),subtitle:n?void 0:t.email,isDisabled:n,disabledText:l,tooltipText:o,workspaceGuestInvite:!n&&e.guest?(0,i.jsx)(eJ,{name:t.displayName,workspaceName:null==(d=a.organization)?void 0:d.name,workspaceId:r,email:e.user.email}):void 0,permissionsControl:(0,i.jsx)(eD,{isDisabled:n,selected:e.permission,options:[$.aXG.Manage,$.aXG.Edit,$.aXG.Comment,$.aXG.View],disabledOptions:e.guest?[{permission:$.aXG.Manage,reason:Y.Ru._({id:"Rxin92"})}]:[],onClick:e=>{let n={docId:a.id,collaborators:[{userId:t.id,permission:e}]};f({variables:n,optimisticResponse:{addCollaborators:{id:n.docId,collaborators:R.map(n=>({...n,permission:n.user.id===t.id?e:n.permission})),invitations:P,__typename:"Doc"}}}).then(D("updated")).catch(()=>{})},onRemove:()=>{let e={docId:a.id,collaborators:[{userId:t.id}]};w({variables:e,optimisticResponse:{removeCollaborators:{id:e.docId,collaborators:R.filter(e=>e.user.id!==t.id),invitations:P,__typename:"Doc"}}}).then(D("removed"))}})},t.id)}return"DocInvitation"===e.__typename?(0,i.jsx)(eF,{testId:e.email,title:e.email,subtitle:Y.Ru._({id:"MActeE"}),img:(0,i.jsx)(K.j,{bg:"trueblue.50",size:8,children:(0,i.jsx)(j.g,{icon:b.y_8,size:"sm"})}),isDisabled:n,disabledText:l,permissionsControl:(0,i.jsx)(eD,{selected:e.permission,options:[$.aXG.Manage,$.aXG.Edit,$.aXG.Comment,$.aXG.View],disabledOptions:[{permission:$.aXG.Manage,reason:Y.Ru._({id:"Rxin92"})}],onClick:t=>{let n={docId:a.id,collaborators:[{email:e.email,permission:t}]};f({variables:n,optimisticResponse:{addCollaborators:{id:n.docId,invitations:P.map(n=>({...n,permission:n.email===e.email?t:n.permission})),collaborators:R,__typename:"Doc"}}}).then(D("updated")).catch(()=>{console.warn("Error updating permission")})},onRemove:()=>{let t={docId:a.id,collaborators:[{email:e.email}]};w({variables:t,optimisticResponse:{removeCollaborators:{id:t.docId,invitations:P.filter(t=>t.email!==e.email),collaborators:R,__typename:"Doc"}}}).then(D("removed"))}})},e.email):null})})})]})};var e0=n(36218);let e1="embed-copied-toast",e6=e=>{let{embedCode:t,isDisabled:n,docId:l}=e,a=(0,o.d)(),[s,d]=(0,I.useState)(!1),{hasCopied:c,onCopy:u}=(0,r.i)(t),p=(0,I.useRef)(null);(0,I.useEffect)(()=>{p.current&&s&&(p.current.focus(),p.current.select())},[s]);let h=(0,I.useCallback)(()=>d(!0),[]),m=(0,I.useCallback)(()=>d(!1),[]),g=(0,I.useCallback)(()=>{u(),a.isActive(e1)||a({id:e1,title:(0,i.jsx)(C.x6,{id:"ETv+Uw"}),status:"success",duration:5e3}),(0,P.d)({docId:l,source:"sharePanel",type:"embed"})},[l,u,a]);return(0,i.jsxs)(eW.T,{spacing:4,align:"stretch",children:[(0,i.jsx)(e0.T,{ref:p,rows:5,variant:"filled",fontFamily:"mono",colorScheme:"gray",disabled:n,onClick:h,onBlur:m,isReadOnly:!0,resize:"none",pointerEvents:n?"none":void 0,defaultValue:t}),(0,i.jsx)(f.$,{alignSelf:"flex-end",onClick:g,isDisabled:n,size:"sm",...n?{opacity:"1 !important",color:"gray.400",_hover:{opacity:"1"},_active:{boxShadow:"0 none"}}:{},children:c?(0,i.jsx)(C.x6,{id:"6V3Ea3"}):(0,i.jsx)(C.x6,{id:"Sx4kHi"})})]})};var e2=n(43183);let e5=e=>{let{doc:t,onSharePanelOpen:n,onSharePanelClose:r}=e,o=(0,I.useMemo)(()=>(0,U.Wp)({docId:t.id,docTitle:t.title}),[t.id,t.title]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F.E,{fontSize:"sm",pt:2,pb:2,children:(0,i.jsx)(C.x6,{id:"2QJhbq",values:{GAMMA_ARTIFACT_PROPER_NOUN:Z.TP}})}),(0,i.jsx)(c.a,{pb:4,children:(0,i.jsx)(e6,{embedCode:o,docId:t.id,isDisabled:!1})}),(0,i.jsx)(e2.w,{onClose:r,onOpen:n,segmentEvent:eC.VV.GAMMA_PRO_UPSELL_SHARE_SETTINGS_REMOVE_WATERMARK,doc:t})]})};var e4=n(5221),e8=n(99745),e3=n(83638),e9=n(38036),e7=n(5091),te=n(40162),tt=n(16491),tn=n(91938),ti=n(55597);let tr=e=>{let{title:t=(0,i.jsx)(C.x6,{id:"uKp64B"}),description:n=(0,i.jsx)(C.x6,{id:"iUGE+t"}),buttonLabel:r=(0,i.jsx)(C.x6,{id:"u5hSeG"}),completedMessage:o=(0,i.jsx)(C.x6,{id:"ZOLfB/"}),onClick:l}=e,[a,s]=(0,I.useState)(!1);return(0,i.jsx)(V.F,{colorScheme:"purple",children:(0,i.jsxs)(ei.z,{w:"100%",spacing:"4",children:[(0,i.jsxs)(m.B,{alignItems:"center",spacing:"0",children:[(0,i.jsx)(c.a,{color:"purple.500",children:(0,i.jsx)(j.g,{icon:ti.rIc,size:"lg"})}),(0,i.jsx)(F.E,{fontWeight:"bold",fontSize:"xs",color:"purple.600",children:(0,i.jsx)(C.x6,{id:"ICUIAA"})})]}),(0,i.jsxs)(m.B,{spacing:"0",w:"100%",children:[(0,i.jsx)(F.E,{fontWeight:"bold",fontSize:"sm",children:t}),(0,i.jsx)(F.E,{fontSize:"xs",children:n})]}),a?(0,i.jsxs)(ei.z,{spacing:"2",children:[(0,i.jsx)(j.g,{icon:ti.SGM}),(0,i.jsx)(F.E,{fontSize:"sm",fontWeight:"semibold",whiteSpace:"nowrap",children:o})]}):(0,i.jsx)(f.$,{size:"sm",variant:"plain",flexShrink:0,onClick:()=>{s(!0),l()},children:r})]})})};var to=n(37605),tl=n(11916),ta=n(17928),ts=n(97315),td=n(76373),tc=n(85455),tu=n(53932);let tp=e=>{let{doc:t,editor:n,onSharePanelOpen:r,onSharePanelClose:o,isMultipage:l=!1,cardRangesDefault:a=""}=e,s=t.title,d=(0,L.Iy)("edit",t),c=(0,tl.Is)(t),u=!!(n&&d),[p,h]=(0,I.useState)(a),[g,x]=(0,I.useState)(""),[y,v]=(0,I.useState)(""!==a?"custom":"all"),w=(0,A.u)("docShowcase"),S=(0,A.u)("export"),k=(0,A.u)("googleSlidesExport");return S?(0,i.jsx)(eW.T,{spacing:4,align:"start",pt:2,children:(0,i.jsxs)(tt.G_,{clientId:tn.$.GOOGLE_DRIVE_IMPORT_CLIENT_ID,children:[(0,i.jsx)(F.E,{fontSize:"sm",children:l?(0,i.jsx)(C.x6,{id:"WrniAy",values:{docTitle:s},components:{0:(0,i.jsx)("strong",{})}}):(0,i.jsx)(C.x6,{id:"qwhOQ/",values:{GAMMA_ARTIFACT_PROPER_NOUN:Z.TP}})}),(0,i.jsxs)(ei.z,{width:"100%",children:[(0,i.jsxs)(ek.W,{closeOnSelect:!0,children:[(0,i.jsxs)(eA.I,{size:"md",boxShadow:"none",textAlign:"start",alignSelf:"flex-start",flex:1,as:f.$,rightIcon:(0,i.jsx)(j.g,{icon:b.Jt$}),children:["all"===y&&(0,i.jsx)(C.x6,{id:"4upC5z"}),"custom"===y&&(0,i.jsx)(C.x6,{id:"ioxL7D"})]}),(0,i.jsx)(eE.c,{children:(0,i.jsxs)(e_.i,{defaultValue:y,value:y,type:"radio",onChange:e=>v(e),children:[(0,i.jsx)(eR.k,{value:"all",children:(0,i.jsx)(C.x6,{id:"4upC5z"})},"all"),(0,i.jsx)(eR.k,{value:"custom",children:(0,i.jsx)(C.x6,{id:"ioxL7D"})},"custom")]})})]}),(0,i.jsxs)(e3.MJ,{flex:1,isInvalid:!!g,children:["custom"===y&&(0,i.jsx)(e9.p,{id:"card-range",type:"text",value:p,onKeyUp:()=>{if(!p)return void x("");let e=p.match(/^\d+(?:-\d+)?(?:,\h*\d+(?:-\d+)?)*$/gm);e||x(Y.Ru._({id:"nmWMk6"})),g&&e&&x("")},onChange:e=>h(e.currentTarget.value),placeholder:Y.Ru._({id:"pHUJ/X"})}),(0,i.jsx)(W.S,{in:""!==g,children:(0,i.jsx)(e7.Wt,{children:g})})]})]}),(0,i.jsxs)(m.B,{spacing:2,width:"100%",children:[(0,i.jsx)(tm,{format:"pdf",label:"PDF",icon:tc.q.pdf.icon,accentColor:tc.q.pdf.accentColor,doc:t,editor:n,cardRanges:"custom"===y&&""!==p?p:void 0}),(0,i.jsx)(tm,{format:"pptx",label:"PowerPoint",icon:tc.q.pptx.icon,accentColor:tc.q.pptx.accentColor,doc:t,editor:n,cardRanges:"custom"===y&&""!==p?p:void 0}),k&&(0,i.jsx)(tm,{format:"google_slides",label:"Google Slides",icon:tc.q.google_slides.icon,accentColor:tc.q.google_slides.accentColor,doc:t,editor:n,cardRanges:"custom"===y&&""!==p?p:void 0,customLabel:Y.Ru._({id:"wj3Fyq"}),customInProgressMessage:Y.Ru._({id:"9ZkGtt"})}),(0,i.jsx)(tm,{format:"image",label:"PNG",icon:tc.q.png.icon,accentColor:tc.q.png.accentColor,doc:t,editor:n,cardRanges:"custom"===y&&""!==p?p:void 0,customLabel:Y.Ru._({id:"wAyz08"}),customInProgressMessage:Y.Ru._({id:"RSRVl9"})})]}),d&&(0,i.jsxs)(m.B,{children:[(0,i.jsx)(F.E,{fontSize:"sm",children:l?(0,i.jsx)(C.x6,{id:"ZQ1V5I"}):(0,i.jsx)(C.x6,{id:"If/5+e"})}),(0,i.jsx)(tu.O,{exportMode:y,cardRangesInput:p,doc:t})]}),(0,i.jsx)(th,{fontDownloadLinks:c,showPageSetupTip:u,onOpenPageSetup:()=>{o(),ta.LF.emit(ta.DN.OPEN_PAGE_SETUP,"cards")}}),(0,i.jsxs)(m.B,{w:"100%",children:[d&&(0,i.jsx)(e2.w,{onClose:o,onOpen:r,segmentEvent:to.VV.GAMMA_PRO_UPSELL_EXPORT_SETTINGS_REMOVE_WATERMARK,doc:t}),w&&(0,i.jsx)(tr,{title:(0,i.jsx)(C.x6,{id:"Dj23Em"}),description:(0,i.jsx)(C.x6,{id:"vmddJA",values:{GAMMA_PROPER_NOUN:Z.On}}),buttonLabel:(0,i.jsx)(C.x6,{id:"p9wZJA",values:{GAMMA_PROPER_NOUN:Z.On}}),onClick:()=>{null===eC.zS||void 0===eC.zS||eC.zS.track(to.VV.AI_DOC_SHOWCASE_ALLOWED,{doc_id:t.id})}})]})]})}):(0,i.jsxs)(V.F,{status:"warning",children:[(0,i.jsx)(e4.X,{children:(0,i.jsx)(C.x6,{id:"CfztD3"})}),(0,i.jsx)(e8.T,{children:(0,i.jsx)(C.x6,{id:"iKtv2V"})})]})},th=e=>{let{fontDownloadLinks:t,showPageSetupTip:n,onOpenPageSetup:r}=e,o=t.length>0;return o||n?(0,i.jsxs)(m.B,{spacing:2.5,w:"100%",children:[o&&(0,i.jsxs)(V.F,{variant:"subtle",colorScheme:"gray",children:[(0,i.jsx)(H._,{pt:"1",children:(0,i.jsx)(j.g,{icon:b.jrc,fixedWidth:!0})}),(0,i.jsxs)(m.B,{spacing:.5,children:[(0,i.jsx)(e4.X,{children:(0,i.jsx)(C.x6,{id:"UcLOKc"})}),(0,i.jsx)(F.E,{children:(0,i.jsx)(C.x6,{id:"izsdAT"})}),(0,i.jsx)(te.B,{spacing:"2",pt:"2",children:t.map(e=>{let{name:t,url:n}=e;return(0,i.jsx)(f.$,{size:"xs",onClick:n?()=>window.open(n,"_blank"):void 0,cursor:n?"pointer":void 0,leftIcon:n?(0,i.jsx)(j.g,{icon:b.a_I,size:"sm",fixedWidth:!0}):void 0,children:t},"".concat(t,"-").concat(null!=n?n:"no-url"))})})]})]}),(0,i.jsxs)(V.F,{variant:"subtle",colorScheme:"gray",children:[(0,i.jsx)(H._,{pt:"1",children:(0,i.jsx)(j.g,{icon:b.zpE,fixedWidth:!0})}),(0,i.jsxs)(m.B,{spacing:.5,children:[(0,i.jsx)(e4.X,{children:(0,i.jsx)(C.x6,{id:"6ME5PO"})}),(0,i.jsxs)(F.E,{children:[(0,i.jsx)(C.x6,{id:"OrqjGh"})," ",(0,i.jsx)(w.qT,{label:(0,i.jsx)(C.x6,{id:"Sis0Fm",values:{GAMMA_PROPER_NOUN:Z.On}})})]})]})]}),n&&(0,i.jsx)(F.E,{fontSize:"sm",children:(0,i.jsx)(C.x6,{id:"8LhjM/",components:{0:(0,i.jsx)(f.$,{variant:"link",fontSize:"inherit",cursor:"pointer",onClick:r})}})})]}):null},tm=e=>{let{format:t,doc:n,editor:r,icon:o,accentColor:l,label:a,badge:s,customLabel:d,customInProgressMessage:c,cardRanges:u}=e,p=(0,A.u)("googleSlidesExport"),{interceptFileExport:h}=(0,td.w)({doc:n,source:"share_panel",editor:r,cardRanges:u}),{handleExport:m,exportInProgress:g}=(0,tl.Up)({doc:n,source:"share_panel",editor:r,format:t,formatLabel:a,cardRanges:u,...p?{interceptFileExport:h}:{}});return(0,i.jsx)(ts.N,{onClick:m,icon:o,formatLabel:a,accentColor:l,exportInProgress:g,exportInProgressNote:(0,i.jsx)(C.x6,{id:"57bp6s"}),badge:s,customLabel:d,customInProgressMessage:c})};var tg=n(82203),tx=n.n(tg),tf=n(84287),ty=n(16936),tv=n(5061);let tb=e=>{let{children:t,setMobileSharePanelState:n,backButton:r=!0}=e,o=(0,tv.fW)();return(0,i.jsxs)(v.s,{width:"100%",position:"relative",mb:4,children:[r&&(0,i.jsx)(ty.K,{icon:(0,i.jsx)(j.g,{icon:o?b.vmR:b.Uec}),"aria-label":"Back",variant:"unstyled",position:"absolute",height:"100%",insetStart:-4,onClick:()=>n("main")}),(0,i.jsx)(G.D,{size:"md",w:"100%",textAlign:"center",children:t})]})};var tj=n(14322),tw=n(41471);let tC=()=>new BroadcastChannel("social_post"),tI=e=>{var t;let{doc:n,exportMode:r,cardRangesInput:o}=e,{isOpen:l,onOpen:a,onClose:s}=(0,ef.j)({id:"linkedin-post-modal"}),{data:d}=(0,$.kvr)(),c=null==d||null==(t=d.userIntegrations)?void 0:t.integrations;(0,I.useEffect)(()=>tC().addEventListener("message",e=>{"true"===e.data.success&&"linkedin"===e.data.platform&&a()}),[a]);let u=(0,I.useCallback)(()=>(null==c?void 0:c.includes($.n30.Linkedin))?a():(0,tj.GE)({url:(0,U.n$)(),title:Y.Ru._({id:"Abf1Uw"}),w:800,h:600}),[c,a]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ts.N,{onClick:u,formatLabel:"LinkedIn",icon:tc.q.linkedin.icon,rightIcon:b.t5Z,accentColor:tc.q.linkedin.accentColor,customLabel:Y.Ru._({id:"x7i6H+"}),exportInProgress:!1}),l&&(0,i.jsx)(tw.A,{isSocialPostModalOpen:l,onSocialPostModalClose:s,socialPlatform:"linkedin",cardRangesInput:"all"===r?"":o,doc:n})]})},tS=e=>{let{doc:t,editor:n,setMobileSharePanelState:r}=e,o=(0,A.u)("googleSlidesExport"),{product:l}=(0,tf.I)();return(0,i.jsx)(tt.G_,{clientId:tn.$.GOOGLE_DRIVE_IMPORT_CLIENT_ID,children:(0,i.jsxs)(m.B,{alignItems:"center",flex:1,children:[(0,i.jsx)(tb,{setMobileSharePanelState:r,children:(0,i.jsx)(C.x6,{id:"GS+Mus"})}),(0,i.jsxs)(m.B,{direction:"column",spacing:6,width:"100%",children:[(0,i.jsx)(tk,{format:"pdf",label:"PDF",icon:tc.q.pdf.icon,accentColor:tc.q.pdf.accentColor,doc:t,editor:n,cardRanges:void 0}),(0,i.jsx)(tk,{format:"pptx",label:"PowerPoint",icon:tc.q.pptx.icon,accentColor:tc.q.pptx.accentColor,doc:t,editor:n,cardRanges:void 0}),o&&(0,i.jsx)(tk,{format:"google_slides",label:"Google Slides",icon:tc.q.google_slides.icon,accentColor:tc.q.google_slides.accentColor,doc:t,editor:n,cardRanges:void 0,customLabel:Y.Ru._({id:"wj3Fyq"}),customInProgressMessage:Y.Ru._({id:"9ZkGtt"}),badge:void 0}),(0,i.jsx)(tk,{format:"image",label:"PNG",icon:tc.q.png.icon,accentColor:tc.q.png.accentColor,doc:t,editor:n,cardRanges:void 0,customLabel:Y.Ru._({id:"wAyz08"}),customInProgressMessage:Y.Ru._({id:"RSRVl9"})}),(0,i.jsx)(tI,{exportMode:"all",cardRangesInput:"",doc:t})]}),!l&&(0,i.jsx)(f.$,{width:"fit-content",mt:6,fontSize:"sm",variant:"ghost",display:"flex",as:tx(),href:"/pricing",leftIcon:(0,i.jsx)(w.uh,{w:4}),children:(0,i.jsx)(C.x6,{id:"vo61Ld",values:{GAMMA_PROPER_NOUN:Z.On}})}),(0,i.jsx)(x.h,{}),(0,i.jsx)(f.$,{variant:"toolbar",onClick:()=>r("main"),children:(0,i.jsx)(C.x6,{id:"yz7wBu"})})]})})},tk=e=>{let{format:t,doc:n,editor:r,icon:o,accentColor:l,label:a,badge:s,customLabel:d,customInProgressMessage:c,cardRanges:u,debuggingForceInProgress:p=!1}=e,h=(0,A.u)("googleSlidesExport"),{interceptFileExport:m}=(0,td.w)({doc:n,source:"share_panel",editor:r,cardRanges:u}),{handleExport:g,exportInProgress:x}=(0,tl.Up)({doc:n,source:"share_panel",editor:r,format:t,formatLabel:a,cardRanges:u,...h?{interceptFileExport:m}:{}});return(0,i.jsx)(ts.N,{onClick:g,icon:o,formatLabel:a,accentColor:l,exportInProgress:x||p,exportInProgressNote:"",badge:s,customLabel:d,customInProgressMessage:c})};var tA=n(87827);let tE=e=>{let{onRemoveUser:t,onCancel:n}=e,r=(0,ed.dU)("gray.900","gray.50"),o=(0,ed.dU)("gray.600","gray.200");return(0,i.jsxs)(m.B,{flex:1,children:[(0,i.jsx)(tb,{setMobileSharePanelState:()=>{},backButton:!1,children:(0,i.jsx)(C.x6,{id:"3zSBeh"})}),(0,i.jsx)(F.E,{color:r,fontSize:"md",fontWeight:"semibold",children:(0,i.jsx)(C.x6,{id:"QhdP/l"})}),(0,i.jsx)(F.E,{color:o,fontSize:"sm",children:(0,i.jsx)(C.x6,{id:"Hl3Hbm"})}),(0,i.jsx)(x.h,{}),(0,i.jsx)(f.$,{variant:"hazardous",onClick:t,size:"lg",children:(0,i.jsx)(C.x6,{id:"t/YqKh"})}),(0,i.jsx)(f.$,{variant:"ghost",onClick:n,children:(0,i.jsx)(C.x6,{id:"dEgA5A"})})]})},t_=e=>{var t,n;let{doc:r,setMobileSharePanelState:o,confirmCallback:l,closeCallback:a,onRemoveUser:s,initialAccessType:d,accessOptions:u,passwordDialog:h="hidden",showRemoveUser:g=!1,showBackButton:y=!1,customHeader:w}=e,[S,k]=(0,I.useState)(d),A=(0,tv.fW)(),E=null==(t=u.find(e=>e.accessType===S))?void 0:t.disabled,_=null==r||null==(n=r.accessLinks)?void 0:n[0],R=(null==_?void 0:_.type)==="password",[P,T]=(0,I.useState)(!1);return P&&s?(0,i.jsx)(tE,{onRemoveUser:s,onCancel:()=>{T(!1)}}):(0,i.jsxs)(v.s,{direction:"column",justifyContent:"space-between",flex:1,children:[(0,i.jsxs)(m.B,{spacing:5,children:[w||(0,i.jsx)(tb,{setMobileSharePanelState:o,backButton:y,children:(0,i.jsx)(G.D,{size:"md",children:(0,i.jsx)(C.x6,{id:"zk0Twx"})})}),(0,i.jsx)(m.B,{children:(0,i.jsxs)(m.B,{mx:1,spacing:6,children:[u.map(e=>{let{disabled:t,accessType:n,errorText:r}=e;return(0,i.jsxs)(ei.z,{onClick:()=>t?null:k(n),children:[(0,i.jsx)(c.a,{w:4,transform:"translate(-.25rem)",children:n===S?(0,i.jsx)(j.g,{icon:b.e68}):""}),(0,i.jsxs)(m.B,{w:"100%",spacing:0,children:[(0,i.jsx)(F.E,{color:t?"gray.400":"",fontWeight:"semibold",children:eM[n].title()}),(0,i.jsx)(F.E,{fontSize:"sm",color:t?"gray.400":"gray.500",fontWeight:"medium",children:eM[n].description()}),r&&(0,i.jsx)(F.E,{color:"red.500",fontSize:"sm",mb:-2,children:r})]})]},n)}),(0,i.jsx)(p.c,{}),g&&(0,i.jsxs)(ei.z,{justifyContent:"space-between",alignItems:"center",onClick:()=>T(!0),color:"red.500",w:"100%",children:[(0,i.jsx)(c.a,{w:4,transform:"translate(-.25rem)",children:(0,i.jsx)(j.g,{icon:b.yLS,size:"xs"})}),(0,i.jsx)(F.E,{fontWeight:"semibold",children:(0,i.jsx)(C.x6,{id:"3zSBeh"})}),(0,i.jsx)(x.h,{})]}),("visible"===h||"disabled"===h)&&(0,i.jsxs)(ei.z,{justifyContent:"space-between",alignItems:"center",opacity:"disabled"===h?.6:1,onClick:()=>{"visible"===h&&o("password")},children:[(0,i.jsx)(c.a,{w:4,transform:"translate(-.25rem)",children:(0,i.jsx)(j.g,{icon:b.DW4})}),(0,i.jsxs)(m.B,{spacing:0,children:[(0,i.jsx)(F.E,{fontSize:"md",fontWeight:"semibold",children:(0,i.jsx)(C.x6,{id:"8ZsakT"})}),(0,i.jsx)(F.E,{fontSize:"sm",color:"gray.500",children:R?(0,i.jsx)(C.x6,{id:"GZ6qi2"}):(0,i.jsx)(C.x6,{id:"H6KqVd"})})]}),(0,i.jsx)(x.h,{}),(0,i.jsx)(j.g,{icon:A?b.Uec:b.vmR})]})]})})]}),(0,i.jsxs)(m.B,{spacing:5,children:[(0,i.jsx)(f.$,{variant:"solid",onClick:()=>E?null:l(S),isDisabled:E,size:"lg",fontWeight:"semibold",children:(0,i.jsx)(C.x6,{id:"7VpPHA"})}),(0,i.jsx)(f.$,{variant:"ghost",onClick:a,children:(0,i.jsx)(C.x6,{id:"dEgA5A"})})]})]})};var tR=n(4192);let tP=e=>{let{selectedCollaborator:t,handleRemoveClick:n}=e,r=t&&(0,ev.t)((null==t?void 0:t.email)||"");return(0,i.jsxs)(tR.vw,{size:"lg",minW:110,...r?{}:{colorScheme:"red"},children:["id"in t?(0,i.jsx)(w.Tz,{label:t.email,"aria-label":t.email,children:(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(q.e,{size:"2xs",m:0,name:t.displayName,src:t.profileImageUrl}),(0,i.jsx)(F.E,{textTransform:"capitalize",wordBreak:"break-word",noOfLines:1,lineHeight:"1.5",children:t.displayName})]})}):(0,i.jsx)(w.Tz,{label:r?t.email:(0,i.jsx)(C.x6,{id:"XILg0L"}),"aria-label":t.email,children:(0,i.jsxs)(ei.z,{flex:1,children:[(0,i.jsx)(K.j,{size:6,children:(0,i.jsx)(j.g,{icon:r?b.y_8:b.bxP})}),(0,i.jsx)(F.E,{wordBreak:"break-all",display:"block",height:"100%",width:"100%",noOfLines:1,lineHeight:"1.5",children:t.email})]})}),(0,i.jsx)(tR.TV,{onClick:n})]})},tT=(0,eb.P)(c.a),tz=e=>{let{autoCompleteFilter:t,autoCompleteInputOnChange:n,autoCompleteInputOnKeyDown:r,autoCompleteInputOnPaste:o,autoCompleteOnSelectOption:l,autoCompleteOnTagRemoved:a,autocompleteRef:s,inputRef:d,inputValue:u,isProcessingBatch:p,searchUsers:h,selectedItems:m,shouldDisableInput:g,showControls:x,showCreatable:f}=e,y=(0,ed.dU)("light","dark"),w=(0,ed.dU)("trueblue.50","whiteAlpha.100"),C=(0,ed.dU)("trueblue.100","whiteAlpha.200");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ec.e,{w:"100%",mb:2,alignItems:"flex-start","data-testid":"sharepanel-search-bar",children:[(0,i.jsx)(c.a,{flex:1,children:(0,i.jsxs)(eu.M,{w:"100%",justifyContent:"center",zIndex:2,children:[(0,i.jsx)(v.s,{display:p?"flex":"none",position:"absolute",h:"100%",w:"100%",alignItems:"center",justifyContent:"center",zIndex:"overlay",opacity:.4,children:(0,i.jsx)(ep.y,{})}),(0,i.jsxs)(em.j9,{ref:s,values:m,maxSelections:100,maxSuggestions:20,creatable:!0,multiple:!0,freeSolo:!0,suggestWhenEmpty:!1,openOnFocus:!0,filter:t,onSelectOption:l,onTagRemoved:a,children:[(0,i.jsxs)(eh.W,{pointerEvents:"none",color:(0,ed.dU)("gray.300","gray.600"),h:"100%",flexDirection:"column",children:[(0,i.jsx)(v.s,{flex:1}),(0,i.jsx)(v.s,{h:10,py:4,alignItems:"center",children:(0,i.jsx)(es.W,{w:10})})]}),(0,i.jsx)(em.Rv,{ref:d,"data-testid":"autocomplete-collaborators-input",cursor:g?"not-allowed":void 0,disabled:g,w:"100%",paddingInlineStart:5,wrapStyles:{px:2},fontSize:"md",placeholder:Y.Ru._({id:"P8H57Z"}),transition:"width 1s ease-in-out",value:u,onKeyDown:r,onPaste:o,onChange:n}),(0,i.jsx)(em.HN,{w:"100%",mt:0,display:u.length>0?"flex":"none","data-theme":y,children:h.map(e=>{let{id:t,email:n,displayName:r,profileImageUrl:o}=e;return(0,i.jsx)(em.qF,{fixed:!0,"data-testid":"autocomplete-item-user-".concat(t),value:{email:n,type:"collaborator"},getValue:e=>e.email,align:"center",_focus:{bg:w},children:(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(q.e,{size:"sm",name:r,src:o}),(0,i.jsxs)(c.a,{children:[(0,i.jsx)(F.E,{textTransform:"capitalize",children:r}),(0,i.jsx)(F.E,{fontSize:"xs",color:"gray.500",children:null==n?void 0:n.toLowerCase()})]})]})},t)}).concat((0,i.jsx)(em.qF,{value:{email:u,type:"collaborator"},align:"center",display:f?"flex":"none",_focus:{bg:w},children:(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(K.j,{bg:C,size:8,children:(0,i.jsx)(j.g,{icon:b.y_8})}),(0,i.jsx)(F.E,{size:"md",children:u})]})},u))})]})]})}),(0,i.jsx)(tT,{overflowX:"hidden",me:-2,transition:"slow",animate:{maxWidth:x?"200px":"0px"}})]}),m.map((e,t)=>(0,i.jsx)(c.a,{children:(0,i.jsx)(tP,{idx:t,selectedCollaborator:e,handleRemoveClick:()=>{var t;null==(t=s.current)||t.removeItem(e.email)}})},"id"in e?e.id:e.email))]})},tM=()=>({view:{subtitle:Y.Ru._({id:"ihPQra"}),tooltip:(0,T.h9)()},comment:{subtitle:Y.Ru._({id:"qPZYdC"}),tooltip:Y.Ru._({id:"oKPro/",values:{0:(0,T.h9)()}})},edit:{subtitle:Y.Ru._({id:"TVFcVE"}),tooltip:Y.Ru._({id:"2gPY9r",values:{0:(0,T.h9)()}})},manage:{subtitle:Y.Ru._({id:"bKvp4s"}),tooltip:Y.Ru._({id:"+OkTAI",values:{0:(0,T.h9)()}})}}),tD=(e,t,n)=>{if(!n)return e;let i=[...e],r=e.findIndex(e=>"email"in e&&e.email===n),o=t.find(e=>e.email===n);return -1!==r&&i.splice(r,1),[...i,o||{email:n}]},tO=(e,t)=>{let n=(0,eS.e7)(t.map(e=>"displayName"in e?e.displayName:e.email),3);return e===$.aXG.Manage?Y.Ru._({id:"4bKxWq",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}}):e===$.aXG.Edit?Y.Ru._({id:"3rbi6Y",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}}):e===$.aXG.Comment?Y.Ru._({id:"uGWY40",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}}):e===$.aXG.View?Y.Ru._({id:"p5IG6F",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}}):Y.Ru._({id:"Ai1TAT",values:{userNames:n,GAMMA_ARTIFACT_PROPER_NOUN:Z.TP,0:t.length}})},tL=e=>{var t,n;let{doc:r,setMobileSharePanelState:l,lastSearchText:a,setLastSearchText:s}=e,d=(0,o.d)(),c=(0,tv.fW)(),[u,h]=(0,I.useState)([]),g=(0,L.ur)().user,y=(0,I.useRef)(null),[v,w]=(0,I.useState)(!1),S=(0,tA.n)(tM),k=null==r||null==(t=r.accessLinks)?void 0:t[0],A=(null==k?void 0:k.type)==="password",E=(null==r?void 0:r.collaborators)||[],_=(null==r||null==(n=r.organization)?void 0:n.id)||"",[R,P]=(0,I.useState)(!1),[T,z]=(0,I.useState)($.aXG.Edit),M=v&&"manage"===T,D=(0,I.useCallback)(()=>{P(!0)},[P]),[O,N]=(0,I.useState)(!1),B=(0,I.useRef)(),U=(0,I.useRef)(null),[W,G]=(0,I.useState)(null!=a?a:""),[V,H]=(0,I.useState)([]),[q,K]=(0,I.useState)(new eI.c),X=u.filter(e=>"email"in e),J=(0,eC.st)(),Z=E.map(e=>e.user),[Q,{error:et}]=(0,$.VXs)();(0,ee.KW)("Error inviting collaborators.",et);let en=(0,$.tzS)($.HdQ),{data:er,loading:eo}=(0,$.puH)({variables:{query:W,workspaceId:_},skip:!W});(0,I.useEffect)(()=>{!eo&&er&&H(er.search.filter(Boolean))},[er,eo]);let ea=(0,I.useMemo)(()=>W?V.filter(e=>"User"===e.__typename&&e.id!==g.id&&!X.concat(Z).find(t=>t.email===e.email)):[],[V,Z,W,X,g.id]),es=!!W&&!ea.find(e=>e.email===W),ed=X.some(e=>!("__typename"in e&&"User"===e.__typename)),ec=T===$.aXG.Manage&&ed;(0,I.useEffect)(()=>{w(ed)},[w,ed]);let eu=!!u.length,ep=!!X.some(e=>{var t;return"__typename"in e&&"User"===e.__typename||(0,ev.t)(null!=(t=e.email)?t:"")}),eh=(null==r?void 0:r.id)||"",em=(0,I.useCallback)(async e=>{N(!0),h(t=>e.reduce((e,t)=>tD(e,ea,t.trim()),t));let t=(await Promise.all(e.map(async e=>{var t;return null==(t=(await en({workspaceId:_,query:e})).data)?void 0:t.search.find(t=>"User"===t.__typename&&t.email===e)}))).filter(Boolean);h(n=>e.reduce((e,n)=>tD(e,t,n.trim()),n)),N(!1)},[ea,en,_,h]),eg=(0,I.useCallback)(async()=>{if(0===X.length)return;let e=tD(X,ea,W.trim()).filter(e=>"email"in e&&(0,ev.t)(e.email||"")),t=[...E,...e.map(e=>{if("id"in e)return{docId:eh,user:e,guest:!1,permission:T,__typename:"DocCollaborator"}})].filter(e=>!!e),n=[...(null==r?void 0:r.invitations)||[],...e.map(e=>{if(!("id"in e))return{id:"temp",docTitle:"temp-title",invitedBy:g,docId:eh,email:e.email,permission:T,__typename:"DocInvitation"}})].filter(e=>!!e);return Q({variables:{docId:eh,collaborators:e.map(e=>({..."id"in e?{userId:e.id}:{email:e.email},permission:T}))},update:(e,t)=>{let{data:n}=t;e.writeFragment({id:"Doc:".concat(eh),fragment:$.rgw,data:null==n?void 0:n.addCollaborators})},optimisticResponse:{addCollaborators:{id:eh,collaborators:t,invitations:n}}}).then(()=>{d({title:Y.Ru._({id:"Ka86rB",values:{0:e.length}}),description:tO(T,e),status:"success",duration:5e3,isClosable:!0,position:"top"}),null==J||J.track(eC.VV.DOC_COLLABORATOR_INVITED,{doc_id:eh,source:"share-panel",number_of_invites_sent:e.length,permissions:T})})},[Q,eh,null==r?void 0:r.invitations,W,T,ea,X,E,d,g,J]),ex=(0,I.useCallback)(async()=>Promise.all([eg()]).then(()=>{var e;h([]),G(""),null==(e=B.current)||e.resetItems(!0),q.resolve(),K(new eI.c)}).catch(e=>{console.warn(e)}),[eg,q,h]);return((0,I.useEffect)(()=>{y&&(y.current=ex)},[y,ex]),(0,I.useEffect)(()=>{"string"==typeof a&&(0,ev.t)(a)&&(em([a]),G("")),s(void 0)},[em,a,s]),R)?(0,i.jsx)(t_,{initialAccessType:T,setMobileSharePanelState:e=>l(e),confirmCallback:e=>{z(e),P(!1)},closeCallback:()=>P(!1),accessOptions:[{accessType:$.aXG.Manage,disabled:v,...v?{errorText:"User needs to be part of your workspace to have Full Access."}:{}},{accessType:$.aXG.Edit},{accessType:$.aXG.Comment},{accessType:$.aXG.View}]}):(0,i.jsxs)(m.B,{flex:1,children:[(0,i.jsx)(tb,{setMobileSharePanelState:l,children:(0,i.jsx)(C.x6,{id:"MFKlMB"})}),g&&(0,i.jsx)(tz,{autoCompleteFilter:(e,t)=>!X.find(e=>e.email===t),autoCompleteInputOnChange:e=>{let{target:t}=e,{value:n}=t;G(n),n||H([])},autoCompleteInputOnKeyDown:e=>{let{key:t}=e;if("Backspace"===t&&0===W.length&&u.length>0){let e=u.slice(-1).pop();if(e){var n;null==(n=B.current)||n.removeItem("email"in e?e.email:e.id)}}},autoCompleteInputOnPaste:e=>{e.preventDefault(),e.stopPropagation(),em(e.clipboardData.getData("Text").trim().split(/[,|;\s]+/)),G(""),H([])},autoCompleteOnSelectOption:e=>{let{item:t}=e,{type:n}=t.originalValue;"collaborator"===n&&h(e=>tD(e,ea,t.value)),G("")},autoCompleteOnTagRemoved:e=>{h(t=>[...t].filter(t=>"email"in t?t.email!==e:!("id"in t)||t.id!==e))},autocompleteRef:B,inputRef:U,inputValue:W,isProcessingBatch:O,searchUsers:ea,showControls:eu,showCreatable:es,selectedItems:u,shouldDisableInput:!1}),(0,i.jsx)(x.h,{}),(0,i.jsx)(p.c,{}),(0,i.jsx)(F.E,{children:(0,i.jsx)(C.x6,{id:"9cDpsw"})}),(0,i.jsxs)(ei.z,{spacing:2,justify:"space-between",children:[(0,i.jsx)(el,{icon:A?b.OKD:b.CQO,showDisabled:v&&"manage"===T,size:10}),(0,i.jsxs)(m.B,{spacing:.5,children:[(0,i.jsx)(F.E,{color:M?"gray.400":"",children:eM[T].title()}),(0,i.jsx)(F.E,{fontSize:"xs",color:M?"gray.400":"gray.500",children:S[T].subtitle})]}),(0,i.jsx)(x.h,{}),(0,i.jsxs)(f.$,{variant:"ghost",onClick:D,children:[(0,i.jsx)(F.E,{me:3,children:(0,i.jsx)(C.x6,{id:"o+XJ9D"})}),(0,i.jsx)(j.g,{icon:c?b.Uec:b.vmR,size:"lg"})]})]}),M&&(0,i.jsx)(F.E,{color:"red.500",fontSize:"sm",children:(0,i.jsx)(C.x6,{id:"yxdnLB"})}),(0,i.jsx)(p.c,{m:4}),(0,i.jsx)(f.$,{variant:"solid",size:"lg",onClick:()=>{y.current&&y.current(),l("main")},isDisabled:!ep||ec,children:(0,i.jsx)(C.x6,{id:"MFKlMB"})}),(0,i.jsx)(f.$,{variant:"ghost",color:"inherit",onClick:()=>l("main"),children:(0,i.jsx)(C.x6,{id:"dEgA5A"})})]})};var tN=n(33787),tB=n(74892),tU=n(45143);let tF=e=>{let{icon:t,text:n,ariaLabel:r,onClick:o}=e,l=(0,O.rd)();return(0,i.jsxs)(m.B,{direction:"column",alignItems:"center",spacing:2,onClick:o,flex:1,overflow:"hidden",whiteSpace:"nowrap",children:[(0,i.jsx)(ty.K,{bg:"gray.200",color:"gray.700",borderRadius:"full","aria-label":r,textAlign:"center",variant:"ghost",size:"lg",children:(0,i.jsx)(j.g,{icon:t})}),(0,i.jsx)(F.E,{fontSize:"sm",color:l?"white":"deepocean.950",fontWeight:"semibold",align:"center",textOverflow:"ellipsis",maxW:"100%",overflow:"hidden",whiteSpace:"normal",noOfLines:2,children:n})]})},tW=e=>{let{icon:t,onClick:n,text:r,rightText:o}=e,l=(0,tv.fW)();return(0,i.jsx)(f.$,{onClick:n,width:"100%",variant:"unstyled",fontWeight:"",children:(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(K.j,{color:"gray.700",textAlign:"center",bg:"gray.200",size:10,children:(0,i.jsx)(j.g,{icon:t})}),(0,i.jsx)(F.E,{children:r}),(0,i.jsx)(x.h,{}),(0,i.jsx)(f.$,{variant:"unstyled",minW:"0",children:o?(0,i.jsxs)(ei.z,{spacing:3,children:[(0,i.jsx)(F.E,{children:o}),(0,i.jsx)(j.g,{icon:l?b.Uec:b.vmR})]}):(0,i.jsx)(j.g,{icon:l?b.Uec:b.vmR})})]})})},tG=e=>{var t,n,l,a,s,d,c;let{doc:u,setMobileSharePanelState:h,handleViewAnalyticsClick:g,closeSharePanel:y,showAnalytics:S}=e,k=(0,I.useRef)(!1),{user:A}=(0,L.ur)(),E=(0,o.d)(),_=(0,z.ZP)(u,A),R=_?(0,z.bC)()[_]:null;(null==u||null==(t=u.organization)?void 0:t.id)||k.current||(console.error("[SharePanelModal] Doc unexpectedly doesnt have a workspaceId",{docId:u.id,organization:u.organization}),k.current=!0);let T=null!=(d=null==u||null==(n=u.titleCard)?void 0:n.previewUrl)?d:tB.A.src,M=null==u||null==(l=u.accessLinks)?void 0:l[0],D=(0,I.useMemo)(()=>(0,U.LN)({docTitle:null==u?void 0:u.title,docId:null==u?void 0:u.id,token:null==M?void 0:M.token,absolute:!0}),[u,null==M?void 0:M.token]),{anonymousUser:O}=(0,L.ur)(),N={...O,organizations:[]},{profileImageUrl:B}=A||N,W=(0,tU.h5)(["xs","sm"]),{onCopy:V}=(0,r.i)(D),H="link-copied-toast",K=(0,I.useCallback)(()=>{V(),E.isActive(H)||E({id:H,title:(0,i.jsx)(C.x6,{id:"pQjjYo"}),status:"success",duration:5e3,position:"top"}),(0,P.d)({docId:u.id,source:"sharePanel",type:"tokenUrl"})},[u.id,V,E]),X=(0,I.useCallback)(async()=>{let e={title:u.title,text:"Shared via Gamma",url:D};await navigator.share(e)},[u.title,D]),J=(null==M?void 0:M.permission)?null==M?void 0:M.permission:ez.NoAccess,$=u&&A&&(null==u||null==(a=u.createdBy)?void 0:a.id)===(null==A?void 0:A.id)?Y.Ru._({id:"av/PD9"}):null!=(c=null==u||null==(s=u.createdBy)?void 0:s.firstName)?c:"";return null===R?(console.error("[SharePanel] Unknown VisibilityValue for doc",u),null):(0,i.jsxs)(m.B,{w:"100%",spacing:2,children:[(0,i.jsxs)(v.s,{justify:"space-between",children:[(0,i.jsx)(G.D,{children:(0,i.jsx)(C.x6,{id:"Z8lGw6"})}),(0,i.jsx)(f.$,{"data-share-panel-close-button":!0,variant:"ghost",px:0,onClick:e=>{e.preventDefault(),y()},children:(0,i.jsx)(F.E,{fontWeight:"semibold",children:(0,i.jsx)(C.x6,{id:"DPfwMq"})})})]}),(0,i.jsxs)(m.B,{alignItems:"center",spacing:5,mb:2,children:[(0,i.jsx)(tN._,{borderRadius:"md",shadow:"xl",src:T,w:250}),(0,i.jsxs)(v.s,{gap:2,alignItems:"center",children:[(0,i.jsx)(q.e,{src:B,showBorder:!1,size:W}),(0,i.jsx)(F.E,{color:"gray.600",fontSize:"sm",children:(0,i.jsx)(C.x6,{id:"0jxROC",values:{createdByUser:$}})})]})]}),S&&(0,i.jsx)(f.$,{variant:"ghost",color:"inherit",onClick:g,leftIcon:(0,i.jsx)(j.g,{icon:b.q9c}),children:(0,i.jsx)(F.E,{fontSize:"md",children:(0,i.jsx)(C.x6,{id:"YaUqUV"})})}),(0,i.jsxs)(m.B,{spacing:4,mt:2,children:[(0,i.jsx)(w._x,{children:(0,i.jsx)(C.x6,{id:"xXYV+r"})}),(0,i.jsx)(tW,{icon:b.CQO,onClick:()=>h("manage-access"),rightText:eM[J].title(),text:(0,i.jsx)(C.x6,{id:"qZu20V"})}),(0,i.jsx)(tW,{icon:b.USd,onClick:()=>h("members"),text:(0,i.jsx)(C.x6,{id:"hB02vO"})})]}),(0,i.jsx)(x.h,{}),(0,i.jsxs)(m.B,{spacing:6,children:[(0,i.jsx)(p.c,{}),(0,i.jsxs)(ei.z,{w:"100%",overflow:"hidden",alignItems:"start",children:[(0,i.jsx)(tF,{onClick:K,text:(0,i.jsx)(C.x6,{id:"A/z0Uc"}),ariaLabel:Y.Ru._({id:"y1eoq1"}),icon:b.CQO}),(0,i.jsx)(tF,{onClick:()=>h("invite"),text:(0,i.jsx)(C.x6,{id:"wEi1R1"}),ariaLabel:Y.Ru._({id:"MFKlMB"}),icon:b.nWR}),(0,i.jsx)(tF,{onClick:X,text:(0,i.jsx)(C.x6,{id:"Mh3GfE"}),ariaLabel:Y.Ru._({id:"Z8lGw6"}),icon:b.t5Z}),(0,i.jsx)(tF,{onClick:()=>h("export"),text:(0,i.jsx)(C.x6,{id:"WwCRK2"}),ariaLabel:Y.Ru._({id:"GS+Mus"}),icon:b.a_I})]})]})]})},tV=e=>{var t,n;let{doc:r,setMobileSharePanelState:l}=e,a=(null==r||null==(n=r.accessLinks)||null==(t=n[0])?void 0:t.permission)||ez.NoAccess,s=(0,o.d)(),d=e=>()=>{s({title:"updated"===e?Y.Ru._({id:"Xpw8aE"}):Y.Ru._({id:"jwO7L7"}),status:"success",duration:5e3,isClosable:!0,position:"top"})},[c]=(0,$.vcy)(),u=e=>{var t;let n=null==r||null==(t=r.accessLinks)?void 0:t[0],i=null==n?void 0:n.id,o={id:r.id,accessLinks:e===ez.NoAccess?[{permission:null}]:[{permission:e}]};c({variables:o,optimisticResponse:{updateDoc:{...o,accessLinks:[{__typename:"AccessLink",id:i||"temp-id",permission:e===ez.NoAccess?null:e}],__typename:"Doc"}}}).then(d(e===ez.NoAccess?"removed":"updated"))};return(0,i.jsx)(t_,{doc:r,setMobileSharePanelState:l,confirmCallback:e=>{u(e),l("main")},closeCallback:()=>l("main"),initialAccessType:a,accessOptions:[{accessType:$.aXG.Edit},{accessType:$.aXG.Comment},{accessType:$.aXG.View},{accessType:ez.NoAccess}],passwordDialog:a===ez.NoAccess?"disabled":"visible",showBackButton:!0})},tH=e=>{let{icon:t,rtlIcon:n,...r}=e,o=(0,tv.fW)();return(0,i.jsx)(j.g,{icon:o?n:t,...r})},tq=(e,t)=>{var n,i;let r="DocCollaborator"===e.__typename?null==(n=e.user.displayName)?void 0:n.toUpperCase():"DocInvitation"===e.__typename?e.email.toUpperCase():"",o="DocCollaborator"===t.__typename?null==(i=t.user.displayName)?void 0:i.toUpperCase():"DocInvitation"===t.__typename?t.email.toUpperCase():"";return!o||r&&r<o?-1:!r||o&&r>o?1:0},tK=(e,t)=>{if(e.permission!==t.permission){if("manage"===e.permission)return -1;if("manage"===t.permission)return 1}return tq(e,t)},tY=e=>{var t,n;let{doc:r,setMobileSharePanelState:l,canManage:a,setLastSearchText:s}=e,d=(0,o.d)(),{user:u}=(0,L.ur)(),p=(0,tv.fW)(),[h,g]=(0,I.useState)(!1),[y,v]=(0,I.useState)(null),[w,S]=(0,I.useState)(!1),k=(null==r?void 0:r.collaborators)||[],[A]=(0,$.VXs)(),E=(null==r?void 0:r.invitations)||[],_=[...k,...E].sort(tK),R=k.filter(e=>e.permission===$.aXG.Manage).length,P=(null==r||null==(t=r.organization)?void 0:t.id)||"",{isConnected:T}=(0,$.utY)(),z=a&&T,[M,D]=(0,I.useState)(""),[O]=(0,$.AmA)(),N=(0,ed.dU)("gray.600","gray.200"),B=e=>()=>{d({title:"updated"===e?Y.Ru._({id:"Xpw8aE"}):Y.Ru._({id:"jwO7L7"}),status:"success",duration:5e3,isClosable:!0,position:"top"})},U=e=>{if((null==y?void 0:y.__typename)!=="DocCollaborator")return;let t=y.user;if(!t)return;let n={docId:r.id,collaborators:[{userId:t.id,permission:e}]};A({variables:n,optimisticResponse:{addCollaborators:{id:n.docId,collaborators:k.map(n=>({...n,permission:n.user.id===t.id?e:n.permission})),invitations:E,__typename:"Doc"}}}).then(B("updated")).catch(()=>{})},W=e=>{if((null==y?void 0:y.__typename)!=="DocInvitation")return;let t={docId:r.id,collaborators:[{email:y.email,permission:e}]};A({variables:t,optimisticResponse:{addCollaborators:{id:t.docId,invitations:E.map(t=>({...t,permission:t.email===y.email?e:t.permission})),collaborators:k,__typename:"Doc"}}}).then(B("updated")).catch(()=>{console.warn("Error updating permission")})},V=()=>{if(y)if((null==y?void 0:y.__typename)==="DocCollaborator"){if(!y)return;let e=y.user.id,t={docId:r.id,collaborators:[{userId:e}]};O({variables:t,optimisticResponse:{removeCollaborators:{id:t.docId,collaborators:k.filter(t=>t.user.id!==e),invitations:E,__typename:"Doc"}}}).then(B("removed"))}else{let e={docId:r.id,collaborators:[{email:y.email}]};O({variables:e,optimisticResponse:{removeCollaborators:{id:e.docId,invitations:E.filter(e=>e.email!==y.email),collaborators:k,__typename:"Doc"}}}).then(B("removed"))}},H=y&&"user"in y?y.user.profileImageUrl:"",X=null==y?"":"user"in y?null==(n=y.user)?void 0:n.displayName:null==y?void 0:y.email,J=(0,tU.h5)(["xs","sm"]),Z=_.filter(e=>{var t,n,i,r;let o=M.toLowerCase();if("DocCollaborator"===e.__typename){let i=e.user;return(null==i||null==(t=i.email)?void 0:t.toLowerCase().includes(o))||(null==i||null==(n=i.displayName)?void 0:n.toLowerCase().includes(o))}return"DocInvitation"===e.__typename&&(null==e||null==(r=e.email)||null==(i=r.toLowerCase())?void 0:i.includes(o))});return h?(0,i.jsx)(t_,{setMobileSharePanelState:l,confirmCallback:e=>{(null==y?void 0:y.__typename)==="DocCollaborator"&&U(e),(null==y?void 0:y.__typename)==="DocInvitation"&&W(e),g(!1)},closeCallback:()=>g(!1),onRemoveUser:()=>{V(),g(!1)},initialAccessType:null==y?void 0:y.permission,showRemoveUser:!0,accessOptions:[...w?[{accessType:$.aXG.Manage}]:[],{accessType:$.aXG.Edit},{accessType:$.aXG.Comment},{accessType:$.aXG.View}],customHeader:(0,i.jsxs)(m.B,{spacing:4,children:[(0,i.jsxs)(ei.z,{w:"100%",position:"relative",alignItems:"flex-start",children:[(0,i.jsx)(ty.K,{icon:(0,i.jsx)(tH,{icon:b.Uec,rtlIcon:b.vmR}),"aria-label":"Back",variant:"unstyled",position:"absolute",height:"fit-content",insetStart:-4,onClick:()=>g(!1)}),(0,i.jsxs)(ei.z,{justifyContent:"center",minW:"100%",children:[(0,i.jsx)(q.e,{src:H,size:J}),(0,i.jsx)(F.E,{children:X})]})]}),(0,i.jsx)(F.E,{fontSize:"sm",color:"#7A7A7A",children:(0,i.jsx)(C.x6,{id:"zk0Twx"})})]})}):(0,i.jsxs)(m.B,{spacing:3,flex:1,children:[(0,i.jsx)(tb,{setMobileSharePanelState:l,children:(0,i.jsx)(C.x6,{id:"wlQNTg"})}),(0,i.jsxs)(eu.M,{children:[(0,i.jsx)(eh.W,{children:(0,i.jsx)(j.g,{icon:b.$UM,size:"xs"})}),(0,i.jsx)(e9.p,{value:M,onChange:e=>D(e.target.value),placeholder:Y.Ru._({id:"Ar2aUr"})})]}),(0,i.jsx)(F.E,{fontSize:"xs",color:"gray.500",children:(0,i.jsx)(C.x6,{id:"t9qtWL"})}),Z.length>0?(0,i.jsx)(eG,{showDivider:!1,isDark:!1,children:Z.map(e=>{let t=e.permission===$.aXG.Manage&&R<2,n=!z||t,o=eM[e.permission].title();if("DocCollaborator"===e.__typename){var l;let t=e.user;return(0,i.jsx)(c.a,{onClick:()=>{v(e),S(!(null==e?void 0:e.guest)),g(!0)},as:"button",textAlign:"start",children:(0,i.jsx)(eF,{testId:t.email,title:"".concat(t.displayName," ").concat(t.id===(null==u?void 0:u.id)?Y.Ru._({id:"dDUgzP"}):""),img:(0,i.jsx)(q.e,{name:t.displayName,src:t.profileImageUrl,size:"sm"}),subtitle:n?void 0:t.email,isDisabled:n,disabledText:o,workspaceGuestInvite:!n&&e.guest?(0,i.jsx)(eJ,{name:t.displayName,workspaceName:null==(l=r.organization)?void 0:l.name,workspaceId:P,email:e.user.email}):void 0,permissionsControl:(0,i.jsxs)(ei.z,{spacing:3,children:[(0,i.jsx)(F.E,{children:o}),(0,i.jsx)(ty.K,{minW:"auto",icon:(0,i.jsx)(j.g,{icon:p?b.Uec:b.vmR}),variant:"unstyled","aria-label":"change user's permission"})]})},t.id)})}return"DocInvitation"===e.__typename?(0,i.jsx)(c.a,{onClick:()=>{v(e),S(!1),g(!0)},as:"button",textAlign:"start",children:(0,i.jsx)(eF,{testId:e.email,title:e.email,subtitle:Y.Ru._({id:"MActeE"}),img:(0,i.jsx)(K.j,{bg:"trueblue.50",size:8,children:(0,i.jsx)(j.g,{icon:b.y_8,size:"sm"})}),isDisabled:n,disabledText:o,permissionsControl:(0,i.jsxs)(ei.z,{spacing:3,children:[(0,i.jsx)(F.E,{children:o}),(0,i.jsx)(ty.K,{icon:(0,i.jsx)(j.g,{icon:b.vmR}),minW:"auto",variant:"unstyled","aria-label":"change user's permission"})]})},e.email)}):null})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.h,{}),(0,i.jsxs)(m.B,{alignItems:"center",spacing:4,children:[(0,i.jsxs)(m.B,{alignItems:"center",children:[(0,i.jsx)(G.D,{size:"lg",children:"We didnt find a match"}),(0,i.jsx)(F.E,{textAlign:"center",color:N,children:(0,i.jsx)(C.x6,{id:"WSFelQ"})})]}),(0,i.jsx)(f.$,{leftIcon:(0,i.jsx)(j.g,{icon:b.nWR}),shadow:"md",size:"sm",onClick:()=>{s(M),l("invite")},children:(0,i.jsx)(C.x6,{id:"x1m5RZ"})})]}),(0,i.jsx)(x.h,{})]}),(0,i.jsx)(x.h,{}),(0,i.jsx)(f.$,{variant:"ghost",onClick:()=>l("main"),children:(0,i.jsx)(C.x6,{id:"2YCifi"})})]})};var tX=n(99430),tJ=n(89528),t$=n(74003);let tZ=e=>{var t;let{onClose:n,onOpen:r,accessLinkEnabled:l,doc:a,isDark:s,segmentEvent:d,isMobile:c=!1}=e,u=(0,o.d)(),{openUpsellModal:p}=(0,t$.I)(),h=(0,eC.st)(),[y,{data:v,loading:b}]=(0,$.FTT)(),[j,S]=(0,I.useState)(""),[k,A]=(0,I.useState)(""),[E,{loading:R}]=(0,$.cdD)(),[P]=(0,$.M5P)(),[T]=(0,$.snR)(),M=(0,_.ez)("password_protected_docs",a.organization),D=null==a||null==(t=a.accessLinks)?void 0:t[0],O=(null==D?void 0:D.type)==="password",[L,N]=(0,I.useState)((null==v?void 0:v.getDocPassword)||""),[B,U]=(0,I.useState)(O),G=O||B;(0,I.useEffect)(()=>{if(U(O),!O){S(""),N("");return}y({variables:{docId:a.id},fetchPolicy:"network-only",nextFetchPolicy:"network-only"}).then(e=>{let{data:t}=e;S((null==t?void 0:t.getDocPassword)||""),N((null==t?void 0:t.getDocPassword)||"")})},[a,O,y,S]);let V=(0,I.useCallback)(e=>{if(l)if(M){if(U(e.target.checked),!e.target.checked){if(!O)return;P({variables:{docId:a.id}}).then(()=>{var e;null==h||h.track(eC.VV.DOC_PASSWORD_DISABLED,{doc_id:a.id,file_id:null==(e=a.file)?void 0:e.id}),u({title:(0,i.jsx)(C.x6,{id:"UbegbY"}),status:"success",duration:3e3,isClosable:!0,position:"top"})}),S(""),N("")}}else e.preventDefault(),p({onOpenCallback:n,onCloseCallback:r,segmentEvent:d})},[l,a,O,M,p,r,n,P,d,u,h]),H=(0,I.useCallback)(async()=>{var e,t;if(j.length<4||j.length>64)return void A(Y.Ru._({id:"S04MAD",values:{MIN_PASSWORD_LENGTH:4,MAX_PASSWORD_LENGTH:64}}));let n=null==(e=a.file)?void 0:e.searchEngineIndexingEnabled,r=null==(t=a.file)?void 0:t.id;if(!r)return void u({title:(0,i.jsx)(C.x6,{id:"SlfejT"}),description:(0,i.jsx)(C.x6,{id:"v41fCm"}),status:"error",duration:5e3,isClosable:!0,position:"top"});await E({variables:{docId:a.id,password:j},refetchQueries:["GetDocPassword","GetDoc"]}),null==h||h.track(eC.VV.DOC_PASSWORD_ENABLED,{doc_id:a.id,file_id:r}),n?(await T({variables:{fileId:r,enable:!1}}),u((0,z.oe)(a.title))):u({title:(0,i.jsx)(C.x6,{id:"Hw2MHB"}),status:"success",duration:3e3,isClosable:!0,position:"top"}),N(j)},[a,j,N,A,E,T,u,h]);return(0,i.jsxs)(m.B,{w:"100%",children:[(0,i.jsxs)(ei.z,{mt:4,mb:2*!!c,children:[(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(F.E,{children:(0,i.jsx)(C.x6,{id:"F5g7OG"})}),!M&&(0,i.jsx)(tJ.zL,{product:"pro"})]}),(0,i.jsx)(x.h,{}),(0,i.jsx)(w.Tz,{label:l?"":(0,i.jsx)(C.x6,{id:"5JvE0U"}),isDisabled:l,shouldWrapChildren:!0,placement:"top",children:(0,i.jsx)(tX.d,{isChecked:B,disabled:!l,onChange:V})})]}),(0,i.jsx)(W.S,{in:G,children:(0,i.jsxs)(e3.MJ,{isInvalid:!!k,children:[(0,i.jsx)(ei.z,{children:b?(0,i.jsx)(g.E,{height:"40px",width:"50%",borderRadius:"md"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e9.p,{id:"password",type:"text",value:j,onChange:e=>S(e.currentTarget.value),onKeyUp:e=>{"Enter"===e.key&&H(),k&&j.length>=4&&j.length<=64&&A("")},width:c?"100%":"50%",placeholder:Y.Ru._({id:"f7sXvi"}),bg:s?void 0:"white"}),(0,i.jsx)(f.$,{isDisabled:j===L,variant:"plain",onClick:H,isLoading:R,children:(0,i.jsx)(C.x6,{id:"tfDRzk"})})]})}),(0,i.jsx)(W.S,{in:""!==k,children:(0,i.jsx)(e7.Wt,{children:k})})]})})]})},tQ=e=>{var t;let{doc:n,setMobileSharePanelState:r}=e,o=null==n||null==(t=n.accessLinks)?void 0:t[0],l=((null==o?void 0:o.permission)?null==o?void 0:o.permission:ez.NoAccess)===ez.NoAccess;return(0,i.jsx)(v.s,{direction:"column",justifyContent:"space-between",pb:2,flex:1,children:(0,i.jsxs)(c.a,{children:[(0,i.jsx)(tb,{setMobileSharePanelState:r,children:(0,i.jsx)(C.x6,{id:"8ZsakT"})}),(0,i.jsx)(tZ,{segmentEvent:eC.VV.GAMMA_PRO_UPSELL_SHARE_SETTINGS_SET_PASSWORD,doc:n,isDark:!1,isMobile:!0,accessLinkEnabled:!l}),(0,i.jsx)(F.E,{fontSize:"xs",color:"gray.500",my:3,children:(0,i.jsx)(C.x6,{id:"mpXIQf",values:{GAMMA_ARTIFACT_PROPER_NOUN:Z.TP}})}),(0,i.jsx)(F.E,{fontSize:"xs",color:"gray.500",mb:4,children:(0,i.jsx)(C.x6,{id:"jMXOQQ"})})]})})},t0=e=>{let{isSharePanelOpen:t,closeIfReady:n,doc:r,editor:o,handleViewAnalyticsClick:l,showAnalytics:a}=e,[s,d]=(0,I.useState)("main"),c=(0,O.rd)(),u=(0,I.useCallback)(()=>{n(),d("main")},[n,d]),[p,h]=(0,I.useState)(void 0);return r?(0,i.jsx)(w.L8,{isDark:c,children:(0,i.jsx)(w.mr,{isOpen:t,onClose:u,topMargin:3,drawerProps:{blockScrollOnMount:!1},children:(0,i.jsxs)(v.s,{px:5,py:4,height:"100%",children:["main"===s&&(0,i.jsx)(tG,{doc:r,setMobileSharePanelState:e=>d(e),handleViewAnalyticsClick:()=>l(),closeSharePanel:u,showAnalytics:a}),"invite"===s&&(0,i.jsx)(tL,{doc:r,setMobileSharePanelState:e=>d(e),selectedAccessLinkPermission:$.aXG.Manage,lastSearchText:p,setLastSearchText:e=>h(e)}),"export"===s&&(0,i.jsx)(tS,{doc:r,editor:o,setMobileSharePanelState:e=>d(e)}),"manage-access"===s&&(0,i.jsx)(tV,{doc:r,setMobileSharePanelState:e=>d(e)}),"members"===s&&(0,i.jsx)(tY,{doc:r,setMobileSharePanelState:e=>d(e),canManage:!0,setLastSearchText:e=>{h(e)}}),"password"===s&&(0,i.jsx)(tQ,{doc:r,setMobileSharePanelState:e=>d(e),closeSharePanel:u})]})})}):(0,i.jsx)(i.Fragment,{})};var t1=n(32844),t6=n(59554),t2=n(6743),t5=n(30928),t4=n(62117),t8=n(2362);let t3=e=>{let{subtitle:t,tooltipLabel:n,ariaLabel:r,icon:o}=e;return(0,i.jsxs)(ei.z,{spacing:1,align:"center",children:[(0,i.jsx)(F.E,{fontSize:"xs",color:"gray.500",children:t}),(0,i.jsx)(w.Tz,{label:n,placement:"top","aria-label":r,children:(0,i.jsx)(c.a,{color:"gray.500",lineHeight:"1",children:(0,i.jsx)(j.g,{size:"xs",icon:o})})})]})},t9=e=>{var t,n;let{doc:r,accessLinkEnabled:l,onClose:a,onOpen:s,segmentEvent:d,isMobile:c=!1}=e,u=(0,o.d)(),{openUpsellModal:p}=(0,t$.I)(),h=(0,eC.st)(),g=(0,A.u)("searchEngineIndexing"),f=(0,_.ez)("search_engine_indexing",r.organization),[y]=(0,$.snR)(),[v]=(0,$.M5P)(),b=(0,I.useCallback)(async e=>{var t,n;if(!l)return;let o=e.target.checked,c=null==(t=r.file)?void 0:t.id,m=r.id;if(!c)return void u({title:(0,i.jsx)(C.x6,{id:"SlfejT"}),description:(0,i.jsx)(C.x6,{id:"v41fCm"}),status:"error",duration:5e3,isClosable:!0,position:"top"});if(!o){await y({variables:{fileId:c,enable:o}}),null==h||h.track(eC.VV.FILE_SEARCH_ENGINE_INDEXING_DISABLED,{doc_id:m,file_id:c}),u({title:(0,i.jsx)(C.x6,{id:"XclkFW"}),status:"success",duration:5e3,isClosable:!0,position:"top"});return}if(!f){e.preventDefault(),p({onOpenCallback:a,onCloseCallback:s,segmentEvent:d});return}let g=null==r||null==(n=r.accessLinks)?void 0:n[0],x=(null==g?void 0:g.type)==="password";o&&x&&await v({variables:{docId:m}}),await y({variables:{fileId:c,enable:o}}),null==h||h.track(eC.VV.FILE_SEARCH_ENGINE_INDEXING_ENABLED,{doc_id:m,file_id:c}),o&&x?u({title:(0,i.jsx)(C.x6,{id:"rTxIf4"}),description:(0,i.jsx)(C.x6,{id:"lO2nUo"}),status:"info",duration:5e3,isClosable:!0,position:"top"}):u({title:o?(0,i.jsx)(C.x6,{id:"EUuzTf"}):(0,i.jsx)(C.x6,{id:"XclkFW"}),status:"success",duration:5e3,isClosable:!0,position:"top"})},[l,f,p,a,s,d,null==(t=r.file)?void 0:t.id,y,v,u,r.id,r.accessLinks,h]);return g?(0,i.jsx)(m.B,{w:"100%",children:(0,i.jsxs)(ei.z,{mt:4,mb:2*!!c,children:[(0,i.jsxs)(m.B,{spacing:0,children:[(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(F.E,{children:(0,i.jsx)(C.x6,{id:"9Mdt3l"})}),!f&&(0,i.jsx)(tJ.zL,{product:"pro"})]}),(0,i.jsx)(F.E,{fontSize:"xs",color:"gray.500",children:(0,i.jsx)(C.x6,{id:"ey2XCa",values:{GAMMA_ARTIFACT_PROPER_NOUN:Z.TP}})})]}),(0,i.jsx)(x.h,{}),(0,i.jsx)(w.Tz,{label:l?"":(0,i.jsx)(C.x6,{id:"qMGQSp"}),isDisabled:l,shouldWrapChildren:!0,placement:"top",children:(0,i.jsx)(tX.d,{isChecked:(null==(n=r.file)?void 0:n.searchEngineIndexingEnabled)||!1,disabled:!l,onChange:b})})]})}):null},t7=()=>({view:{subtitle:Y.Ru._({id:"ihPQra"}),tooltip:(0,T.h9)()},comment:{subtitle:Y.Ru._({id:"qPZYdC"}),tooltip:Y.Ru._({id:"oKPro/",values:{0:(0,T.h9)()}})},edit:{subtitle:Y.Ru._({id:"TVFcVE"}),tooltip:Y.Ru._({id:"2gPY9r",values:{0:(0,T.h9)()}})}}),ne=e=>{var t;let{doc:n,isConnected:r,onSharePanelOpen:l,onSharePanelClose:a,canManage:s,isDark:d}=e,u=(0,tv.fW)(),p=(0,o.d)(),h=(0,tA.n)(t7),m=(0,A.u)("passwordProtectedDoc")&&s,g=null==n||null==(t=n.accessLinks)?void 0:t[0],x=(null==g?void 0:g.type)==="password",[f]=(0,$.vcy)(),[y]=(0,$.snR)(),v=(null==g?void 0:g.permission)?null==g?void 0:g.permission:ez.NoAccess,j=v===ez.NoAccess,w=e=>()=>{p({title:"updated"===e?Y.Ru._({id:"Xpw8aE"}):Y.Ru._({id:"jwO7L7"}),status:"success",duration:5e3,isClosable:!0,position:"top"})},S=(0,I.useMemo)(()=>(0,U.LN)({docTitle:null==n?void 0:n.title,docId:null==n?void 0:n.id,token:null==g?void 0:g.token,absolute:!0}),[n,null==g?void 0:g.token]),k=!!g,E=s&&r&&k,_=(0,i.jsx)(e2.w,{onClose:a,onOpen:l,segmentEvent:eC.VV.GAMMA_PRO_UPSELL_SHARE_SETTINGS_REMOVE_WATERMARK,doc:n});return(0,i.jsxs)(i.Fragment,{children:[s&&(0,i.jsxs)(eG,{showDivider:!1,children:[(0,i.jsx)(eF,{title:x?(0,i.jsx)(C.x6,{id:"gbBlJ4"}):(0,i.jsx)(C.x6,{id:"qZu20V"}),subtitle:j?Y.Ru._({id:"vMZPZT"}):(0,i.jsx)(t3,{subtitle:h[v].subtitle,tooltipLabel:h[v].tooltip,ariaLabel:h[v].subtitle,icon:b.mEO}),img:(0,i.jsx)(el,{icon:x?b.OKD:b.CQO,showDisabled:j}),isDisabled:!E,disabledText:eM[ez.NoAccess].title(),permissionsControl:(0,i.jsx)(eD,{selected:v,options:[$.aXG.Edit,$.aXG.Comment,$.aXG.View,ez.NoAccess],onClick:e=>{var t,i;let r=null==g?void 0:g.id,o={id:n.id,accessLinks:e===ez.NoAccess?[{permission:null}]:[{permission:e}]},l=()=>f({variables:o,refetchQueries:["GetDoc"],optimisticResponse:{updateDoc:{...o,accessLinks:[{__typename:"AccessLink",id:r||"temp-id",permission:e===ez.NoAccess?null:e}],__typename:"Doc"}}}),a=()=>{w(e===ez.NoAccess?"removed":"updated")()},s=()=>{p((0,z.oe)(n.title))},d=null==(t=n.file)?void 0:t.searchEngineIndexingEnabled,c=null==(i=n.file)?void 0:i.id;d&&c&&e===ez.NoAccess?y({variables:{fileId:c,enable:!1},refetchQueries:["GetDoc"]}).then(l).then(()=>{a(),s()}):l().then(a)}})}),(0,i.jsx)(W.S,{animateOpacity:!0,in:!!(null==g?void 0:g.permission),children:(0,i.jsx)(t8.X,{url:S,paddingLeft:u?32:void 0,customLabel:Y.Ru._({id:"y1eoq1"}),onClick:()=>{(0,P.d)({docId:n.id,source:"sharePanel",type:"tokenUrl"})}})})]}),m?(0,i.jsx)(t1.n,{defaultIndex:[0],allowToggle:!0,borderRadius:"md",borderColor:"transparent",mb:4,children:(0,i.jsxs)(t6.A,{children:[(0,i.jsxs)(t2.J,{children:[(0,i.jsx)(c.a,{as:"span",flex:"1",textAlign:"start",fontWeight:"600",children:(0,i.jsx)(C.x6,{id:"VNgKZz"})}),(0,i.jsx)(t5.Q,{})]}),(0,i.jsxs)(t4.v,{children:[_,(0,i.jsx)(t9,{onClose:a,onOpen:l||(()=>{}),segmentEvent:eC.VV.GAMMA_PRO_UPSELL_SHARE_SETTINGS_SEARCH_ENGINE_INDEXING,doc:n,accessLinkEnabled:!j}),(0,i.jsx)(tZ,{onClose:a,onOpen:l,segmentEvent:eC.VV.GAMMA_PRO_UPSELL_SHARE_SETTINGS_SET_PASSWORD,doc:n,isDark:d,accessLinkEnabled:!j})]})]})}):_]})},nt=e=>{let{visibility:t,isFromOtherOrg:n}=e,r=(0,ed.dU)("white","var(--chakra-colors-gray-800)");return(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)(j.g,{icon:b.AQM}),(0,i.jsxs)(c.a,{as:"span",className:"fa-layers fa-fw",children:[(0,i.jsx)(j.g,{icon:t.primaryIcon}),t.secondaryIcon&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.g,{icon:ti.GEE,color:r,transform:"down-6 right-6"}),(0,i.jsx)(j.g,{icon:t.secondaryIcon,transform:"shrink-7 right-6 down-6"})]})]})]})},nn={edit:(0,i.jsx)(C.x6,{id:"RGu+kO"}),comment:(0,i.jsx)(C.x6,{id:"4xnd7M"}),view:(0,i.jsx)(C.x6,{id:"8WmxwF"}),noAccess:(0,i.jsx)(C.x6,{id:"Lkjre5"}),workspaceAccess:(0,i.jsx)(C.x6,{id:"k/3XD1"})},ni=(0,R.A)(e=>{var t,n;let{doc:R,editor:F,isSharePanelOpen:W,onSharePanelClose:G,onSharePanelOpen:V,onAnalyticsPanelOpen:H,view:q,setView:K,showAnalytics:Y=!0,showSharePublic:X=!0,showEmbed:J=!0,showSiteSettings:$=!0,cardRangesInput:Z="",setCardRangesInput:Q}=e,ee=(0,O.rd)(),et=(0,_.Fd)(),{openSiteSettings:en}=(0,N.ip)(),ei=(0,A.u)("mobileSharePanel"),er=null==R||null==(t=R.accessLinks)?void 0:t[0],eo=null==er?void 0:er.permission,el=(0,I.useMemo)(()=>(0,U.LN)({docTitle:null==R?void 0:R.title,docId:null==R?void 0:R.id,token:null==er?void 0:er.token,absolute:!0}),[R,null==er?void 0:er.token]),{hasCopied:ea,onCopy:es}=(0,r.i)(el),ed=(0,o.d)(),ec="link-copied-toast",eu=(0,I.useRef)(!1),{user:ep,currentWorkspace:eh,isGammaAdminUser:em}=(0,L.ur)(),{isConnected:eg}=(0,k.u)(),ex=(0,L.Iy)("manage",R)||em,ef=(0,L.Iy)("comment",R)||em,ey=(0,L.Iy)("edit",R)||em,{isOpen:ev,onClose:eb}=(0,E.E)({id:"create-site-modal"}),ej=R&&R.site&&R.site.routes.length>1,ew=R&&(0,D.dv)(R.site),eC=(0,T.zI)({showInvite:ey,showExport:ef,showSharePublic:X&&ex&&!ew,showEmbed:J&&ex&&!ew}),eI=ex&&H&&R&&!ew,[eS,ek]=(0,I.useState)(()=>()=>Promise.resolve()),eA=(0,I.useCallback)(()=>{G(),eb()},[G,eb]),eE=R?ej?R.site.name:R.title:null,e_=(0,I.useCallback)(()=>{eS().then(()=>{K("invite"),Q&&Q(""),G()},()=>{console.debug("[handleSharePanelClose] CollaboratorSearchBar rejected \uD83D\uDC4E\uD83C\uDFFC")})},[K,Q,G,eS]),eR=(0,I.useCallback)(()=>{H&&(G(),H())},[H,G]),eP=(0,I.useCallback)(()=>{en("domains"),G()},[G,en]);if(!ep)return null;let eT=(0,z.ZP)(R,ep),ez=eT?(0,z.bC)()[eT]:null,eM=(0,z.D5)(R,eh);if(R&&null===ez)return console.error("[SharePanel] Unknown VisibilityValue for doc",R),null;let eD=null==R||null==(n=R.organization)?void 0:n.id;!R||eD||eu.current||(console.error("[SharePanelModal] Doc unexpectedly doesnt have a workspaceId",{docId:R.id,organization:R.organization}),eu.current=!0);let eO=eC.find(e=>e.key===q)||eC[0],eL=eC.length>1&&eO,eN=R&&null!==R.orgAccess,eB=nn[null!=eo?eo:eN?"workspaceAccess":"noAccess"];return ei&&(0,B.Xb)()?(0,i.jsx)(t0,{isSharePanelOpen:W,closeIfReady:e_,doc:R,editor:F,handleViewAnalyticsClick:eR,showAnalytics:Y&&eI}):(0,i.jsxs)(w.L8,{isDark:ee,children:[(0,i.jsxs)(l.aF,{onEsc:e_,isOpen:W,onClose:G,trapFocus:!0,size:"3xl",returnFocusOnClose:!1,children:[(0,i.jsx)(a.m,{}),(0,i.jsxs)(s.$,{"data-share-panel-modal-content":!0,mx:2,children:[(0,i.jsxs)(d.r,{children:[ez&&(0,i.jsx)(c.a,{as:"span",me:3,children:(0,i.jsx)(nt,{visibility:ez,isFromOtherOrg:eM})}),eE?(0,i.jsx)(C.x6,{id:"sit2to",values:{displayName:eE}}):(0,i.jsx)(C.x6,{id:"Z8lGw6"})]}),(0,i.jsx)(u.s,{"data-share-panel-close-button":!0,onClick:e=>{e.preventDefault(),e_()}}),(0,i.jsx)(p.c,{}),R?(0,i.jsx)(h.c,{"data-testid":"share-panel-modal-body",children:R&&eD&&(0,i.jsxs)(i.Fragment,{children:[eL&&(0,i.jsxs)(m.B,{direction:"row",alignItems:"center",my:4,children:[(0,i.jsx)(S.x,{selectedOption:eO,setSelectedOption:e=>K(e.key),options:eC,dropdownButtonLeftIcon:eO.icon,breakpoints:{base:!0,md:!1}}),ex&&$&&!(null==R?void 0:R.site)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.h,{}),(0,i.jsx)(f.$,{flexShrink:0,onClick:eP,variant:"plain",size:"sm",alignSelf:"flex-start",children:(0,i.jsx)(C.x6,{id:"sAalO9"})})]})]}),(!ef||"invite"==q)&&(0,i.jsx)(eQ,{workspaceId:eD,doc:R,user:ep,setVerifySearchDone:ek,canManage:ex,isFromOtherOrg:eM,isMultipage:ej,isDark:ee}),ex&&"public"===q&&(0,i.jsx)(ne,{doc:R,isConnected:eg,onSharePanelOpen:V,onSharePanelClose:G,canManage:ex,isDark:ee}),ex&&"embed"===q&&(0,i.jsx)(e5,{doc:R,onSharePanelOpen:V,onSharePanelClose:G}),ef&&"export"===q&&(0,i.jsx)(tp,{doc:R,editor:F,onSharePanelOpen:V,onSharePanelClose:G,isMultipage:ej,cardRangesDefault:Z})]})}):(0,i.jsx)(h.c,{pb:6,"data-testid":"share-panel-modal-body",children:(0,i.jsxs)(m.B,{children:[(0,i.jsx)(g.E,{height:"55px"}),(0,i.jsx)(g.E,{height:"55px"}),(0,i.jsx)(g.E,{height:"55px"}),(0,i.jsx)(g.E,{height:"55px"})]})}),(0,i.jsx)(p.c,{}),(0,i.jsx)(y.j,{children:(0,i.jsxs)(v.s,{justifyContent:"space-between",flex:1,children:[Y&&eI&&(0,i.jsx)(f.$,{isDisabled:!eg,leftIcon:(0,i.jsx)(j.g,{icon:b.q9c}),variant:"ghost",onClick:eR,children:(0,i.jsx)(C.x6,{id:"YaUqUV"})}),(0,i.jsx)(x.h,{}),ew?(0,i.jsx)(f.$,{onClick:e=>{e.preventDefault(),e_()},variant:"solid","data-share-panel-done-button":!0,children:(0,i.jsx)(C.x6,{id:"DPfwMq"})}):(0,i.jsx)(w.Tz,{label:eB,isDisabled:!R,children:(0,i.jsx)(c.a,{children:(0,i.jsx)(f.$,{leftIcon:(0,i.jsx)(j.g,{icon:ea?b.e68:b.KTq}),isDisabled:!R,onClick:e=>{R&&(e.preventDefault(),es(),ed.isActive(ec)||ed({id:ec,title:(0,i.jsx)(C.x6,{id:"pQjjYo"}),status:"success",duration:5e3,position:"top"}),(0,P.d)({docId:R.id,source:"sharePanel",type:"tokenUrl"}))},variant:"ghost",children:(0,i.jsx)(C.x6,{id:"y1eoq1"})})})})]})})]})]}),(null==R?void 0:R.id)&&et&&ex&&(0,i.jsx)(M.B,{isOpen:ev,onClose:eA,existingDoc:R})]})})},49405:(e,t,n)=>{"use strict";n.d(t,{Z:()=>x});var i=n(6029),r=n(46898),o=n(19564),l=n(81278),a=n(55729),s=n(88586),d=n(88571),c=n(38055),u=n(95889),p=n(20715),h=n(82927),m=n(51817),g=n(72492);let x=()=>{let[e]=(0,s.aXl)({refetchQueries:["GetDocs"]}),{push:t}=(0,l.useRouter)(),n=(0,r.d)(),{user:x,currentWorkspace:f}=(0,h.ur)(),y=(0,u.st)();return(0,a.useCallback)(async r=>{var l;let{docId:a,docTitle:s,fileId:h,initialContent:v,channelId:b,source:j,openThemeEditor:w,onSuccess:C,newWindow:I,path:S}=r,k=null==x||null==(l=x.settings)?void 0:l.needsEditorOnboarding;if(!a)return Promise.reject(Error("Cannot duplicate without a docId"));let A=n({id:"duplicate-toast-".concat(a),isClosable:!1,position:"top",status:"loading",colorScheme:"gray",duration:null,title:(0,i.jsx)(o.x6,{id:"OvEjsP"})});return x&&(null==f?void 0:f.id)?e({variables:{duplicateDocInput:{orgId:null==f?void 0:f.id,sourceDocId:a,source:d.a[j],fileId:h,path:S,initialContent:v?{ydoc:(0,g.p0)(v),schemaVersion:m.f$,editors:[null==x?void 0:x.id]}:void 0,...b?{channels:[{channelId:b}]}:{}}}}).then(e=>{var r,l,d;if(!(null==e||null==(r=e.data)?void 0:r.duplicateDoc))throw Error("No data received");null==y||y.track(u.VV.EXAMPLE_DUPLICATED,{doc_id:a,title:s,source:j});let h=null==e||null==(d=e.data)||null==(l=d.duplicateDoc)?void 0:l.id;(0,p.c)({doc_id:h,source:j,source_doc_id:a}),console.debug("[Duplicate.".concat(j,"] Doc duplicated New doc id (").concat(h,"). Navigating to Editor")),n.update(A,{status:"success",description:(0,i.jsx)(o.x6,{id:"zzDlyQ"}),duration:5e3,isClosable:!0});let m=w?"/docs/".concat(h).concat(w?"?openThemeEditor=true":""):k?"/docs/".concat(h,"?").concat(c.y,"=true"):"/docs/".concat(h);I?window.open(m,"_blank"):t(m),C&&h&&C(h)},e=>{console.error("[Duplicate.".concat(j,"] Error duplicating doc:"),e.message),n.update(A,{title:(0,i.jsx)(o.x6,{id:"ADJtFi"}),description:e.message,status:"error",duration:null,isClosable:!0})}).catch(e=>{console.error("[Duplicate.".concat(j,"] Error duplicating doc:"),e.message),n.update(A,{title:(0,i.jsx)(o.x6,{id:"ADJtFi"}),description:e.message,status:"error",duration:null,isClosable:!0})}):(console.error("[Duplicate.".concat(j,"] Cannot duplicate without a user or workspace"),{user:x}),Promise.reject(Error("Cannot duplicate without a user or workspace")))},[null==f?void 0:f.id,x,n,e,y,t])}},51817:(e,t,n)=>{"use strict";n.d(t,{f$:()=>r}),n(64072);let i=new URLSearchParams(window.location.search),r=(i.get("SCHEMA_VERSION")?Number(i.get("SCHEMA_VERSION")):null)||124},53505:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var i=n(76644);let r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.replaceAll(/\s|\\|\./g,"-").replaceAll(/-+/g,"-").replaceAll(/[/-]{2,}/g,"/").replaceAll(/(^[/-])|([/-]$)/g,"");return"/".concat(t)},o=e=>{var t;let{docId:n,path:o,file:l}=e,a=r(o),s=null!=(t=l.pages)?t:[];if(!s.find(e=>e.id!==n&&e.path===a))return a;let{prefix:d,count:c}=(0,i.B)(a),u=null===c?1:c;return s.forEach(e=>{if(!e.path||e.path.slice(0,d.length)!==d)return;let{count:t}=(0,i.B)(e.path);t&&t>=u&&(u=t+1)}),"".concat(d,"-").concat(u)}},53932:(e,t,n)=>{"use strict";n.d(t,{I:()=>f,O:()=>y});var i=n(6029),r=n(49611),o=n(26420),l=n(27229),a=n(58959),s=n(48810),d=n(48621),c=n(77650),u=n(55729),p=n(88586),h=n(14322),m=n(70006),g=n(41471);let x=e=>{let{label:t,ariaLabel:n,icon:l,iconColor:a,isLoading:s,handler:c}=e;return(0,i.jsx)(r.$,{variant:"plain",size:"md","aria-label":n,onClick:c,leftIcon:(0,i.jsx)(o.a,{color:a,children:(0,i.jsx)(d.g,{icon:l})}),boxShadow:"none",isLoading:s,isDisabled:s,_hover:{boxShadow:"md",borderColor:a},children:t})},f=()=>new BroadcastChannel("social_post"),y=e=>{var t;let{doc:n,exportMode:r,cardRangesInput:o}=e,{isOpen:d,onOpen:y,onClose:v}=(0,l.j)({id:"linkedin-post-modal"}),{data:b,loading:j}=(0,p.kvr)(),w=null==b||null==(t=b.userIntegrations)?void 0:t.integrations;return(0,u.useEffect)(()=>f().addEventListener("message",e=>{"true"===e.data.success&&"linkedin"===e.data.platform&&y()}),[y]),(0,i.jsxs)(a.z,{children:[(0,i.jsx)(x,{label:(0,i.jsx)(s.E,{children:g.L.linkedin.label}),isLoading:j,ariaLabel:g.L.linkedin.cta(),icon:g.L.linkedin.icon,iconColor:g.L.linkedin.iconColor,handler:()=>(null==w?void 0:w.includes(p.n30.Linkedin))?y():(0,h.GE)({url:(0,m.n$)(),title:c.Ru._({id:"Abf1Uw"}),w:800,h:600})}),d&&(0,i.jsx)(g.A,{isSocialPostModalOpen:d,onSocialPostModalClose:v,socialPlatform:"linkedin",cardRangesInput:"all"===r?"":o,doc:n})]})}},55252:(e,t,n)=>{"use strict";n.d(t,{U:()=>b});var i=n(74171),r=n(58495),o=n(81278),l=n(55729),a=n(88586),s=n(68301),d=n(343),c=n(58809),u=n(15342),p=n(20715),h=n(32263),m=n(8139),g=n(51817),x=n(49405),f=n(72492),y=n(42721),v=n(70006);let b=()=>{let e=(0,x.Z)(),{user:t,currentWorkspace:n}=(0,y.ur)(),[b]=(0,a.jL_)(),[j]=(0,a.Imo)(),{push:w}=(0,o.useRouter)(),C=(0,d.$)(),I=(0,u.GV)(c.nU),S=(0,s.u)("createFilePage");return(0,l.useCallback)(async o=>{let l,{title:s,path:d,siteId:c,routes:u,sourceDocId:x}=o;if(!d.startsWith("/"))return void console.error("[AddNewPageToSite] Path must start with /. Aborting.",d);if(!(null==n?void 0:n.id)||!c||!u)return;let y={settings:{...m.S9.webpage_fluid.docSettings()},docFlags:{cardLayoutsEnabled:!0},format:"webpage"};if(S&&(null==I?void 0:I.id)&&!x){let{docId:e}=await C({title:s,path:d,documentAttributes:y,file:I}),t=(0,v.pF)({docId:e});return console.debug("[AddPageModal] Doc created. Adding route then navigating to editor",e),await w(t,void 0,{shallow:!0}),e}if(x)await e({docId:x,docTitle:s,source:a.ALe.SitesDuplicatePage,fileId:null==I?void 0:I.id,onSuccess:e=>{l=e},path:d});else{let e=(0,h.k5)(y),i=(0,f.p0)(e),r={title:s,path:d,source:a.ALe.SitesAddPage,initialContent:{ydoc:i,schemaVersion:g.f$,editors:[null==t?void 0:t.id]}},{data:o}=await b({variables:{...r,fileId:null==I?void 0:I.id,workspaceId:null==n?void 0:n.id,orgAccess:a.aXG.Manage,mainPage:"/"===d}});l=null==o?void 0:o.createDoc.id,(0,p.c)({doc_id:l,source:a.ALe.SitesAddPage,channel:null})}if(!c||!l)return void console.error("[AddPageModal] Site or doc id is undefined. Cannot add route.");let k=e=>j({variables:{input:{siteId:c,docId:l,path:e,offline:!1}},refetchQueries:["GetSite"]});try{await k(d)}catch(e){if(e instanceof i.K&&(0,a.vIB)(e).find(e=>["duplicate_site_path","duplicate_doc_path"].includes(e)))await k("".concat(d,"-").concat((0,r.Ak)(5)));else throw e}let A=(0,v.pF)({docId:l});return console.debug("[AddPageModal] Doc created. Adding route then navigating to editor",l),await w(A,void 0,{shallow:!0}),l},[null==n?void 0:n.id,j,w,e,b,null==t?void 0:t.id,null==I?void 0:I.id,C,S])}},56450:(e,t,n)=>{"use strict";n.d(t,{a:()=>x,m:()=>f});var i=n(6029),r=n(46898),o=n(19564),l=n(81278),a=n(55729),s=n(88586),d=n(38055),c=n(20715),u=n(32263),p=n(8139),h=n(51817),m=n(72492),g=n(82927);let x={example_deck_clone_toast:s.ALe.DuplicateInspiration,import_google_doc:s.ALe.ImportGoogleDoc,import_google_slides:s.ALe.ImportGoogleSlides,import_docx:s.ALe.ImportDocx,import_pptx:s.ALe.ImportPptx,import_webpage:s.ALe.ImportWebpage,import_pdf:s.ALe.ImportPdf,blank:s.ALe.Blank,template_browser:s.ALe.DuplicateTemplate,get_started_modal:s.ALe.Blank,template_modal_griditem:s.ALe.DuplicateTemplate,template_dashboard_griditem:s.ALe.DuplicateTemplate,template_modal_preview:s.ALe.DuplicateTemplate,template_modal_preview_create_theme:s.ALe.DuplicateTemplate,"slash-new":s.ALe.SlashNew,editor_toolbar_doc_menu_duplicate:s.ALe.DuplicateDoc,dashboard_docs_view_duplicate:s.ALe.DuplicateDoc,ai_generated:s.ALe.AiGenerated,ai_generated_advanced:s.ALe.AiGenerated,sites_add_page:s.ALe.SitesAddPage,sites_copy_to_site:s.ALe.SitesCopyToSite,sites_duplicate_page:s.ALe.SitesDuplicatePage,editor_y_doc_too_large_duplicate:s.ALe.DuplicateDoc,file_add_page:s.ALe.SitesAddPage},f=()=>{let{user:e,currentWorkspace:t}=(0,g.ur)(),[n,{data:f,loading:y}]=(0,s.jL_)(),{push:v,replace:b}=(0,l.useRouter)(),j=(0,r.d)();return[(0,a.useCallback)(r=>{var l;let a=null==e||null==(l=e.settings)?void 0:l.needsEditorOnboarding,s=r.source,g=null==r?void 0:r.channelId,f=(null==r?void 0:r.historyFn)==="replace"?b:v;if(!(null==t?void 0:t.id))return void console.error("[createDocAndNavigate] No currentWorkspace found");let y=r.docSettings||p.S9.deck_default.docSettings(),w=r.format||"deck",C=(null==r?void 0:r.document)?r.document:"empty"==(a?"quickstart":"empty")?(0,u.HC)(e,{settings:{...y},format:w}):(0,u.f$)(e,{settings:{...y},format:w}),I=(0,m.p0)(C);return console.debug("[createDocAndNavigate] Creating doc",{document:C,encodedDocument:I}),n({variables:{workspaceId:null==t?void 0:t.id,title:(null==r?void 0:r.title)||"",source:x[r.source],initialContent:{ydoc:I,schemaVersion:h.f$,editors:[null==e?void 0:e.id]},...g?{channels:[{channelId:g}]}:{}}}).then(async e=>{let{data:t}=e;(0,c.c)({doc_id:null==t?void 0:t.createDoc.id,source:s,channel:g||null}),console.debug("[createDocAndNavigate] Doc created. Navigating to Editor",null==t?void 0:t.createDoc.id),f("/docs/".concat(null==t?void 0:t.createDoc.id).concat(a?"?".concat(d.y,"=true"):""))}).catch(e=>{console.error("[createDocAndNavigate]",e),j({title:(0,i.jsx)(o.x6,{id:"0jT1fA"}),description:e.message,position:"top",status:"error",isClosable:!0,duration:null})})},[n,null==t?void 0:t.id,v,b,j,e]),{data:f,loading:y}]}},58859:(e,t,n)=>{"use strict";n.d(t,{f:()=>k});var i=n(12364),r=n.n(i),o=n(55765),l=n.n(o),a=n(96557),s=n.n(a),d=n(12562),c=n(15342),u=n(73224),p=n(73364),h=n(81404);let m="custom",g="updates",x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},[n]=u.hL(e.db,[g]);return u.UK(n,u.T3(e._dbref,!1)).then(i=>{t(n),h.hL(e.doc,()=>{i.forEach(t=>h.QE(e.doc,t))},e,!1)}).then(()=>u.y7(n).then(t=>{e._dbref=t+1})).then(()=>u.U9(n).then(t=>{e._dbsize=t})).then(()=>n)},f=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return x(e).then(n=>{(t||e._dbsize>=500)&&u.GL(n,h.PR(e.doc)).then(()=>u.yH(n,u.U2(e._dbref,!0))).then(()=>u.U9(n).then(t=>{e._dbsize=t}))})},y=e=>u.MR(e);class v extends p.c{destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(e=>{e.close()})}clearData(){return this.destroy().then(()=>{u.MR(this.name)})}get(e){return this._db.then(t=>{let[n]=u.hL(t,[m],"readonly");return u.Jt(n,e)})}set(e,t){return this._db.then(n=>{let[i]=u.hL(n,[m]);return u.yJ(i,t,e)})}del(e){return this._db.then(t=>{let[n]=u.hL(t,[m]);return u.yH(n,e)})}constructor(e,t){super(),this.doc=t,this.name=e,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=u.P2(e,e=>u.vK(e,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=this._db.then(e=>(this.db=e,x(this,e=>u.GL(e,h.PR(t))).then(()=>(this._destroyed||(this.emit("synced",[this]),this.synced=!0),this)))),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(e,t)=>{if(this.db&&t!==this){let[t]=u.hL(this.db,[g]);u.GL(t,e),++this._dbsize>=500&&(null!==this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{f(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},t.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),t.on("destroy",this.destroy)}}var b=n(43634),j=n(34647),w=n(42542),C=n(25991);let I=(0,j.S)();class S{async enable(){}async disable(){}get enabled(){return I&&((0,C.yy)(this.store.getState())||d.of.get("offlineEditing"))}async loadYDoc(e,t){return this.enabled?!!(0,C.TT)(this.store.getState())[e]&&(this.setup(e,t),!0):(console.warn("Cannot setupForDocLoad when it is not enabled"),!1)}async syncYDoc(e,t){if(!this.enabled)return void console.warn("Cannot setup IndexedDB for doc as it is not enabled");await this.setup(e,t),this.store.dispatch((0,C.GD)({docId:e,lastSynced:new Date().toISOString()}))}setup(e,t){return new Promise(n=>{let i=new v(e,t),o=r()(()=>{let e=t.getMap("SCHEMA_VERSION").get("REQUIRED_VERSION");i.set("lastUpdated",new Date().toISOString()),i.set("schemaVersion",e||"")},1e3);t.on("update",o),i.on("synced",()=>{n()})})}async gc(){let e=Date.now(),t=Object.values(this.syncedYDocs).filter(t=>!!t.lastSynced&&e-new Date(t.lastSynced).getTime()>w.P).map(e=>e.docId),n=(0,b.pn)(this.store.getState());n?this.removeDocs(s()(t,n)):this.removeDocs(t)}async removeDocs(e){if(0===e.length)return;this.store.dispatch((0,C.jk)({docIds:e}));let t=e.map(e=>y(e));await Promise.all(t)}async debug(){return{syncedYdocs:this.syncedYDocs}}get syncedYDocs(){return(0,C.TT)(this.store.getState())}constructor(){this.store=(0,c.KA)()}}let k=l()(()=>new S)},59190:(e,t,n)=>{"use strict";n.d(t,{Br:()=>p,Iy:()=>h,n6:()=>g,td:()=>m});var i=n(55729),r=n(68301),o=n(15342),l=n(43634),a=n(85235),s=n(2031),d=n(7092);let c=e=>Math.random()<=1/e;class u{setupProvider(){this.t1SetupProvider||(this.t1SetupProvider=performance.now())}downloadDoc(){this.t2DownloadDoc||(this.t2DownloadDoc=performance.now())}onCreate(){this.t3OnCreate||(this.t3OnCreate=performance.now())}report(){return null===this.t1SetupProvider||null===this.t2DownloadDoc||null===this.t3OnCreate?null:{downloadDoc:this.t2DownloadDoc-this.t1SetupProvider,onCreate:this.t3OnCreate-this.t2DownloadDoc}}constructor(){this.t1SetupProvider=null,this.t2DownloadDoc=null,this.t3OnCreate=null}}let p=(e,t)=>{let n=(0,o.GV)(l.Cl),r=(0,i.useRef)(n);(0,i.useEffect)(()=>{r.current=n},[n]),(0,i.useEffect)(()=>{if(e)return window.addEventListener("keydown",n,!0),()=>{window.removeEventListener("keydown",n,!0)};function n(e){if(!e.target.closest(".ProseMirror")||!r.current||!c(t))return;let n=performance.now();requestAnimationFrame(()=>{let t=e.key;" "===t&&(t="Space");let i=performance.now()-n;(0,d.I1)({...(0,s.w)(),key:t,duration:i})})}},[e,r,t])},h=()=>{let e=(0,r.u)("rumSampleRate");(0,i.useEffect)(()=>{(0,d.BR)(e)},[e])},m=e=>{let t=(0,i.useCallback)(t=>{let{isFullscreen:n=!1}=t;if(!e)return;let i=performance.now();requestAnimationFrame(()=>{requestAnimationFrame(()=>{let e=performance.now()-i;(0,d.WX)({...(0,s.w)(),toMode:a.w.SLIDE_VIEW,duration:e,isFullscreen:n})})})},[e]);return{recordExitSlideModePerformance:(0,i.useCallback)(t=>{let{isFullscreen:n=!1}=t;if(!e)return;let i=performance.now();requestAnimationFrame(()=>{requestAnimationFrame(()=>{let e=performance.now()-i;(0,d.WX)({...(0,s.w)(),toMode:a.w.DOC_VIEW,duration:e,isFullscreen:n})})})},[e]),recordEnterSlideModePerformance:t}},g=()=>{let[e]=(0,i.useState)(()=>new u),t=(0,i.useCallback)(()=>{e.setupProvider()},[e]),n=(0,i.useCallback)(()=>{e.downloadDoc()},[e]);return{timeOnCreate:(0,i.useCallback)(()=>{e.onCreate();let t=e.report();if(null===t)return void console.warn("[HoneycombDocLoadTimer] failed to generate doc timings");(0,d.Ac)({...(0,s.w)(),duration:t.onCreate}),(0,d.Dx)({...(0,s.w)(),duration:t.downloadDoc})},[e]),timeOnSetupProvider:t,timeOnDownloadDoc:n}}},60120:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var i=n(6029),r=n(48810),o=n(55597),l=n(48621);let a=e=>{let{length:t,idealLength:n,maxLength:a}=e,s=t>=a;return(0,i.jsxs)(r.E,{fontSize:"xs",color:s?"red.400":"gray.500",children:[s&&(0,i.jsx)(l.g,{icon:o.QJT})," ",t,"/",null!=n?n:a]})}},60149:(e,t,n)=>{"use strict";n.d(t,{K:()=>ex});var i=n(6029),r=n(27229),o=n(55729),l=n(73287),a=n(86025),s=n(68301),d=n(69768),c=n(15342),u=n(21088),p=n(42721),h=n(70006),m=n(90456),g=n(67909),x=n(36071),f=n(54731),y=n(3674),v=n(40691),b=n(26385),j=n(48810),w=n(23293),C=n(40452),I=n(58959),S=n(41781),k=n(26420),A=n(57405),E=n(3276),_=n(49611),R=n(64268),P=n(51504),T=n(5221),z=n(99745),M=n(80314),D=n(51684),O=n(99492),L=n(48621),N=n(19564),B=n(77650),U=n(88586),F=n(26814),W=n(6252),G=n(62903),V=n(1079),H=n(99038),q=n(74003),K=n(11390),Y=n(16882),X=n(95889),J=n(84693),$=n(75287),Z=n(60522);let Q=new(n(83747)).b;var ee=n(14473),et=n(86992),en=n(11949),ei=n(88114),er=n(14322);let eo=()=>(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsx)("span",{role:"img","aria-label":B.Ru._({id:"y1ypMV"}),children:""})," ",(0,i.jsx)(N.x6,{id:"y1ypMV"})]}),el=e=>{let{currentProduct:t,targetFeature:n}=e,r="pro"===(n?(0,K.gD)(n):null),o="pro"===t?null:"plus"===t?(0,i.jsx)(N.x6,{id:"A+zoTy"}):(0,i.jsx)(eo,{}),l="pro"===t?(0,i.jsx)(N.x6,{id:"A+zoTy"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{role:"img","aria-label":B.Ru._({id:"MMfapV"}),children:"\uD83D\uDCAA"})," ",(0,i.jsx)(N.x6,{id:"MMfapV"})]});return{plusLabel:o,plusIsHighlighted:"pro"!==t&&"plus"!==t&&!r,proLabel:l,proIsHighlighted:"plus"===t||"pro"===t||r}},ea=(e,t)=>e&&e*(null!=t?t:1),es=e=>{let{insufficientCreditsWarning:t,isUpsellModalOpen:n,closeUpsellModal:r,targetFeature:l}=e,a=(0,J.f)(),d=(0,X.st)(),c=(0,s.u)("upsellUXEnabled_Plus"),u=(0,s.u)("defaultAnnualBilling"),h=(0,$.l)(),S=(0,s.u)("monthlyBillingEnabled"),k=(0,s.u)("plus-credits"),A=(0,p.CX)(),{subscription:E,product:_}=(0,q.I)(),{refetch:R}=(0,p.ur)(),{frequency:P}=(0,K.$Z)(E),[T,z]=(0,o.useState)(u?"yearly":"monthly");(0,o.useEffect)(()=>{P&&z("month"===P?"monthly":"yearly")},[P]);let[M,D]=(0,o.useState)(!1),O=(0,o.useRef)(!1),L=(0,o.useRef)(!1),B=(0,K.A4)(a),W=null==a?void 0:a.id,{selectedProductPrices:V,annualProDiscountPercentage:et,hasSpecialAnnualDiscount:eo,checkoutUrls:es,productPricesPlus:eh,productPricesPro:em}=(0,ei.K)({workspaceId:W,canManageWorkspace:A,selectedBillingCycleKey:T}),eg=c||"plus"===_,ex=A&&es,ef=_&&es&&A,ey=!ex&&!ef,{credits:ev}=(0,F.B9)(),eb=(0,K.ZJ)(E),ej=!_&&S,ew=!A;(0,o.useEffect)(()=>{if(_||!M)return;let e=setInterval(()=>{null==R||R()},1e3);return null==R||R(),()=>{clearInterval(e)}},[M,_,R]),(0,o.useEffect)(()=>{n||(D(!1),z(u?"yearly":"monthly"))},[d,u,n]),(0,o.useEffect)(()=>{var e,t,i,r;!O.current&&!_&&A&&n&&(null==V?void 0:V.pro)&&(null==V?void 0:V.plus)&&(O.current=!0,null==d||d.track(X.VV.GAMMA_PRO_UPSELL_PRODUCTS_VIEWED,{price:null==(e=V.pro)?void 0:e.price,price_plus:null==V||null==(t=V.plus)?void 0:t.price,productPricesPlus:eh,productPricesPro:em,currentProduct:B,products:["pro","plus"],currency:null==(i=V.pro)?void 0:i.currency,frequency:null==(r=V.pro)?void 0:r.frequencyUnit,plus_credits:k,default_annual:u}))},[n,_,B,A,d,V,k,eh,em,u]);let eC=(0,o.useCallback)(e=>{var t,n,i,r;z(e),null==d||d.track(X.VV.GAMMA_PRO_BILLING_CYCLE_CLICK,{price:null==V||null==(t=V.pro)?void 0:t.price,price_plus:null==V||null==(n=V.plus)?void 0:n.price,products:["pro","plus"],currency:null==V||null==(i=V.pro)?void 0:i.currency,frequency:null==V||null==(r=V.pro)?void 0:r.frequencyUnit,billingCycle:e,productPricesPlus:eh,productPricesPro:em})},[d,V,eh,em]),eI=(0,m.U)(),eS=null==eI?void 0:eI.showSubscriptionUpgradeModal,ek=(0,o.useCallback)(e=>()=>{let t="plus"===e?null==V?void 0:V.plus:null==V?void 0:V.pro;if(_){if(!t||"free"===e)return;if("pro"===e){var n,i,o;let e=null==E||null==(o=E.products)||null==(i=o[0])||null==(n=i.productPrice)?void 0:n.frequencyUnit,t=(0,K.cE)(_,e===U.Vd7.Month?"monthly":"yearly");null==eS||eS({newPlan:"pro",newFrequency:e}),null==d||d.track(X.VV.UPGRADE_MODAL_VIEW,{current_plan:t,modal_source:"upsell_modal"}),null==r||r()}else window.open((0,er.AY)(),"_blank");return}if(!es)return;let l=es[e],s=ea(null==t?void 0:t.price,null==a?void 0:a.memberCount),c={price:null==t?void 0:t.price,productPriceId:null==t?void 0:t.id,product:e,currency:null==t?void 0:t.currency,frequency:null==t?void 0:t.frequencyUnit,plus_credits:k,productPricesPlus:eh,productPricesPro:em,workspaceId:W,totalPrice:s};null==d||d.track(X.VV.CHECKOUT_STARTED,c),(0,Y.Zv)(c);let u=(0,er.GE)({url:l,title:"Gamma",w:1200,h:1e3});window.addEventListener("message",n=>{if(n.data.type===Z.g){if(L.current)return;D(!0),setTimeout(()=>{null==u||u.close()},100);let n={price:null==t?void 0:t.price,productPriceId:null==t?void 0:t.id,product:e,currency:null==t?void 0:t.currency,frequency:null==t?void 0:t.frequencyUnit,plus_credits:k,workspaceId:W,totalPrice:s};if(!(null==L?void 0:L.current)){null==d||d.track(X.VV.PURCHASE_COMPLETE,n);let e={...n};(null==t?void 0:t.price)&&(e.price=t.price/(0,K.GP)(t.currency),s&&(e.value=s/(0,K.GP)(t.currency))),(0,G.MX)(e),(0,Y.Ue)(n),L.current=!0}}},!1)},[d,es,r,null==a?void 0:a.memberCount,k,_,eh,em,null==V?void 0:V.plus,null==V?void 0:V.pro,eS,null==E?void 0:E.products,W]);(0,o.useEffect)(()=>Q.on("openUpgradeToProModal",ek("pro")),[ek]);let{plusLabel:eA,plusIsHighlighted:eE,proLabel:e_,proIsHighlighted:eR}=h?el({currentProduct:B,targetFeature:l}):{plusLabel:null,plusIsHighlighted:!1,proLabel:null,proIsHighlighted:!1};return(0,i.jsxs)(g.aF,{isOpen:n,trapFocus:!1,size:M||t?"3xl":"5xl",onClose:r,closeOnEsc:!M,closeOnOverlayClick:!M,children:[(0,i.jsx)(x.m,{}),(0,i.jsxs)(f.$,{m:{base:"0",lg:"4"},bg:"gray.50",borderRadius:"xl","data-id":"upsell-modal",children:[(0,i.jsx)(y.s,{}),V?M?(0,i.jsx)(ec,{isVerifying:!_,product:B,onClick:r}):(0,i.jsx)(v.c,{p:{base:"4",lg:"6"},children:(0,i.jsxs)(b.B,{spacing:4,children:[(0,i.jsxs)(b.B,{flex:1,gap:1.5,children:[t&&(0,i.jsx)(j.E,{color:"red.600",fontSize:{base:"lg",lg:"xl"},fontWeight:"600",textAlign:"center",children:(0,i.jsx)(N.x6,{id:"72xmIi"})}),(0,i.jsx)(w.D,{textAlign:"center",size:"lg",children:t?(0,i.jsx)(N.x6,{id:"q32zjK",values:{PRO_PROPER_NOUN:H.Kc}}):(0,i.jsx)(N.x6,{id:"k51VUg",values:{GAMMA_PROPER_NOUN:H.On}})}),(0,i.jsx)(j.E,{fontSize:{base:"md",lg:"lg"},textAlign:"center",color:"gray.600",children:t&&(0,i.jsx)(N.x6,{id:"0UIIIw",values:{credits:ev}})})]}),ew&&(0,i.jsx)(eu,{}),ej&&(0,i.jsx)(ee.zn,{selectedBillingCycleKey:T,setSelectedBillingCycleKey:eC}),(0,i.jsxs)(b.B,{w:"100%",bgColor:"green.100",p:2,textAlign:"center",align:"center",justify:"center",gap:0,children:[eo&&(0,i.jsxs)(j.E,{color:"green.800",fontWeight:"bold",children:[(0,i.jsx)("span",{role:"img","aria-label":"books",children:"\uD83D\uDCDA"})," ",(0,i.jsx)(N.x6,{id:"qagJ77"})," ",(0,i.jsx)("span",{role:"img","aria-label":"books",children:"\uD83D\uDCDA"})]}),(0,i.jsxs)(j.E,{color:"green.800",fontWeight:eo?"medium":"bold",children:[(0,i.jsx)(N.x6,{id:"u5lEQO",values:{0:(0,er.ZV)(Math.floor(100*et)/100)}})," ",(0,i.jsx)("span",{role:"img","aria-label":"sparkle",children:""})]})]}),(0,i.jsx)(C.s,{pt:4,pb:8,px:8,mx:-5,overflow:{base:"auto",md:"hidden"},sx:{"scroll-snap-type":"x mandatory"},children:(0,i.jsxs)(I.z,{flex:1,h:"100%",align:"stretch",spacing:0,scrollSnapType:"x mandatory",pb:"6",children:[eg&&(0,i.jsx)(en.i,{productKey:"plus",productPrice:"plus"===_?eb:V.plus,isUpgrade:!_,isCurrentProduct:"plus"===_,upgradeDisabled:ey||"plus"===_,onClick:ek("plus"),selectedBillingCycleKey:T,badgeLabel:eA,isHighlighted:eE,leftSideIsRounded:!0,rightSideIsRounded:!!eE}),(0,i.jsx)(en.i,{productKey:"pro",productPrice:"pro"===_?eb:V.pro,isCurrentProduct:"pro"===_,isUpgrade:_?"pro"!==_:void 0,upgradeDisabled:ey||"pro"===_,onClick:ek("pro"),selectedBillingCycleKey:T,badgeLabel:e_,isHighlighted:eR,rightSideIsRounded:!0,leftSideIsRounded:!!eR})]})}),(0,i.jsx)(ep,{})]})}):(0,i.jsx)(ed,{})]})]})},ed=()=>(0,i.jsxs)(v.c,{children:[(0,i.jsxs)(b.B,{w:"100%",px:10,pt:10,children:[(0,i.jsx)(S.E,{height:"60px"}),(0,i.jsx)(S.E,{height:"30px"})]}),(0,i.jsxs)(C.s,{mt:"8",rounded:"xl",px:10,gap:"8",children:[(0,i.jsxs)(b.B,{w:"100%",spacing:4,children:[(0,i.jsx)(S.E,{height:"300px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"})]}),(0,i.jsx)(k.a,{w:{base:"unset",lg:"1px"},minH:"0",h:{base:"1px",lg:"unset"},bg:"gray.50"}),(0,i.jsxs)(b.B,{w:"100%",spacing:4,children:[(0,i.jsx)(S.E,{height:"300px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"}),(0,i.jsx)(S.E,{height:"20px"})]})]})]}),ec=(0,W.r)(e=>{let{isVerifying:t=!1,product:n,onClick:r}=e,o=n?(0,et.Ok)()[n].name:"";return(0,i.jsx)(v.c,{children:t?(0,i.jsxs)(A.T,{py:12,spacing:4,children:[(0,i.jsx)(E.y,{size:"lg"}),(0,i.jsx)(w.D,{variant:"brand",letterSpacing:"tight",size:"lg",fontWeight:"semibold",children:(0,i.jsx)(N.x6,{id:"kzd5yt"})}),(0,i.jsx)(j.E,{children:(0,i.jsx)(N.x6,{id:"Nwo9pM"})})]}):(0,i.jsxs)(A.T,{py:8,spacing:10,children:[(0,i.jsx)(k.a,{color:"green.500",children:(0,i.jsx)(L.g,{icon:D.QRE,size:"4x"})}),(0,i.jsx)(w.D,{variant:"brand",letterSpacing:"tight",size:"lg",fontWeight:"semibold",children:(0,i.jsx)(N.x6,{id:"7Xmwpp"})}),(0,i.jsx)(_.$,{size:"lg",variant:"solid",onClick:r,children:(0,i.jsx)(N.x6,{id:"SGsdhu",values:{GAMMA_PROPER_NOUN:H.On,productName:o}})})]})})},!1),eu=()=>(0,i.jsxs)(R.F,{status:"warning",children:[(0,i.jsx)(P._,{}),(0,i.jsxs)(b.B,{spacing:"0.5",children:[(0,i.jsx)(T.X,{fontSize:"lg",children:(0,i.jsx)(N.x6,{id:"4Y1tbj"})}),(0,i.jsx)(z.T,{children:(0,i.jsx)(N.x6,{id:"B18q9c"})})]})]}),ep=()=>(0,i.jsxs)(b.B,{spacing:"4",children:[(0,i.jsxs)(j.E,{fontSize:"sm",color:"gray.600",textAlign:"center",children:[(0,i.jsx)(N.x6,{id:"ZdTirz",components:{0:(0,i.jsx)(L.g,{icon:O.DW4,fixedWidth:!0})}})," ","\xb7"," ",(0,i.jsx)(N.x6,{id:"u5BmMM",components:{0:(0,i.jsx)(L.g,{icon:O.gSF,fixedWidth:!0})}})," ","\xb7"," ",(0,i.jsx)(N.x6,{id:"21GX3a",components:{0:(0,i.jsx)(L.g,{icon:O.qcK,fixedWidth:!0})}})]}),(0,i.jsx)(j.E,{fontSize:"sm",color:"gray.600",textAlign:"center",children:(0,i.jsx)(M.N,{href:V.C.UPGRADE_TO_PAID,isExternal:!0,textDecoration:"underline",color:"gray.700",textAlign:"center",children:(0,i.jsx)(N.x6,{id:"xxFvzx"})})})]});var eh=n(28843),em=n(84287);let eg="get-gamma-pro",ex=e=>{var t,n;let{children:g}=e,{currentWorkspace:x,isUserLoading:f}=(0,p.ur)(),[y,v]=(0,o.useState)(!1),[b,j]=(0,o.useState)(),w=(0,u.st)(),C=(0,s.u)("upsellUXEnabled_Pro"),{data:I,refetch:S}=(0,l.wJf)({variables:{workspaceId:null==x?void 0:x.id,includeExpired:!0},skip:!(null==x?void 0:x.id)}),k=null==I?void 0:I.subscription;(0,a.yf)({subscription:k,workspace:x,autoLaunch:!0});let{data:A}=(0,l.sdf)({variables:{workspaceId:null==x?void 0:x.id},skip:!x}),E=null==A||null==(t=A.products)?void 0:t.find(e=>"pro"===e.key),_=null==E||null==(n=E.prices)?void 0:n.find(e=>e.frequencyUnit===l.Vd7.Year),R=(0,K.A4)(x),{isOpen:P,onOpen:T,onClose:z}=(0,r.j)({id:"upsell-modal"}),M=(0,o.useRef)(null),D=(0,o.useCallback)(e=>{let{onOpenCallback:t,onCloseCallback:n,insufficientCreditsWarning:i,targetFeature:r,segmentEvent:o,eventProperties:l}=e;C&&(v(!!i),j(r),null==t||t(),T(),null==w||w.track(o,l),M.current=n||null)},[w,T,C]),O=(0,o.useCallback)(()=>{var e;null==M||null==(e=M.current)||e.call(M),z(),M.current=null,v(!1),j(void 0)},[z]),[L,N]=(0,o.useState)({openUpsellModal:D,product:R,subscription:k,proYearlyProductPrice:_});(0,o.useEffect)(()=>{"true"===(0,h.sF)()[eg]&&!f&&x&&(T(),(0,d.g5)({query:{...(0,h.sF)(),[eg]:void 0},emitChange:!1}))},[T,x,f]);let{isOpen:B}=(0,c.GV)(eh.Pd);return(0,o.useEffect)(()=>{N({openUpsellModal:D,refetchSubscription:S,product:R,subscription:k,proYearlyProductPrice:_})},[D,R,k,_,S]),(0,i.jsxs)(em.H.Provider,{value:L,children:[g,P&&(0,i.jsx)(es,{insufficientCreditsWarning:y,isUpsellModalOpen:P,closeUpsellModal:O,targetFeature:b}),B&&(0,i.jsx)(m.t,{}),(0,i.jsx)(a.XE,{})]})}},61121:(e,t,n)=>{"use strict";n.d(t,{GO:()=>E,h3:()=>A,wn:()=>R,SS:()=>_,ZY:()=>D,er:()=>k,Gi:()=>z});var i=n(21938),r=n(22905),o=n(63867),l=n(97255),a=n(15342),s=n(43634),d=n(85235),c=n(33201),u=n(29608),p=n(67864);let h=e=>"buttonGroup"===e.type.name;var m=n(86958),g=n(6845),x=n(94922),f=n(98968),y=n(55424),v=n(60300),b=n(56124),j=n(85570),w=n(60122),C=n(56603);let I=()=>({absPositions:[],relPositions:[]});class S{getPositions(e){return e?this.presentModePositions:this.editModePositions}apply(e,t){let n=e.getMeta(j.g);if(n)switch(n.type){case"addAnimationPositions":this.addAnimationPositions(n.pos,t,n.isPresentMode);break;case"resetAnimationPositions":this.resetAnimationPositions(n.isPresentMode);break;case"enableAnimations":this.enabled=n.enabled;break;default:console.warn("AnimationsState: unknown action type",n)}return this}addAnimationPositions(e,t,n){let i=this.getPositions(n),r=Math.max(...i.absPositions);e.forEach(e=>{if(e<=r)return;i.absPositions.push(e);let n=(0,C.JO)(t,e);n&&i.relPositions.push(n)})}resetAnimationPositions(e){e?this.presentModePositions=I():this.editModePositions=I()}getAnimationPositionsAbs(e,t){let n=w.pJ.getState(e),i=this.getPositions(t);return n?i.relPositions.map(t=>(0,C.d_)(e,t)).filter(Boolean):i.absPositions}constructor(){this.enabled=!0,this.presentModePositions=I(),this.editModePositions=I()}}let k="animate-has-animated",A="animatable-on-load",E="animatable-on-load-as-block",_="animatable-on-load-content-parent",R="animatable-on-load-content-child",P=e=>{switch(e.type.name){case"card":return!0===(0,g.Wq)(e);case"cardAccentLayoutItem":return(0,x.wL)(e);case"calloutBox":case"gallery":case"smartLayout":case"divider":return!0;case"smartDiagram":return!(0,u.nr)();default:return(0,v.Rj)(e)}},T=(e,t)=>(0,y.q)(e)||(0,f.qK)(t),z=(e,t)=>{let n=e.view.state.doc.resolve(t);if(!n)return;let i=e.state.doc.nodeAt(t);if(i&&P(i)&&!T(i,n)){let e=i.isLeaf||i.isAtom?0:-1;return{pos:n.pos+e,start:n.pos,depth:n.depth,node:i}}return(0,r.eL)(n,P)},M=(e,t)=>{let n=t.getAnimationPositionsAbs(e,(0,s.wC)((0,a.KA)().getState())===d.w.SLIDE_VIEW).reduce((e,t)=>Math.max(e,t),0),i=e.doc.nodeAt(n),r=i&&n>0?i.nodeSize:0;return n+r},D=()=>new o.k_({key:j.g,state:{init:()=>new S,apply:(e,t,n,i)=>t.apply(e,i)},props:{decorations(e){let t=[],n=this.getState(e);if(!1===n.enabled)return l.zF.create(e.doc,t);let r=M(e,n);return e.doc.descendants((n,o,a,s)=>{let d=e.doc.resolve(o),u=P(n)||T(n,d);if(o<r&&u&&t.push(l.NZ.node(o,o+n.nodeSize,{class:k})),(0,y.M)(n)||(0,f.Pb)(n))t.push(l.NZ.node(o,o+n.nodeSize,{class:_}));else if(h(n)||(0,m.q)(n)||(0,b.hj)(n))t.push(l.NZ.node(o,o+n.nodeSize,{class:E}));else if(T(n,d))t.push(l.NZ.node(o,o+n.nodeSize,{class:R,style:"--animate-index: ".concat(s+1)}));else if(P(n)){let e=!!a&&(0,p.Ti)(n,a),r=n.isAtom;t.push(l.NZ.node(o,o+n.nodeSize,{class:(0,i.cx)(A,e&&"animatable-on-load-annotatable",r&&"animatable-on-load-atom")})),(0,x.wL)(n)&&t.push(l.NZ.node(o,o+n.nodeSize,{class:"animatable-on-load-accent"}))}return!((0,c.jg)(n)&&d.depth>1||(0,y.q)(n)||h(n)||(0,m.q)(n)||(0,b.hj)(n))}),l.zF.create(e.doc,t)}}})},62997:(e,t,n)=>{"use strict";n.d(t,{YP:()=>c,eD:()=>d,mc:()=>s,oP:()=>a});var i=n(6029),r=n(19564),o=n(77650),l=n(88586);let a=1,s=()=>o.Ru._({id:"cyLJM2"}),d=()=>o.Ru._({id:"6h5uMS"}),c={[l.KPK.Admin]:{title:(0,i.jsx)(r.x6,{id:"U3pytU"}),description:(0,i.jsx)(r.x6,{id:"U4MLdj"})},[l.KPK.Member]:{title:(0,i.jsx)(r.x6,{id:"OvoEq7"}),description:(0,i.jsx)(r.x6,{id:"nslZjr"})}}},69764:(e,t,n)=>{"use strict";n.d(t,{R:()=>c,k:()=>d});var i=n(83817),r=n.n(i),o=n(55729),l=n(15342),a=n(43634),s=n(60300);let d=e=>{let t=(0,l.GV)(a.FI,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r()(...t)});return(0,o.useMemo)(()=>({enabled:!!(e&&t&&(0,s.UE)(e,t)),pos:null==t?void 0:t.pos}),[e,t])},c=e=>{let t=(0,l.GV)(a.e4),n=(0,l.GV)(a._I,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r()(...t)});(0,o.useEffect)(()=>{if(!e||!t||!n)return;console.debug("[useScrollAndSpotlightSync] collaboratorBeingFollowed spotlight or scroll changed",JSON.stringify(n,null,2));let{spotlight:i,scroll:r}=n;e.commands.syncSpotlightAndScroll({spotlight:i,scroll:r,scrollOffset:100,isFollowing:!0})},[e,t,n])}},74127:(e,t,n)=>{"use strict";n.d(t,{u:()=>a});var i=n(6029),r=n(74158),o=n(20011),l=n(10817);let a=e=>{let{...t}=e,{reduxData:n,...a}=t,s=(0,o.F)(n);return(0,i.jsx)(r.Kq,{store:s,children:(0,i.jsx)(l.b,{...a,readOnly:!0,isStatic:!0,animationsEnabled:!1})})}},77711:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});let i=new(n(63867)).hs("autocompleteButton")},78116:(e,t,n)=>{"use strict";n.d(t,{Q:()=>l});var i=n(22905),r=n(61121),o=n(85570);let l=i.YY.create({name:"animations",addOptions:()=>({}),addCommands:()=>({addAnimationPositions:(e,t)=>n=>{let{state:i,dispatch:r}=n;return r&&i.tr.setMeta(o.g,{type:"addAnimationPositions",isPresentMode:t,pos:e}),!0},enableAnimations:e=>t=>{let{state:n,dispatch:i}=t;return i&&n.tr.setMeta(o.g,{type:"enableAnimations",enabled:e}),!0},resetAnimationPositions:e=>t=>{let{state:n,dispatch:i}=t;return i&&n.tr.setMeta(o.g,{type:"resetAnimationPositions",isPresentMode:e}),!0}}),addProseMirrorPlugins:()=>[(0,r.ZY)()]})},79536:(e,t,n)=>{"use strict";n.d(t,{e:()=>ex});var i=n(6029),r=n(10500),o=n(24302),l=n(58959),a=n(48810),s=n(46898),d=n(27229),c=n(90394),u=n(40452),p=n(26420),h=n(49611),m=n(29810),g=n(19564),x=n(77650),f=n(97832),y=n(67604),v=n(55729),b=n(73867),j=n(74892),w=n(88586),C=n(99038),I=n(95889),S=n(78140),k=n(36999),A=n(16936),E=n(12514),_=n(41283),R=n(6760),P=n(85595),T=n(99492),z=n(55597),M=n(48621),D=n(91106),O=n(59426),L=n(95695),N=n(91792);let B=(0,v.memo)(e=>{let{theme:t}=e,n=(0,N.iW)({theme:t}),r=t.name.replace(L.M8,"");return(0,i.jsxs)(S.W,{isLazy:!0,children:[(0,i.jsx)(k.I,{as:A.K,isRound:!0,size:"xs",variant:"ghost",colorScheme:"blackAlpha",icon:(0,i.jsx)(M.g,{icon:T.Dwc}),onClick:e=>e.stopPropagation(),children:(0,i.jsx)(g.x6,{id:"7L01XJ"})}),(0,i.jsx)(E.Z,{children:(0,i.jsxs)(_.c,{zIndex:"modal",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)(p.a,{px:4,py:0,maxWidth:"300px",children:[(0,i.jsx)(a.E,{noOfLines:3,children:r}),t.createdTime&&(0,i.jsx)(a.E,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,i.jsx)(g.x6,{id:"MXSt4t",values:{0:(0,O.A)((0,y.A)(t.createdTime),"PPP")}})}),t.createdBy&&(0,i.jsx)(D.Tz,{label:t.createdBy.email,children:(0,i.jsx)(a.E,{display:"inline-block",fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,i.jsx)(g.x6,{id:"t490IT",values:{0:t.createdBy.displayName}})})})]}),(0,i.jsx)(R.N,{}),(0,i.jsx)(P.D,{icon:(0,i.jsx)(M.g,{icon:z.ub2,fixedWidth:!0}),onClick:n,children:(0,i.jsx)(g.x6,{id:"yKu/3Y"})})]})})]})});var U=n(27250),F=n(42721),W=n(70006),G=n(58240),V=n(92699),H=n(91938),q=n(75178),K=n(82927),Y=n(80812);let X=(0,v.memo)(e=>{let{onCustomizeThemeClick:t,onEditThemeClick:n,onSetAsWorkspaceDefaultThemeClick:r,theme:o}=e,{isGammaOrgUser:l,currentWorkspace:a}=(0,F.ur)(),s=(0,Y.fL)(null==a?void 0:a.id),d=l&&"production"!==H.$.APPLICATION_ENVIRONMENT,c=(0,K.CX)(),u=o.id===(null==s?void 0:s.defaultThemeId);return(0,i.jsxs)(S.W,{isLazy:!0,children:[(0,i.jsx)(k.I,{as:A.K,isRound:!0,size:"xs",variant:"ghost",colorScheme:"blackAlpha",icon:(0,i.jsx)(M.g,{icon:T.Dwc}),onClick:e=>e.stopPropagation(),children:(0,i.jsx)(g.x6,{id:"7L01XJ"})}),(0,i.jsx)(E.Z,{children:(0,i.jsxs)(_.c,{zIndex:"modal",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)(P.D,{icon:(0,i.jsx)(M.g,{icon:T.WSb,fixedWidth:!0}),onClick:t,children:(0,i.jsx)(g.x6,{id:"/b0MjO"})}),c&&!u&&(0,i.jsx)(P.D,{icon:(0,i.jsx)(M.g,{icon:T.fyG,fixedWidth:!0}),onClick:r,children:(0,i.jsx)(g.x6,{id:"rbjUma"})}),d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.N,{}),(0,i.jsx)(P.D,{color:"orange.500",icon:(0,i.jsx)(p.a,{boxSize:"4",children:(0,i.jsx)(q.T,{})}),onClick:n,children:"Edit theme"})]})]})})]})});var J=n(74771),$=n(67909),Z=n(36071),Q=n(54731),ee=n(17920),et=n(40691),en=n(80314),ei=n(41781),er=n(16426),eo=n(61204),el=n(3674),ea=n(81278),es=n(58809),ed=n(15342);let ec=e=>{let{theme:t,isOpen:n,onClose:r}=e,{asPath:o}=(0,ea.useRouter)(),[l,s]=(0,v.useState)(),[d,c]=(0,v.useState)(),u=(0,ed.GV)(es.Jo),p=(0,N.n_)({theme:t,showLinkToDashboard:!!u}),{data:m,loading:x}=(0,w.eKT)({variables:{id:null==t?void 0:t.id},skip:!t||"new"===t.id});(0,v.useEffect)(()=>{var e,t;!x&&m&&((null==(e=m.theme)?void 0:e.docCount)&&s(m.theme.docCount),(null==(t=m.theme)?void 0:t.siteCount)&&c(m.theme.siteCount))},[x,m,s,c]);let f=(0,v.useMemo)(()=>{let e=0;return l&&l>0&&(e+=l),d&&d>0&&(e+=d),e},[l,d]);return(0,i.jsxs)($.aF,{closeOnOverlayClick:!1,isOpen:n,onClose:r,size:"lg",children:[(0,i.jsx)(Z.m,{}),(0,i.jsxs)(Q.$,{children:[(0,i.jsx)(ee.r,{children:(0,i.jsx)(g.x6,{id:"oh7Knm",values:{0:t.name}})}),(0,i.jsx)(et.c,{children:f>0?(0,i.jsxs)(a.E,{mb:2,children:[(0,i.jsx)(g.x6,{id:"uSopl9",values:{totalCount:f,GAMMA_ARTIFACT_PROPER_NOUN:C.TP,GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:C.Ix}})," ",(0,i.jsx)(g.x6,{id:"c+lbSJ",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:C.Ix}})," ","/#themes"!==o&&(0,i.jsx)(g.x6,{id:"kLomb7",components:{0:(0,i.jsx)(en.N,{color:"trueblue.500",colorScheme:"trueblue",href:L.fr,textDecoration:"underline",isExternal:!0}),1:(0,i.jsx)(J.p,{mx:"2px"})}})]}):x?(0,i.jsx)(ei.E,{h:"1em",mb:2}):(0,i.jsx)(a.E,{mb:2,children:(0,i.jsx)(g.x6,{id:"KNTN0L",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:C.Ix}})})}),(0,i.jsx)(er.j,{children:(0,i.jsxs)(eo.e,{children:[(0,i.jsx)(h.$,{variant:"ghost",onClick:r,children:(0,i.jsx)(g.x6,{id:"dEgA5A"})}),(0,i.jsx)(h.$,{variant:"hazardous",onClick:()=>{p(),r()},children:(0,i.jsx)(g.x6,{id:"zck3yw"})})]})}),(0,i.jsx)(el.s,{})]})]})},eu=(0,v.memo)(e=>{let{theme:t,openThemeEditorWithThisTheme:n,onDuplicate:r,onShareLink:o,onArchiveThemeModalOpen:l,isArchiveThemeModalOpen:d,onArchiveThemeModalClose:c,hasCustomFonts:u}=e,{canMakeStandard:h,convertToStandard:m}=(0,N._k)(t),{currentWorkspace:x}=(0,K.ur)(),f=(0,Y.fL)(null==x?void 0:x.id),b=(0,K.CX)(),[j]=(0,w.l_E)(),I=(0,s.d)(),z=t.id===(null==f?void 0:f.defaultThemeId),L=(0,v.useCallback)(()=>{(null==x?void 0:x.id)&&j({variables:{input:{id:x.id,defaultThemeId:t.id}},optimisticResponse:{updateWorkspace:{...x,defaultThemeId:t.id}}}).then(()=>{I({title:(0,i.jsx)(g.x6,{id:"jpJi4R"}),description:(0,i.jsx)(g.x6,{id:"9TM+t9",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:C.Ix}}),status:"success",duration:3e3,position:"top"})}).catch(()=>{console.warn("Error updating theme"),I({title:(0,i.jsx)(g.x6,{id:"1sTMTp"}),status:"error",duration:3e3,position:"top"})})},[x,t.id,j,I]);return(0,i.jsxs)(S.W,{isLazy:!0,children:[(0,i.jsx)(k.I,{as:A.K,isRound:!0,size:"xs",variant:"ghost",colorScheme:"blackAlpha",icon:(0,i.jsx)(M.g,{icon:T.Dwc}),onClick:e=>e.stopPropagation(),children:(0,i.jsx)(g.x6,{id:"7L01XJ"})}),(0,i.jsx)(E.Z,{children:(0,i.jsxs)(_.c,{zIndex:"modal",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)(p.a,{px:4,py:0,maxWidth:"300px",children:[(0,i.jsx)(a.E,{noOfLines:3,children:t.name}),t.createdTime&&(0,i.jsx)(a.E,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,i.jsx)(g.x6,{id:"MXSt4t",values:{0:(0,O.A)((0,y.A)(t.createdTime),"PPP")}})}),t.createdBy&&(0,i.jsx)(D.Tz,{label:t.createdBy.email,children:(0,i.jsx)(a.E,{display:"inline-block",fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,i.jsx)(g.x6,{id:"t490IT",values:{0:t.createdBy.displayName}})})})]}),(0,i.jsx)(R.N,{}),(0,i.jsx)(P.D,{icon:(0,i.jsx)(M.g,{icon:T.MT7,fixedWidth:!0}),onClick:n,children:(0,i.jsx)(g.x6,{id:"ePK91l"})}),(0,i.jsx)(P.D,{icon:(0,i.jsx)(M.g,{icon:T.$3n,fixedWidth:!0}),onClick:r,children:(0,i.jsx)(g.x6,{id:"euc6Ns"})}),(0,i.jsxs)(P.D,{icon:(0,i.jsx)(M.g,{icon:T.CQO,fixedWidth:!0}),onClick:o,children:[(0,i.jsx)(g.x6,{id:"RGCCrg"}),u&&(0,i.jsx)(a.E,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,i.jsx)(g.x6,{id:"A8cpC7"})})]}),b&&!z&&(0,i.jsx)(P.D,{icon:(0,i.jsx)(M.g,{icon:T.fyG,fixedWidth:!0}),onClick:L,children:(0,i.jsx)(g.x6,{id:"rbjUma"})}),h&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.N,{}),(0,i.jsx)(P.D,{color:"orange.500",icon:(0,i.jsx)(p.a,{boxSize:"4",children:(0,i.jsx)(q.T,{})}),onClick:m,children:(0,i.jsx)(g.x6,{id:"thLYdn"})})]}),(0,i.jsx)(R.N,{}),(0,i.jsx)(P.D,{color:"red.500",icon:(0,i.jsx)(M.g,{icon:T.Oh6,fixedWidth:!0}),onClick:l,children:(0,i.jsx)(g.x6,{id:"B495Gs"})})]})}),d&&(0,i.jsx)(E.Z,{children:(0,i.jsx)(ec,{theme:t,isOpen:!0,onClose:c})})]})}),ep={transitionProperty:"common",shadow:void 0,padding:2,hoverStyles:{bgColor:"deepocean.50"},themeNamePadding:0},eh={...ep,border:"1px solid",borderColor:"gray.200",borderColorSelected:"sky.600",bgColorSelected:"deepocean.50",hoverStyles:{bgColor:"deepocean.50",borderColor:"deepocean.400"}},em={ghost:ep,"ghost-bordered":eh,outline:{transitionProperty:"none",shadow:"md",padding:0,hoverStyles:{shadow:"lg",bgColor:"gray.50"},themeNamePadding:2}},eg=e=>{let{isChecked:t,name:n}=e,s=(0,o.dU)("trueblue.700","deepocean.300");return(0,i.jsxs)(l.z,{spacing:1,alignItems:"flex-start",children:[t&&(0,i.jsx)(r.S,{w:3,h:"auto",me:1,mt:1,color:s}),(0,i.jsx)(a.E,{fontSize:"sm",noOfLines:1,"data-testid":"theme-name",color:t?s:void 0,overflowWrap:"anywhere",children:n})]})},ex=(0,v.memo)(e=>{var t,n,r,a,S,k;let{theme:A,isChecked:E=!1,variant:_="outline",onThemeClicked:R,disableEditing:P,hasCustomFonts:T=!1,placeholderPadding:z=2,previewHeightEm:M=8,compact:D=!1}=e,O=(0,I.st)(),N=(0,s.d)(),H=em[_],q=(0,v.useRef)(null),K=(0,o.dU)("white","gray.700"),Y=(0,o.dU)("gray.300","gray.600"),J=(0,o.dU)(E?null!=(S=H.bgColorSelected)?S:"deepocean.100":"white",E?"gray.600":"gray.700"),$=(0,o.dU)(H.borderColor,"gray.600"),Z=E?H.borderColorSelected:$,Q=(0,o.dU)(H.hoverStyles.borderColor,null!=(k=H.hoverStyles.borderColor)?k:"gray.500"),ee=E?H.borderColorSelected:Q,et=(0,o.dU)(H.hoverStyles.bgColor,"gray.600"),en=E?J:et,ei=E?void 0:{shadow:H.hoverStyles.shadow,bgColor:en,borderColor:ee},{currentWorkspace:er,user:eo}=(0,F.ur)(),[el]=(0,w.hc)(),[ea]=(0,w.l_E)(),es=(0,v.useCallback)(()=>{(0,V.vd)({theme:A})},[A]),ed=(0,v.useCallback)(()=>{(0,V.L6)({theme:A})},[A]),{isOpen:ec,onOpen:ep,onClose:eh}=(0,d.j)({id:"ArchiveThemeModalDisclosure"}),ex=A.name.replace(L.M8,""),ef=(0,W.sx)({themeId:A.id}),{onCopy:ey}=(0,c.i)(ef),ev=(0,v.useCallback)(()=>{if(!eo||!er)return;let{id:e,...t}=A;el({variables:{id:e},update:(e,t)=>{let{data:n}=t;(null==n?void 0:n.duplicateTheme)&&e.writeQuery({query:w.a83,variables:{workspaceId:A.workspaceId,archived:!1},data:{themes:[n.duplicateTheme]}})},optimisticResponse:{duplicateTheme:{id:"temp",__typename:"Theme",...t,name:"".concat(ex," (copy)"),archived:!1,createdTime:new Date().toISOString(),updatedTime:new Date().toISOString()}}}).then(t=>{let{data:n}=t;if(!n)return;let i=n.duplicateTheme.name;null==O||O.track(I.VV.THEME_DUPLICATED,{theme_id:n.duplicateTheme.id,source_theme_id:e,name:ex}),null==O||O.track(I.VV.THEME_CREATED,{theme_id:n.duplicateTheme.id,name:i,type:"duplicate"}),N({title:x.Ru._({id:"D64sZs",values:{themeName:i}}),status:"success",duration:3e3,position:"top",isClosable:!0}),(0,V.vd)({theme:n.duplicateTheme})}).catch(e=>{console.error("Couldn't duplicate theme ".concat(A.name," error: ").concat(e)),N({title:x.Ru._({id:"aOi88n",values:{err:e}}),status:"error",duration:3e3,position:"top",isClosable:!1})})},[eo,er,A,el,ex,O,N]),eb=(0,v.useCallback)(()=>{(null==er?void 0:er.id)&&ea({variables:{input:{id:er.id,defaultThemeId:A.id}},optimisticResponse:{updateWorkspace:{...er,defaultThemeId:A.id}}}).then(()=>{N({title:(0,i.jsx)(g.x6,{id:"jpJi4R"}),description:(0,i.jsx)(g.x6,{id:"9TM+t9",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:C.Ix}}),status:"success",duration:3e3,position:"top"})}).catch(()=>{console.warn("Error updating theme"),N({title:(0,i.jsx)(g.x6,{id:"1sTMTp"}),status:"error",duration:3e3,position:"top"})})},[er,A,ea,N]),ej=(0,v.useCallback)(()=>{if(!eo||!er)return;let{name:e}=A;ey(),N({title:(0,i.jsx)(g.x6,{id:"EfkecX",values:{name:e}}),description:(0,i.jsx)(g.x6,{id:"MXBeyi"}),status:"success",duration:5e3,position:"top",isClosable:!0})},[eo,er,A,ey,N]),ew=A.workspaceId&&!!(null==(t=A.createdBy)?void 0:t.displayName)&&!D,eC=!!R,eI=!es||P,{inViewport:eS,dimensions:ek,ref:eA}=(0,G.v)({dimensions:{width:50,height:ew?220:172}}),eE=e=>{q.current=e,eA(e)};if(!1===eS){let e=!D&&ek?"".concat(ek.width,"px"):"".concat(13*M/8,"em"),t=!D&&ek?"".concat(ek.height,"px"):"".concat(M/2,"em");return(0,i.jsxs)(u.s,{ref:eE,bgColor:K,"data-theme-id":A.id,textAlign:"start",borderRadius:"md",outline:"none",minH:t,minW:e,direction:"column",p:z,sx:{contentVisibility:"auto",containIntrinsicSize:"".concat(e," ").concat(t)},children:[(0,i.jsx)(p.a,{minH:"".concat(M,"em"),maxH:"".concat(M,"em"),bg:Y,backgroundImage:j.A.src,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}),(0,i.jsx)(p.a,{w:"100%",p:2*(0===z),pt:ew?5:1,children:(0,i.jsx)(eg,{name:ex,isChecked:E})})]})}let e_=A.updatedTime?(0,f.A)((0,y.A)(A.updatedTime)):"";return(0,i.jsxs)(p.a,{ref:eE,sx:{contentVisibility:"auto",containIntrinsicSize:"13em"},bgColor:J,textAlign:"start",tabIndex:eC?0:void 0,borderRadius:"md",border:H.border,borderColor:Z,transitionProperty:H.transitionProperty,transitionDuration:"normal",outline:"none",onClick:()=>eC?null==R?void 0:R(A):void 0,onKeyPress:e=>{eC&&"Enter"===e.key&&(null==R||R(A))},_hover:eC?ei:void 0,_focus:{boxShadow:E||!eC?void 0:"outline"},shadow:H.shadow,p:H.padding,"data-theme-id":A.id,"data-testid":E?"current-theme-preview":void 0,cursor:eC?"pointer":void 0,role:"group",position:"relative",children:[(0,i.jsx)(U.q,{theme:A,heightEm:M,children:E&&!P&&(0,i.jsx)(h.$,{opacity:0,_groupHover:{opacity:1},transitionProperty:"opacity",transitionDuration:"normal",position:"absolute",bottom:2,insetEnd:2,size:"sm",variant:"solid",onClick:A.workspaceId?es:ed,children:A.workspaceId?(0,i.jsx)(g.x6,{id:"ePK91l"}):(0,i.jsx)(g.x6,{id:"srRMnJ"})})}),(0,i.jsxs)(u.s,{align:"baseline",mt:1,direction:"column",p:H.themeNamePadding,children:[ew&&(0,i.jsx)(u.s,{my:2,children:(0,i.jsx)(eg,{name:ex,isChecked:E})}),(0,i.jsxs)(l.z,{alignItems:"flex-start",w:"100%",children:[ew?(0,i.jsx)(b.S,{createdByYou:(null==(n=A.createdBy)?void 0:n.id)===(null==eo?void 0:eo.id),createdByName:null==(r=A.createdBy)?void 0:r.displayName,createdByProfileImageUrl:null==(a=A.createdBy)?void 0:a.profileImageUrl,timestampDescription:A.updatedTime&&(0,i.jsx)(g.x6,{id:"I8D9c7",values:{formattedThemeUpdateTime:e_}})}):(0,i.jsx)(eg,{name:ex,isChecked:E}),(0,i.jsx)(m.h,{}),eI?null:A.workspaceId&&!A.archived?(0,i.jsx)(eu,{theme:A,openThemeEditorWithThisTheme:es,onDuplicate:ev,onShareLink:ej,onArchiveThemeModalOpen:ep,isArchiveThemeModalOpen:ec,onArchiveThemeModalClose:eh,hasCustomFonts:T}):A.workspaceId&&!0===A.archived?(0,i.jsx)(B,{theme:A}):(0,i.jsx)(X,{onCustomizeThemeClick:ed,onEditThemeClick:es,onSetAsWorkspaceDefaultThemeClick:eb,theme:A})]})]})]})});ex.displayName="ThemePreview"},80812:(e,t,n)=>{"use strict";n.d(t,{qD:()=>T,tv:()=>eG,wB:()=>eM,ix:()=>eP,Jp:()=>eL,ic:()=>ez,wr:()=>eT,OP:()=>tp,oP:()=>K.oP,Fg:()=>eq,Es:()=>e9,Is:()=>ti,HC:()=>tS,N0:()=>e_,FP:()=>ty,EP:()=>tm,bx:()=>P,nl:()=>et,ot:()=>ee,de:()=>X,tq:()=>$,mc:()=>K.mc,eD:()=>K.eD,_t:()=>J,kC:()=>tA,fL:()=>_.f});var i=n(6029),r=n(58959),o=n(96990),l=n(26385),a=n(48810),s=n(78140),d=n(26420),c=n(36999),u=n(49611),p=n(41283),h=n(37930),m=n(48478),g=n(40452),x=n(99492),f=n(48621),y=n(91106),v=n(19564),b=n(77650),j=n(38822),w=n.n(j),C=n(81278),I=n(55729),S=n(82328),k=n(89528),A=n(82927),E=n(45143),_=n(84693);let R=e=>{var t;let{workspace:n,memberCount:s,isMultiline:d=!0}=e,{isConnected:c}=(0,S.u)(),u=(0,_.f)(n.id),p=(0,I.useMemo)(()=>c?u:n,[u,c,n]);return p?(0,i.jsxs)(r.z,{marginInlineEnd:4,children:[(0,i.jsx)(o.e,{name:null==(t=p.name)?void 0:t.replace(/\s/g,""),src:p.logoUrl||void 0,size:"sm",bgColor:p.logoUrl?"transparent":"deepocean.300",color:"white"}),(0,i.jsxs)(l.B,{textAlign:"start",align:"flex-start",justify:"flex-start",spacing:0,...!d?{noOfLines:1}:{},children:[(0,i.jsx)(a.E,{fontSize:"sm",fontWeight:"600",wordBreak:"break-word",m:0,p:0,...!d?{overflow:"hidden",textOverflow:"ellipsis"}:{},minWidth:"0px",children:n.name}),(0,i.jsx)(k.sR,{workspace:n}),!w()(s)&&(0,i.jsx)(a.E,{fontSize:"xs",color:"gray.500",textAlign:"left",children:(0,i.jsx)(v.x6,{id:"F6GBat",values:{memberCount:s}})})]})]}):(0,i.jsx)(i.Fragment,{})},P=()=>{let{user:e,currentWorkspace:t,setCurrentWorkspaceId:n}=(0,A.ur)(),{isConnected:o}=(0,S.u)(),l=(0,E.h5)({md:"400px"}),a=(0,C.useRouter)();if(!e)return(0,i.jsx)(i.Fragment,{});let j=null==e?void 0:e.organizations;return j&&t?(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.W,{autoSelect:!1,children:[(0,i.jsx)(y.Tz,{label:o?"":(0,i.jsx)(v.x6,{id:"ysdDIA"}),"aria-label":o?b.Ru._({id:"gh8p1T"}):b.Ru._({id:"ysdDIA"}),children:(0,i.jsx)(d.a,{children:(0,i.jsx)(c.I,{as:u.$,isDisabled:!o,variant:"ghost",borderRadius:"lg",rightIcon:o?(0,i.jsx)(f.g,{icon:x.tdl,"aria-label":"Caret icon"}):(0,i.jsx)(f.g,{icon:x.seF}),w:"100%",colorScheme:"blackAlpha",color:"gray.700",cursor:"pointer",_hover:{bg:"gray.50"},p:2,py:6,paddingInlineEnd:4,children:(0,i.jsx)(d.a,{width:"100%",children:t&&(0,i.jsx)(R,{workspace:t,memberCount:null,isMultiline:!1})})})})}),(0,i.jsx)(p.c,{minW:l,zIndex:"overlay",shadow:"lg",maxW:"min(500px, 100vw)",children:j&&j.length>0&&(0,i.jsx)(h.i,{title:b.Ru._({id:"pmt7u4"}),type:"radio",defaultValue:null==t?void 0:t.id,onChange:e=>{n(e)},children:j.filter(e=>!w()(e)&&!w()(e.id)&&!w()(e.name)).map(e=>(0,i.jsx)(m.k,{value:e.id,icon:1===j.length?null:void 0,isFocusable:1!==j.length,children:(0,i.jsxs)(r.z,{children:[(0,i.jsx)(g.s,{flex:1,w:"100%",children:(0,i.jsx)(R,{workspace:e,memberCount:null,isMultiline:!0})}),e.id===(null==t?void 0:t.id)&&(0,i.jsx)(g.s,{children:(0,i.jsx)(u.$,{size:"sm",variant:"outline",onClick:()=>a.push("/settings"),children:(0,i.jsx)(v.x6,{id:"0dbeO4"})})})]})},e.id))})})]})}):(0,i.jsx)(i.Fragment,{})},T=e=>{let{workspace:t,canManageWorkspace:n,subscription:r}=e,o={"invite-by-email":{displayName:(0,i.jsx)(v.x6,{id:"owUDwc"}),icon:x.Hzw,component:(0,i.jsx)(e9,{workspace:t,canManageWorkspace:n,subscription:r})},"invite-by-link":{displayName:(0,i.jsx)(v.x6,{id:"woAAa8"}),icon:x.CQO,component:(0,i.jsx)(ti,{workspace:t,canManageWorkspace:n,subscription:r})}},[l,a]=(0,I.useState)(Object.keys(o)[0]);return(0,i.jsxs)(d.a,{w:"100%",children:[(0,i.jsx)(eL,{tabs:o,size:"sm",activeTabKey:l,setActiveTabKey:a,onClick:()=>{}}),(0,i.jsx)(d.a,{pt:4,children:l&&o[l].component})]})};var z=n(55597),M=n(23201),D=n(46898),O=n(27229),L=n(96414),N=n(41960),B=n(42706),U=n(29768),F=n(59142),W=n(54920),G=n(92130),V=n(41781),H=n(3276),q=n(88586),K=n(62997);let Y=(e,t)=>"".concat(null!=e?e:""," ").concat(t?"(".concat(t,")"):""),X=e=>(null==e?void 0:e.nextBillingTime)||"",J=e=>!!(null==e?void 0:e.cancellationRequestedTime),$=e=>(null==e?void 0:e.createdTime)||"",Z=e=>{var t;return!!(null==e||null==(t=e.products)?void 0:t.length)},Q=e=>Z(e)&&(null==e?void 0:e.enforceSeatLimit),ee=e=>!!(null==e?void 0:e.expirationTime)&&new Date>new Date(null==e?void 0:e.expirationTime),et=e=>{if(!(null==e?void 0:e.createdByUser))return"";let{displayName:t,email:n}=e.createdByUser;return"".concat(t," (").concat(n,")")};var en=n(75570),ei=n(67909),er=n(36071),eo=n(54731),el=n(17920),ea=n(3674),es=n(40691),ed=n(16426),ec=n(61204),eu=n(57405),ep=n(64268),eh=n(51504),em=n(31090),eg=n(99038);let ex=(e,t,n)=>{let r=Y(t.displayName,t.email),o=(0,K.mc)();return"remove"===e?{title:(0,i.jsx)(v.x6,{id:"HlXuQk",values:{0:t.displayName||""}}),description:(0,i.jsx)(v.x6,{id:"MYcnTw",values:{nameWithEmail:r}}),confirmButtonLabel:(0,i.jsx)(v.x6,{id:"gNjH/6"})}:"leave"===e?{title:(0,i.jsx)(v.x6,{id:"6iUevl"}),description:(0,i.jsx)(v.x6,{id:"nM44Cu",values:{0:n.name}}),confirmButtonLabel:(0,i.jsx)(v.x6,{id:"hGWoeF"})}:{title:(0,i.jsx)(v.x6,{id:"kxbLa+",values:{WORKSPACE_ADMIN_DISPLAY_NAME:o}}),description:(0,i.jsx)(v.x6,{id:"gJfQ74",values:{WORKSPACE_ADMIN_DISPLAY_NAME:o}}),confirmButtonLabel:(0,i.jsx)(v.x6,{id:"m4YerB"})}},ef=e=>{let{isOpen:t,onClose:n,onConfirmClick:r,onCancelClick:o,userToConfirm:l,workspace:s,action:d}=e;if(!t)return null;let{title:c,description:p,confirmButtonLabel:h}=ex(d,l,s);return(0,i.jsxs)(ei.aF,{returnFocusOnClose:!1,onClose:n,isOpen:!0,isCentered:!0,size:"lg",children:[(0,i.jsx)(er.m,{}),(0,i.jsxs)(eo.$,{children:[(0,i.jsx)(el.r,{children:c}),(0,i.jsx)(ea.s,{}),(0,i.jsxs)(es.c,{children:[(0,i.jsx)(a.E,{children:p}),"remove"===d&&(0,i.jsx)(ey,{user:l,mt:3})]}),(0,i.jsx)(ed.j,{children:(0,i.jsxs)(ec.e,{variant:"ghost",children:[(0,i.jsx)(u.$,{onClick:o,colorScheme:"gray",children:(0,i.jsx)(v.x6,{id:"dEgA5A"})}),(0,i.jsx)(u.$,{variant:"hazardous",onClick:r,children:h})]})})]})]})},ey=e=>{let{user:t,...n}=e;return(0,i.jsxs)(eu.T,{spacing:3,...n,children:[(0,i.jsx)(ep.F,{status:"warning",children:(0,i.jsxs)(r.z,{children:[(0,i.jsx)(o.e,{src:null==t?void 0:t.profileImageUrl,size:"sm",name:null==t?void 0:t.displayName}),(0,i.jsxs)(l.B,{spacing:0,ml:2,flex:"1",children:[(0,i.jsx)(a.E,{fontSize:"sm",flex:"1",wordBreak:"break-word",children:null==t?void 0:t.displayName}),t.email&&(0,i.jsx)(a.E,{fontSize:"xs",color:"gray.600",flex:"1",wordBreak:"break-word",children:t.email})]})]})}),(0,i.jsxs)(ep.F,{children:[(0,i.jsx)(eh._,{}),(0,i.jsxs)(em._J,{spacing:3,children:[(0,i.jsx)(em.ck,{children:(0,i.jsx)(v.x6,{id:"J1E9I7",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:eg.Ix,0:t.displayName||""}})}),(0,i.jsx)(em.ck,{children:(0,i.jsx)(v.x6,{id:"1i/P7t",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:eg.Ix,0:t.displayName||""}})})]})]})]})};var ev=n(8099),eb=n(6760),ej=n(85595);let ew=e=>{let{selected:t,options:n,onSelect:r,isMenuDisabled:o,disabledOptions:l=[],deleteLabel:g=(0,i.jsx)(v.x6,{id:"HBvein"}),onDeleteClick:y,disabledDeleteReason:b}=e,j=t===q.KPK.Admin?(0,i.jsx)(v.x6,{id:"U3pytU"}):(0,i.jsx)(v.x6,{id:"OvoEq7"});return(0,i.jsxs)(s.W,{closeOnSelect:!0,children:[(0,i.jsx)(c.I,{as:u.$,isDisabled:o,variant:"ghost",size:"sm",rightIcon:(0,i.jsx)(f.g,{icon:x.Jt$}),children:j}),(0,i.jsx)(p.c,{maxW:"320px",zIndex:"dropdown",children:(0,i.jsxs)(h.i,{defaultValue:t,value:t,type:"radio",onChange:e=>{Array.isArray(e)||r(e)},children:[n.map(e=>{let t=l.find(t=>t.disabledOption===e);return(0,i.jsx)(m.k,{value:e,isDisabled:!!t,pt:3,children:(0,i.jsx)(ev.m,{"aria-label":null==t?void 0:t.reason,label:null==t?void 0:t.reason,isDisabled:!t,placement:"right",shouldWrapChildren:!0,children:(0,i.jsxs)(d.a,{lineHeight:"base",children:[(0,i.jsx)(a.E,{fontSize:"md",children:K.YP[e].title}),(0,i.jsx)(a.E,{fontSize:"sm",color:"gray.500",children:K.YP[e].description})]})})},e)}),(0,i.jsx)(eb.N,{}),(0,i.jsx)(ev.m,{"aria-label":b,label:b,isDisabled:!b,placement:"right",shouldWrapChildren:!0,children:(0,i.jsx)(ej.D,{onClick:y,color:"red.500",fontSize:"md",lineHeight:"base",isDisabled:!!b,children:g})})]})})]})},eC=(e,t)=>(t||[]).find(t=>{var n;return(null==(n=t.workspace)?void 0:n.id)===e}),eI=e=>{var t;let{workspace:n,dateFormatterFn:r,canManageWorkspace:o,workspaceAdminCount:a}=e,[s,c]=(0,I.useState)(q.PID.DisplayName),[p,h]=(0,I.useState)(q.UEL.Asc),[m,x]=(0,I.useState)(!1),y={id:null==n?void 0:n.id,first:50,sortBy:{field:s,direction:p}},{data:j,loading:w,fetchMore:C}=(0,q.yk$)({variables:y,skip:!(null==n?void 0:n.id),fetchPolicy:"network-only",nextFetchPolicy:"network-only"}),[S,{loading:k}]=(0,q.KSE)(),[E,{loading:_}]=(0,q.fpC)(),[R,P]=(0,I.useState)(null),T=null==j||null==(t=j.workspaceMembers)?void 0:t.pageInfo,M=!w&&(null==T?void 0:T.hasNextPage)&&(null==T?void 0:T.endCursor),X=null==j?void 0:j.workspaceMembers.edges.map(e=>e.node),{user:J,refetch:$}=(0,A.ur)(),Z=n.id,Q=(0,D.d)(),[ee,et]=(0,I.useState)(null),[ei,er]=(0,I.useState)(null),[eo,el]=(0,I.useState)(new en.c),{isOpen:ea,onOpen:es,onClose:ed}=(0,O.j)(),ec=(0,I.useMemo)(()=>null!=a?a:(null==X?void 0:X.reduce((e,t)=>{let n=eC(Z,t.workspaceMemberships);return n&&n.role===q.KPK.Admin&&e++,e},0))||0,[X,Z,a]),eu=(0,I.useCallback)(async()=>(es(),eo.promise),[eo,es]),ep=(0,I.useCallback)(()=>{et(null),er(null)},[]),eh=(0,I.useCallback)((e,t)=>{P(e.id),S({variables:{workspaceId:n.id,userId:e.id,role:t},refetchQueries:["GetWorkspace"]}).then(()=>{null==$||$(),Q({description:t===q.KPK.Admin?(0,i.jsx)(v.x6,{id:"IFCQlQ",values:{0:e.displayName,1:e.email}}):(0,i.jsx)(v.x6,{id:"gWgob7",values:{0:e.displayName,1:e.email}}),status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(()=>{Q({description:(0,i.jsx)(v.x6,{id:"CF7q4i",values:{0:e.displayName,1:e.email}}),status:"error",position:"top",duration:5e3,isClosable:!0})}).finally(()=>{P(null)})},[$,Q,S,n.id]),em=(0,I.useCallback)(e=>async t=>{if(e&&o)if((null==J?void 0:J.id)===e.id&&t===q.KPK.Member){if(ec<=1)return;et(e),er("giveUpAdminAccess"),eu().then(()=>{eh(e,t)}).catch(()=>{console.debug("[handleMemberRoleChange] User cancelled action")}).finally(()=>ep())}else eh(e,t)},[ec,o,eh,eu,ep,null==J?void 0:J.id]),eg=(0,I.useCallback)(e=>()=>{if(e.id===(null==J?void 0:J.id))return;let t=Y(e.displayName,e.email);et(e),er("remove"),eu().then(()=>{P(e.id),E({variables:{workspaceId:Z,userId:e.id},refetchQueries:["GetWorkspace","GetWorkspaceMembers"]}).then(()=>{null==$||$(),Q({description:(0,i.jsx)(v.x6,{id:"jkCRxy",values:{emailWithName:t}}),status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(()=>{Q({description:(0,i.jsx)(v.x6,{id:"eETcUn",values:{emailWithName:t}}),status:"error",position:"top",duration:5e3,isClosable:!0})})}).finally(()=>{P(null),ep()})},[E,eu,Z,null==J?void 0:J.id,$,ep,Q]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L.K,{children:(0,i.jsxs)(N.X,{variant:"simple",colorScheme:"blackAlpha",size:"sm",whiteSpace:"normal",children:[(0,i.jsx)(B.d,{children:(0,i.jsxs)(U.Tr,{children:[(0,i.jsx)(F.Th,{children:(0,i.jsx)(u.$,{ml:-3,size:"sm",variant:"ghost","aria-label":"sort",onClick:()=>{c(q.PID.DisplayName),h(e=>e===q.UEL.Asc?q.UEL.Desc:q.UEL.Asc)},rightIcon:(0,i.jsx)(f.g,{icon:s===q.PID.DisplayName?"asc"===p?z.xBV:z.S$_:z.OM7}),children:(0,i.jsx)(v.x6,{id:"6YtxFj"})})}),(0,i.jsx)(F.Th,{children:(0,i.jsx)(u.$,{ml:-3,size:"sm",variant:"ghost","aria-label":"sort",onClick:()=>{c(q.PID.CreatedTime),h(e=>e===q.UEL.Asc?q.UEL.Desc:q.UEL.Asc)},rightIcon:(0,i.jsx)(f.g,{icon:s===q.PID.CreatedTime?"asc"===p?z.xBV:z.S$_:z.OM7}),children:(0,i.jsx)(v.x6,{id:"SnjWqV"})})}),(0,i.jsx)(F.Th,{children:(0,i.jsx)(v.x6,{id:"GDvlUT"})})]})}),(0,i.jsxs)(W.N,{children:[w&&(0,i.jsx)(U.Tr,{p:0,children:(0,i.jsx)(G.Td,{colSpan:2,p:0,children:(0,i.jsxs)(l.B,{spacing:2,children:[(0,i.jsx)(V.E,{h:8}),(0,i.jsx)(V.E,{h:8}),(0,i.jsx)(V.E,{h:8})]})})}),X&&X.map((e,t)=>{let l=t===X.length-1,a=eC(n.id,e.workspaceMemberships),s=r(null==a?void 0:a.createdTime),c=null==a?void 0:a.role,u=c===q.KPK.Admin,p=c?K.YP[c].title:"",h=R===e.id,m=e.id===(null==J?void 0:J.id);return(0,i.jsxs)(U.Tr,{children:[(0,i.jsx)(G.Td,{borderBottom:l?"0 none":void 0,children:(0,i.jsx)(eS,{user:e,isSelf:m})}),(0,i.jsx)(G.Td,{borderBottom:l?"0 none":void 0,whiteSpace:"nowrap",children:s}),(0,i.jsx)(G.Td,{borderBottom:l?"0 none":void 0,w:32,children:h?(0,i.jsx)(d.a,{textAlign:"center",children:(0,i.jsx)(H.y,{size:"xs"})}):o&&c?(0,i.jsx)(ew,{selected:c,isMenuDisabled:k||_,options:[q.KPK.Admin,q.KPK.Member],onSelect:em(e),disabledOptions:u&&ec<=1?[{disabledOption:q.KPK.Member,reason:b.Ru._({id:"EUrQJ5"})}]:[],disabledDeleteReason:m?b.Ru._({id:"FuzXoL"}):void 0,onDeleteClick:eg(e)}):p})]},e.id)})]})]})}),M&&(0,i.jsx)(g.s,{w:"100%",justify:"center",align:"center",mt:3,children:(0,i.jsx)(u.$,{isLoading:m,size:"sm",onClick:()=>{x(!0),C({variables:{after:null==T?void 0:T.endCursor}}).finally(()=>{x(!1)})},children:(0,i.jsx)(v.x6,{id:"yQ2kGp"})})}),ee&&ei&&(0,i.jsx)(ef,{isOpen:ea,onClose:()=>{ed(),eo.reject(),el(new en.c)},onCancelClick:()=>{ed(),eo.reject(),el(new en.c)},onConfirmClick:async()=>{ed(),eo.resolve(),el(new en.c)},userToConfirm:ee,action:ei,workspace:n})]})},eS=e=>{let{user:t,isSelf:n}=e,{displayName:s,profileImageUrl:d,email:c}=t;return(0,i.jsxs)(r.z,{children:[(0,i.jsx)(o.e,{size:"sm",name:s,src:d}),(0,i.jsxs)(l.B,{spacing:0,children:[(0,i.jsxs)(a.E,{children:[s,n?(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsx)(v.x6,{id:"4Q6lF1"})]}):""]}),(0,i.jsx)(r.z,{mt:1,children:(0,i.jsx)(a.E,{fontSize:"xs",children:c})})]})]})};var ek=n(26194),eA=n.n(ek);let eE=e=>{let{invitations:t,dateFormatterFn:n,canManageWorkspace:r}=e,[o,l]=(0,I.useState)("email"),[s,c]=(0,I.useState)("asc"),[p]=(0,q.VxG)(),h=(0,D.d)(),m=(0,K.eD)(),g=(0,I.useCallback)(e=>{p({variables:{id:e}}).then(()=>{h({title:b.Ru._({id:"DGxAzK"}),status:"success",duration:3e3,isClosable:!0,position:"bottom"})}).catch(e=>{console.error(e),h({title:b.Ru._({id:"s51CLN",values:{0:e.message}}),status:"error",isClosable:!0,position:"bottom"})})},[p,h]),x="asc"===s?eA()(t,o):eA()(t,o).reverse();return 0===x.length?(0,i.jsx)(d.a,{p:4,background:"gray.50",children:(0,i.jsx)(a.E,{my:8,textAlign:"center",children:(0,i.jsx)(v.x6,{id:"blyObO"})})}):(0,i.jsx)(L.K,{children:(0,i.jsxs)(N.X,{variant:"simple",colorScheme:"blackAlpha",size:"sm",whiteSpace:"normal",children:[(0,i.jsx)(B.d,{children:(0,i.jsxs)(U.Tr,{children:[(0,i.jsx)(F.Th,{children:(0,i.jsx)(u.$,{ml:-3,size:"sm",color:"gray.500",variant:"ghost",colorScheme:"blackAlpha","aria-label":"sort",onClick:()=>{l("email"),c(e=>"asc"===e?"desc":"asc")},rightIcon:(0,i.jsx)(d.a,{color:"email"===o?"gray.600":"gray.300",children:(0,i.jsx)(f.g,{icon:"email"===o?"asc"===s?z.xBV:z.S$_:z.OM7})}),children:(0,i.jsx)(v.x6,{id:"O3oNi5"})})}),(0,i.jsxs)(F.Th,{children:[" ",(0,i.jsx)(u.$,{ml:-3,size:"sm",color:"gray.500",variant:"ghost",colorScheme:"blackAlpha","aria-label":"sort",onClick:()=>{l("createdTime"),c(e=>"asc"===e?"desc":"asc")},rightIcon:(0,i.jsx)(d.a,{color:"email"===o?"gray.600":"gray.300",children:(0,i.jsx)(f.g,{icon:"createdTime"===o?"asc"===s?z.xBV:z.S$_:z.OM7})}),children:(0,i.jsx)(v.x6,{id:"B82OLR"})})]}),(0,i.jsx)(F.Th,{children:(0,i.jsx)(v.x6,{id:"GXsAby"})})]})}),(0,i.jsx)(W.N,{children:x&&(null==x?void 0:x.length)>0&&x.map((e,t)=>(0,i.jsxs)(U.Tr,{children:[(0,i.jsx)(G.Td,{children:e.email}),(0,i.jsx)(G.Td,{children:n(e.createdTime)}),(0,i.jsx)(G.Td,{children:(0,i.jsx)(y.Tz,{placement:"top",label:(0,i.jsx)(v.x6,{id:"wcx9n8",values:{WORKSPACE_ADMIN_DISPLAY_NAME_PLURAL:m}}),shouldWrapChildren:!0,isDisabled:r,children:(0,i.jsx)(u.$,{w:20,variant:"plain",color:"plain",size:"sm",isDisabled:!r,onClick:()=>{g(e.id)},children:(0,i.jsx)(v.x6,{id:"GXsAby"})})})})]},e.id))})]})})},e_=e=>{let{workspace:t,canManageWorkspace:n}=e,r={"active-members":{displayName:(0,i.jsx)(i.Fragment,{children:(null==t?void 0:t.memberCount)?(0,i.jsx)(v.x6,{id:"6cWP3y",values:{0:t.memberCount}}):(0,i.jsx)(v.x6,{id:"Ob6KWB"})}),icon:z.GHC,component:(0,i.jsx)(eI,{workspace:t,dateFormatterFn:M.OG,canManageWorkspace:n,workspaceAdminCount:t.adminCount})},invitations:{displayName:(0,i.jsx)(v.x6,{id:"KxTWx3",values:{0:t.invitations&&t.invitations.length}}),icon:x.y_8,component:(0,i.jsx)(eE,{invitations:t.invitations,dateFormatterFn:M.OG,canManageWorkspace:n})}},[o,l]=(0,I.useState)(Object.keys(r)[0]);return(0,i.jsxs)(d.a,{w:"100%",children:[t&&(0,i.jsx)(eL,{tabs:r,size:"sm",activeTabKey:o,setActiveTabKey:l,onClick:()=>{}}),o&&r[o].component]})};var eR=n(23293);let eP=e=>{let{children:t,...n}=e;return(0,i.jsx)(eR.D,{size:"md",...n,children:t})},eT=e=>{let{children:t}=e;return(0,i.jsx)(eR.D,{size:"sm",my:2,children:t})},ez=e=>{let{title:t,description:n,children:r,...o}=e;return(0,i.jsxs)(g.s,{direction:{base:"column",lg:"row"},w:"100%",gap:{base:10,lg:24},...o,children:[(0,i.jsxs)(g.s,{direction:"column",justifyContent:"flex-start",flex:"1",children:[(0,i.jsx)(eT,{children:t}),(0,i.jsx)(a.E,{fontSize:"sm",color:"gray.600",children:n})]}),(0,i.jsx)(g.s,{flex:"1",justifyContent:{base:"flex-start",lg:"flex-end"},children:r})]})},eM=e=>{let{children:t}=e;return(0,i.jsx)(l.B,{display:"flex",gap:"8",w:"100%",children:t})};var eD=n(7761),eO=n(68301);let eL=e=>{let{tabs:t,activeTabKey:n,setActiveTabKey:r,onClick:o,size:l="md"}=e,a=I.useMemo(()=>Object.keys(t).filter(e=>{let n=t[e];return!n.enabledFeatureFlag||eO.of.get(n.enabledFeatureFlag)}).map(e=>{let n=t[e];return{key:e,label:n.displayName,icon:(0,i.jsx)(f.g,{icon:n.icon,fixedWidth:!0})}}),[t]),s=I.useMemo(()=>{let e=t[n];return{key:n,label:e.displayName,icon:(0,i.jsx)(f.g,{icon:e.icon,fixedWidth:!0})}},[t,n]);return a&&n?(0,i.jsx)(eD.x,{options:a,selectedOption:s,setSelectedOption:e=>{o(e.key),r(e.key)},dropdownButtonLeftIcon:s.icon,size:l}):null};var eN=n(74771),eB=n(80314),eU=n(88608),eF=n(14322),eW=n(74003);let eG=()=>{var e;let{currentWorkspace:t,user:n}=(0,A.ur)(),r=(0,A.CX)(),{subscription:o,refetchSubscription:l}=(0,eW.I)(),a=r&&o&&n&&(null==(e=o.createdByUser)?void 0:e.id)===n.id,s=a?(0,eF.AY)():void 0,{isCanceling:c,handleCancel:p,cancelFlowEnabled:h}=tA(o,t,l),m=J(o),x=ee(o),f=et(o),b=o?(0,eU.Yq)(o.expirationTime,"PPP"):"";return(0,i.jsx)(g.s,{alignItems:"center",direction:"column",w:"100%",gap:"4",children:(0,i.jsxs)(d.a,{w:"100%",display:"flex",flexDirection:"column",gap:"4",children:[(0,i.jsx)(y.Tz,{placement:"top",shouldWrapChildren:!0,label:void 0===s?(0,i.jsx)(v.x6,{id:"/3BSdl",values:{creatorNameAndEmail:f,GAMMA_PROPER_NOUN:eg.On}}):x?(0,i.jsx)(v.x6,{id:"QPZMto",values:{formattedExpirationTime:b}}):m?(0,i.jsx)(v.x6,{id:"49zSNq",values:{formattedExpirationTime:b}}):(0,i.jsx)(v.x6,{id:"HrQ7yf"}),children:(0,i.jsx)(u.$,{target:"_blank",href:s,as:eB.N,size:"md",w:"100%",textShadow:"none",rightIcon:(0,i.jsx)(eN.p,{ms:-1}),isDisabled:void 0===s,_hover:{textDecoration:"none"},children:m||x?(0,i.jsx)(v.x6,{id:"aAFalq"}):(0,i.jsx)(v.x6,{id:"IGCJs2"})})}),h&&!m&&(0,i.jsx)(y.Tz,{placement:"top",shouldWrapChildren:!0,label:a?(0,i.jsx)(v.x6,{id:"o/WrRZ"}):(0,i.jsx)(v.x6,{id:"cg8FOs",values:{creatorNameAndEmail:f}}),children:(0,i.jsx)(u.$,{colorScheme:"gray",variant:"link",size:"sm",w:"100%",mt:"2",onClick:a?p:void 0,isLoading:c,isDisabled:!a||c,children:(0,i.jsx)(v.x6,{id:"fHXMPy"})})})]})})};var eV=n(95889);let eH={src:"/_next/static/media/stars.9fe7baf4.svg"},eq=()=>{let{openUpsellModal:e}=(0,eW.I)();return(0,i.jsxs)(g.s,{direction:{base:"column",lg:"row"},alignItems:{base:"flex-start",lg:"center"},justifyContent:{base:"flex-start",lg:"space-between"},bg:"var(--chakra-colors-gradient-brand-bg), url(".concat(eH.src,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundBlendMode:"overlay",w:"100%",py:"8",px:"6",gap:{base:"6",lg:"2"},rounded:"md",children:[(0,i.jsxs)(g.s,{direction:"column",w:{base:"100%",lg:"75%"},children:[(0,i.jsx)(eP,{color:"white",children:(0,i.jsx)(v.x6,{id:"qAWquf"})}),(0,i.jsx)(a.E,{mt:"4",fontSize:"sm",color:"white",children:(0,i.jsx)(v.x6,{id:"AnpD+i",values:{GAMMA_PROPER_NOUN:eg.On}})})]}),(0,i.jsx)(g.s,{direction:"column",alignItems:"center",justifyContent:"center",w:{base:"100%",lg:"25%"},gap:"2",children:(0,i.jsx)(u.$,{w:"100%",cursor:"pointer",onClick:()=>{e({onOpenCallback:()=>{},onCloseCallback:()=>{},segmentEvent:eV.VV.GAMMA_PRO_UPSELL_CALLOUT_WORKSPACE_SETTINGS})},children:(0,i.jsx)(v.x6,{id:"kwkhPe"})})})]})};var eK=n(78686),eY=n(72470),eX=n(77979),eJ=n(40913),e$=n(66897),eZ=n(18833),eQ=n(831),e0=n.n(eQ),e1=n(13006),e6=n(61491),e2=n(87827),e5=n(11390);let e4=()=>{let[e,t]=(0,I.useState)(!1),{product:n,subscription:i}=(0,eW.I)(),r=!!n&&(null==i?void 0:i.enforceSeatLimit)!==!1,[o,l]=(0,I.useState)(new en.c),{isOpen:a,onOpen:s,onClose:d}=(0,O.j)({id:"confirm-add-paid-user"}),c=(0,I.useCallback)(()=>t(e=>!e),[]),u=(0,I.useCallback)(()=>{o.reject(),t(!1),d()},[d,o]);return{isConfirmAddPaidMemberModalOpen:a,isConfirmAddPaidMemberModalChecked:e,onConfirmAddPaidMemberClose:u,onConfirmAddPaidMemberClick:(0,I.useCallback)(()=>{o.resolve(!0),t(!1),d()},[d,o]),showConfirmPaidUserModal:(0,I.useCallback)(()=>{if(!r)return Promise.resolve();let e=new en.c;return l(e),s(),e.promise},[r,s]),onConfirmAddPaidMemberClickCheckbox:c}},e8=e=>{let{isOpen:t,newMemberCount:n,isChecked:r,onClose:o,onConfirmClick:s,onCancelClick:c,onCheckboxConfirm:p}=e,{subscription:h}=(0,eW.I)(),m=(0,I.useCallback)(()=>(0,e5.rx)(h,n),[h,n]),{totalPrice:x,productPrice:f}=(0,e2.n)(m,[n,h]);if(!t||!h)return null;let y=(null==f?void 0:f.frequencyUnit)===q.Vd7.Month?(0,i.jsx)(v.x6,{id:"JKIwMd",values:{newMemberCount:n,totalPrice:x},components:{0:(0,i.jsx)("strong",{}),1:(0,i.jsx)("strong",{})}}):(0,i.jsx)(v.x6,{id:"Pltlc3",values:{newMemberCount:n,totalPrice:x},components:{0:(0,i.jsx)("strong",{}),1:(0,i.jsx)("strong",{})}});return(0,i.jsxs)(ei.aF,{isOpen:t,onClose:o,trapFocus:!1,size:"xl",children:[(0,i.jsx)(er.m,{}),(0,i.jsxs)(eo.$,{children:[(0,i.jsx)(el.r,{children:(0,i.jsx)(v.x6,{id:"B9zUUN",values:{newMemberCount:n}})}),(0,i.jsx)(ea.s,{}),(0,i.jsx)(es.c,{children:(0,i.jsxs)(l.B,{spacing:4,children:[(0,i.jsx)(a.E,{as:"span",children:(0,i.jsx)(v.x6,{id:"c6yFkJ"})}),(0,i.jsxs)(g.s,{gap:3,alignItems:"start",children:[(0,i.jsx)(e6.S,{mt:1,isChecked:r,onChange:p}),(0,i.jsx)(a.E,{children:y})]}),(0,i.jsx)(d.a,{fontSize:"sm",bgColor:"gray.200",p:4,borderRadius:"md",children:(0,i.jsx)(a.E,{children:(0,i.jsx)(v.x6,{id:"mjZQpA"})})})]})}),(0,i.jsx)(ed.j,{children:(0,i.jsxs)(ec.e,{children:[(0,i.jsx)(u.$,{variant:"ghost",colorScheme:"gray",onClick:c,children:(0,i.jsx)(v.x6,{id:"dEgA5A"})}),(0,i.jsx)(u.$,{variant:"solid",onClick:s,isDisabled:!r,children:(0,i.jsx)(v.x6,{id:"WMsmjg",values:{newMemberCount:n}})})]})})]})]})},e3=(0,eZ.P)(d.a),e9=e=>{let{workspace:t,canManageWorkspace:n,subscription:r}=e,o=(0,D.d)(),s=(0,I.useRef)(),c=(0,I.useRef)(null),[p,h]=(0,I.useState)([]),[m,x]=(0,I.useState)(new en.c),[f,j]=(0,I.useState)(""),[w,{loading:C}]=(0,q.B74)(),S=(0,eV.st)(),{isConfirmAddPaidMemberModalOpen:k,isConfirmAddPaidMemberModalChecked:A,onConfirmAddPaidMemberClick:E,onConfirmAddPaidMemberClose:_,showConfirmPaidUserModal:R,onConfirmAddPaidMemberClickCheckbox:P}=e4(),T=(0,I.useMemo)(()=>p.concat({email:f.trim()}).filter(e=>!("email"in e)||(0,e$.t)(e.email||"")),[f,p]),z=!!(f.length||p.length),M=!!T.length,O=C||!n,L=(0,I.useCallback)(async()=>{if(0!==T.length)return w({variables:{workspaceId:t.id,invitees:T},refetchQueries:["GetWorkspace"]}).then(()=>{o({title:(0,i.jsx)(v.x6,{id:"Ka86rB",values:{0:T.length}}),description:(0,i.jsx)(a.E,{children:T.map(e=>(0,i.jsx)(a.E,{children:e.email},e.email))}),status:"success",position:"top",isClosable:!0,duration:9e3}),null==S||S.track(eV.VV.WORKSPACE_USER_INVITED,{workspace_id:t.id,source:"workspace-settings-page",number_of_invites_sent:T.length,permissions:"member"})})},[T,w,t.id,o,S]),N=(0,I.useCallback)(async()=>R().then(L).then(()=>{var e;h([]),j(""),null==(e=s.current)||e.resetItems(!0),m.resolve(),x(new en.c)}).catch(e=>{console.warn(e)}),[R,L,m]),B=(0,I.useCallback)(e=>{h(t=>t.filter(t=>t.email!==e))},[]),U=(0,I.useCallback)(e=>{h(t=>e0()([...t,...e],"email"))},[]),F=(0,K.eD)(),W=(0,K.mc)();return(0,i.jsxs)(d.a,{w:"100%",fontSize:"sm",children:[(0,i.jsxs)(l.B,{pb:"4",children:[(0,i.jsx)(a.E,{children:(0,i.jsx)(v.x6,{id:"wQ9F+j",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:eg.Ix}})}),Q(r)&&(0,i.jsx)(a.E,{children:(0,i.jsx)("strong",{children:(0,i.jsx)(v.x6,{id:"zHGbOA"})})})]}),(0,i.jsxs)(g.s,{direction:"row",w:"100%",alignItems:"flex-start",children:[(0,i.jsx)(eY.M,{w:"100%",justifyContent:"center",flex:1,children:(0,i.jsxs)(eJ.j9,{ref:s,values:p,maxSelections:100,maxSuggestions:20,creatable:!0,multiple:!0,freeSolo:!0,suggestWhenEmpty:!1,openOnFocus:!0,filter:(e,t)=>!p.find(e=>e.email===t),onSelectOption:e=>{let{item:t}=e;U([{email:t.value}]),j("")},onTagRemoved:e=>{h(t=>[...t].filter(t=>t.email!==e))},children:[(0,i.jsxs)(eX.W,{pointerEvents:"none",color:"gray.300",h:"100%",flexDirection:"column",children:[(0,i.jsx)(g.s,{flex:1}),(0,i.jsx)(g.s,{h:10,py:4,alignItems:"center",children:(0,i.jsx)(eK.W,{w:10})})]}),(0,i.jsx)(y.Tz,{placement:"top-start",label:(0,i.jsx)(v.x6,{id:"8LvjQl",values:{WORKSPACE_ADMIN_DISPLAY_NAME_PLURAL:F,WORKSPACE_ADMIN_DISPLAY_NAME:W}}),isDisabled:n,children:(0,i.jsx)(d.a,{children:(0,i.jsx)(eJ.Rv,{ref:c,"data-testid":"autocomplete-collaborators-input",cursor:O?"not-allowed":void 0,disabled:O,w:"100%",paddingInlineStart:5,color:"gray.800",wrapStyles:{px:2},fontSize:"md",placeholder:b.Ru._({id:"mIuglr"}),transition:"width 1s ease-in-out",value:f,onKeyDown:e=>{let{key:t}=e;if("Enter"===t&&0===f.length)return void e.preventDefault();if("Backspace"===t&&0===f.length&&p.length>0){let e=p.slice(-1).pop();if(e){var n;null==(n=s.current)||n.removeItem(e.email)}}},onPaste:e=>{e.preventDefault(),e.stopPropagation(),U([...e.clipboardData.getData("Text").trim().split(/[,|;\s]+/).map(e=>({email:e}))]),j("")},onChange:e=>{let{target:t}=e,{value:n}=t;j(n)},children:p.map((e,t)=>(0,i.jsx)(e1.w,{idx:t,selectedCollaborator:e,handleRemoveClick:()=>{B(e.email)}},e.email))})})})]})}),(0,i.jsx)(e3,{overflowX:"hidden",transition:"slow",animate:{maxWidth:z?"240px":"0px"},children:(0,i.jsx)(d.a,{ms:2,children:(0,i.jsx)(u.$,{variant:"solid",onClick:N,isDisabled:!M,isLoading:!1,"data-testid":"add-selected-items",children:(0,i.jsx)(v.x6,{id:"MFKlMB"})})})})]}),(0,i.jsx)(e8,{isOpen:k,newMemberCount:T.length,isChecked:A,onConfirmClick:E,onClose:_,onCancelClick:_,onCheckboxConfirm:P})]})};var e7=n(70006),te=n(90394),tt=n(38036);let tn=e=>{let{url:t,placeholder:n,isDisabled:r=!1,onClick:o,...l}=e,[a,s]=(0,I.useState)(!1),[c,p]=(0,I.useState)(""),{hasCopied:h,onCopy:m}=(0,te.i)(t),g=(0,I.useRef)(null),x=(0,D.d)(),f="link-copied-toast";(0,I.useEffect)(()=>{g.current&&a&&(g.current.focus(),g.current.select())},[a]);let b=(0,I.useCallback)(()=>s(!0),[]),j=(0,I.useCallback)(()=>s(!1),[]),w=(0,I.useCallback)(()=>{m(),x.isActive(f)||x({id:f,title:(0,i.jsx)(v.x6,{id:"pQjjYo"}),status:"success",duration:5e3,isClosable:!0}),null==o||o()},[o,m,x]),C=(0,K.eD)(),S=(0,K.mc)();return(0,I.useEffect)(()=>{r?p("Only ".concat(C," can view this link")):p(t)},[t,C,r]),(0,i.jsx)(y.Tz,{label:(0,i.jsx)(v.x6,{id:"XJhzX8",values:{WORKSPACE_ADMIN_DISPLAY_NAME_PLURAL:C,WORKSPACE_ADMIN_DISPLAY_NAME:S}}),placement:"top-start",isDisabled:!r,children:(0,i.jsx)(d.a,{w:"100%",children:(0,i.jsxs)(eY.M,{size:"sm",children:[(0,i.jsx)(tt.p,{ref:g,w:"100%",h:"3rem",type:"text",value:c,isDisabled:r,placeholder:n||void 0,onClick:b,onBlur:j,pointerEvents:r?"none":void 0,transition:"ease-in-out 0.2s",bg:"white",color:"gray.800",fontSize:"md",disabled:r,cursor:r?"not-allowed":void 0,wrapStyles:{px:2},...l}),(0,i.jsx)(eX.t,{zIndex:1,w:"unset",display:r?"none":"flex",children:(0,i.jsx)(u.$,{isDisabled:r,onClick:w,height:"2rem",fontSize:"sm",px:3,mt:"1rem",mr:"0.5rem",shadow:"sm",children:h?(0,i.jsx)(v.x6,{id:"6V3Ea3"}):(0,i.jsx)(v.x6,{id:"y1eoq1"})})})]})})})},ti=e=>{let{workspace:t,canManageWorkspace:n,subscription:r}=e,[o,s]=(0,I.useState)(null);return(0,I.useEffect)(()=>{t&&s((0,e7.Ow)(t))},[o,t]),(0,i.jsxs)(g.s,{direction:"column",fontSize:"sm",children:[(0,i.jsxs)(l.B,{pb:"4",children:[(0,i.jsx)(a.E,{children:(0,i.jsx)(v.x6,{id:"ig2Isf",values:{GAMMA_ARTIFACT_PROPER_NOUN_PLURAL:eg.Ix}})}),Q(r)&&(0,i.jsx)(a.E,{children:(0,i.jsx)("strong",{children:(0,i.jsx)(v.x6,{id:"ROlVXx"})})})]}),t&&(0,i.jsxs)(g.s,{direction:"column",children:[(0,i.jsx)(g.s,{children:o&&(0,i.jsx)(tn,{url:o,isDisabled:!n})}),n&&(0,i.jsx)(v.x6,{id:"X4Z7y1"})]})]})};var tr=n(90456),to=n(86992),tl=n(84287),ta=n(37605),ts=n(41246);let td={bg:"trueblue.50",borderColor:"trueblue.200",color:"trueblue.600"},tc={bg:"url(".concat("/_next/static/media/nightsky-cropped.3b9ddb87.webp",")"),backgroundSize:"100% 100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundBlendMode:"overlay",color:"white"},tu=e=>{let{plan:t}=e,n=(0,eV.st)(),r=(0,tr.U)(),o=null==r?void 0:r.showSubscriptionUpgradeModal,{subscription:l}=(0,tl.I)(),a=(0,I.useCallback)(()=>{let e=l?$(l):null,i=e?Math.round((new Date().getTime()-new Date(e).getTime())/864e5):null;t&&(null==n||n.track(ta.VV.UPGRADE_WORKPLACE_SETTINGS,{current_plan:(0,e5.cE)(t,"monthly"),source:"workspace_settings",subscription_tenure_days:i}),null==n||n.track(ta.VV.UPGRADE_MODAL_VIEW,{current_plan:(0,e5.cE)(t,"monthly"),modal_source:"workspace_settings"}))},[n,t,l]),s=(0,I.useCallback)(()=>{t&&(null==o||o({newPlan:t,newFrequency:q.Vd7.Year}),a())},[t,o,a]),{savingsPercentage:d}=r||{};return o?(0,i.jsx)(u.$,{variant:"plus"===t?"solid":"plain",size:"sm",onClick:s,boxShadow:"none",children:(0,i.jsx)(v.x6,{id:"IDztaw",values:{savingsPercentage:d}})}):null},tp=e=>{let{plan:t="plus",planFrequency:n,openUpsellModal:r}=e,o="pro"===t?tc:td,s=(0,ts.CX)(),d=t?(0,to.Ok)()[t].name:"",c=(0,to.Ok)().pro.name,p=s&&n===q.Vd7.Month;return(0,i.jsxs)(l.B,{w:"100%",justifyContent:"center",spacing:2,children:[(0,i.jsxs)(g.s,{w:"100%",direction:"column",alignItems:"center",justifyContent:"center",rounded:"md",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.05)",borderWidth:"1px",borderRadius:"xl",gap:4,p:4,pb:6,...o,children:[(0,i.jsxs)(l.B,{spacing:0,alignItems:"center",children:[(0,i.jsx)(eR.D,{color:o.color,variant:"brand",size:"3xl",fontWeight:"700",children:d}),(0,i.jsx)(a.E,{fontSize:"xl",fontWeight:"bold",color:o.color,w:"fit-content",children:n===q.Vd7.Month?(0,i.jsx)(v.x6,{id:"+8Nek/"}):(0,i.jsx)(v.x6,{id:"YkfDoz"})})]}),p&&(0,i.jsx)(tu,{plan:t})]}),"pro"!==t&&(0,i.jsx)(g.s,{w:"100%",children:(0,i.jsx)(u.$,{size:"md",width:"100%",onClick:()=>{r({segmentEvent:ta.VV.GAMMA_PRO_UPSELL_WORKSPACE_SETTINGS})},textShadow:"none",children:(0,i.jsx)(v.x6,{id:"2Ow80C",values:{proPlanName:c}})})})]})};var th=n(88033);let tm=e=>{let{workspaceId:t,selected:n,fieldName:r,options:o}=e,l=(0,A.CX)(),[a]=(0,q.l_E)(),s=(0,D.d)(),d=e=>()=>{s({title:"updated"===e?b.Ru._({id:"Xpw8aE"}):b.Ru._({id:"jwO7L7"}),status:"success",duration:5e3,isClosable:!0,position:"top"})};return(0,i.jsx)(th.qk,{selected:n,options:o,isDisabled:!l,onClick:e=>{let n=e===th.F$.NoAccess?null:e,i={id:t,[r]:n};a({variables:{input:i},optimisticResponse:{updateWorkspace:{id:i.id,[r]:n}}}).then(d("updated")).catch(()=>{console.warn("Error updating permission")})}})};var tg=n(83638),tx=n(74231),tf=n(5091);let ty=e=>{let{workspace:t,canManageWorkspace:n}=e,r=(0,D.d)(),[o,a]=(0,I.useState)((null==t?void 0:t.name)||""),[s,c]=(0,I.useState)(!1),{isInOfflineMode:p}=(0,S.u)(),[h,{loading:m,called:x,error:f,reset:j}]=(0,q.l_E)(),{refetch:w}=(0,A.ur)(),C=(0,I.useCallback)(()=>{c(!1),a((null==t?void 0:t.name)||"")},[null==t?void 0:t.name]),k=(0,I.useCallback)(()=>{h({variables:{input:{name:o,id:null==t?void 0:t.id}},fetchPolicy:"no-cache"}).then(()=>{r({status:"success",title:"Success!",description:"Workspace updated successfully.",position:"top",duration:5e3,isClosable:!0}),c(!1),j(),w&&w()}).catch(e=>{console.error('[WorkspaceNameField] Error updating workspace "'.concat(null==t?void 0:t.id,'"'),e.message)})},[h,o,null==t?void 0:t.id,r,j,w]),E=""===o.trim()||o.trim().length<K.oP||o.length>50||!!(null==f?void 0:f.message);(0,I.useEffect)(()=>{o!==t.name&&c(!0)},[o,t.name]);let _=(0,K.eD)();return t?(0,i.jsxs)(tg.MJ,{isInvalid:E,children:[(0,i.jsxs)(l.B,{w:"100%",direction:["column","row"],children:[(0,i.jsx)(y.Tz,{placement:"top-start",label:(0,i.jsx)(v.x6,{id:"M1LZmX",values:{WORKSPACE_ADMIN_DISPLAY_NAME_PLURAL:_}}),isDisabled:p||n,children:(0,i.jsx)(d.a,{w:"100%",children:(0,i.jsx)(tt.p,{w:"100%",placeholder:b.Ru._({id:"CozWO1"}),value:o,isDisabled:p||!n,onChange:e=>a(e.target.value.slice(0,50)),bg:"white"})})}),n&&s&&(0,i.jsx)(tx.s,{in:s,unmountOnExit:!0,children:(0,i.jsxs)(g.s,{children:[(0,i.jsx)(u.$,{variant:"solid",isLoading:m,isDisabled:!n||E||x,onClick:k,children:(0,i.jsx)(v.x6,{id:"tfDRzk"})}),(0,i.jsx)(u.$,{onClick:C,variant:"ghost",colorScheme:"gray",children:(0,i.jsx)(v.x6,{id:"dEgA5A"})})]})})]}),(0,i.jsx)(tf.Wt,{children:(null==f?void 0:f.message)?null==f?void 0:f.message:(0,i.jsx)(v.x6,{id:"soNtuq",values:{WORKSPACE_NAME_MIN_LENGTH:K.oP}})})]}):null};var tv=n(33787),tb=n(58297),tj=n(29810),tw=n(87996),tC=n(18640),tI=n(60908);let tS=e=>{let{workspace:t,canManageWorkspace:n}=e,[h,m]=(0,q.l_E)(),{loading:b,error:j}=m,{isInOfflineMode:w}=(0,S.u)(),C=(0,D.d)(),{refetch:k}=(0,A.ur)(),[E,_]=(0,I.useState)((null==t?void 0:t.logoUrl)||""),[R,P]=(0,I.useState)(""),[T,M]=(0,I.useState)("idle"),O=R||E,L=(0,I.useMemo)(()=>tw.Fk.createUppyInstance(t.id,{onUploadStart:e=>{P(""),M("uploading"),(0,tI.aI)(e.file.type||"")||_(e.tempUrl)},onOriginalFileUpload:e=>{console.debug("[WorkspaceLogoField] onOriginalFileUpload",e),_(e.src),P(t=>t||e.src)},onUploadComplete:e=>{console.debug("[WorkspaceLogoField] onUploadComplete",e),_(t=>t||e.src),P(e.src),M("idle"),L.cancelAll()},onUploadFailed:()=>{M("error"),L.cancelAll()}},"workspaceLogo"),[t.id]),{onClick:N,inputElement:B}=(0,tC.W)({uppy:L}),U=(0,I.useCallback)(()=>{L.cancelAll(),M("idle"),_(t.logoUrl||""),P("")},[L,t.logoUrl]),F=(0,I.useMemo)(()=>E!==t.logoUrl&&E,[t.logoUrl,E]),W=(0,I.useCallback)(()=>{F&&h({variables:{input:{id:t.id,logoUrl:E}}}).then(()=>{C({title:(0,i.jsx)(v.x6,{id:"Rk6T6B"}),position:"top",status:"success",isClosable:!0,duration:3e3}),setTimeout(()=>{k&&k()},0)}).catch(e=>{console.error('[WorkspaceLogoField.onSaveClick] Error updating workspace info "'.concat(t.id,'"'),e.message)})},[F,h,t,E,C,k]),G=(0,I.useCallback)(()=>{_(""),P(""),h({variables:{input:{id:t.id,logoUrl:""}}}).then(()=>{C({title:(0,i.jsx)(v.x6,{id:"vfEt3o"}),position:"top",status:"success",isClosable:!0,duration:3e3})}).catch(e=>{console.error('[WorkspaceLogoField.onRemoveClick] Error removing workspace logo "'.concat(t.id,'"'),e.message)})},[h,t,C]),V=!!(null==j?void 0:j.message)||"error"===T,Y=(0,K.eD)();return(0,I.useEffect)(()=>{t&&_(t.logoUrl||"")},[t,t.name]),(0,i.jsxs)(g.s,{display:"flex",flexDirection:"row",justifyContent:"flex-start",w:"100%",gap:4,children:[B,(0,i.jsx)(d.a,{w:0,h:0,children:(0,i.jsx)(tv._,{src:R})}),(0,i.jsx)(g.s,{display:"flex",flexDirection:"row",alignItems:"start",children:(0,i.jsx)(l.B,{children:(0,i.jsxs)(s.W,{placement:"bottom-start",offset:[100,0],children:[(0,i.jsx)(y.Tz,{label:n?(0,i.jsx)(v.x6,{id:"U8dGAE"}):(0,i.jsx)(v.x6,{id:"DKuEP9",values:{WORKSPACE_ADMIN_DISPLAY_NAME_PLURAL:Y}}),isDisabled:w,placement:"top",children:(0,i.jsx)(d.a,{children:(0,i.jsx)(c.I,{position:"relative",disabled:w||!n||"uploading"===T,userSelect:"none",cursor:"pointer",_disabled:{cursor:"not-allowed"},role:"group",_hover:{opacity:.9},children:(0,i.jsxs)(o.e,{src:O,bg:O?"transparent":"deepocean.300",name:t.name,size:"2xl",_groupHover:{shadow:"lg"},ignoreFallback:!0,children:["uploading"===T&&(0,i.jsx)(tb.j,{position:"absolute",size:"full",justifyContent:"center",alignItems:"center",bg:"gray.300",opacity:.5,children:(0,i.jsx)(H.y,{size:"xl",thickness:"2px"})}),(0,i.jsx)(tb.j,{position:"absolute",bottom:0,right:0,borderRadius:"full",color:"gray.700",textAlign:"center",bg:"gray.200",size:9,_groupHover:{shadow:"lg",transform:"scale(1.02)"},children:(0,i.jsx)(f.g,{icon:E?x.rwq:x.MT7,width:16,height:16,size:"xs"})})]})})})}),(0,i.jsxs)(p.c,{fontSize:"sm",children:[(0,i.jsx)(ej.D,{onClick:()=>{"uploading"!==T&&N()},children:(0,i.jsxs)(r.z,{children:[(0,i.jsx)(f.g,{icon:z.MNJ}),(0,i.jsx)(a.E,{children:(0,i.jsx)(v.x6,{id:"wPTug2"})})]})}),E&&(0,i.jsx)(eb.N,{}),E&&(0,i.jsx)(ej.D,{onClick:G,children:(0,i.jsxs)(r.z,{color:"var(--chakra-colors-red-500)",children:[(0,i.jsx)(f.g,{icon:x.yLS,color:"var(--chakra-colors-red-500)"}),(0,i.jsx)(a.E,{children:(0,i.jsx)(v.x6,{id:"O90CN2"})})]})})]})]})})}),(0,i.jsx)(tj.h,{}),(0,i.jsx)(g.s,{children:(0,i.jsx)(g.s,{justifyContent:"space-between",alignItems:"center",children:(0,i.jsx)(g.s,{direction:"row",justifyContent:"space-between",gap:2,children:(0,i.jsxs)(tx.s,{in:!!F,unmountOnExit:!0,children:[(0,i.jsx)(u.$,{variant:F?"solid":"plain",onClick:W,isDisabled:V||"uploading"===T,isLoading:b,children:(0,i.jsx)(v.x6,{id:"tfDRzk"})}),(0,i.jsx)(u.$,{variant:"ghost",colorScheme:"gray",onClick:U,children:(0,i.jsx)(v.x6,{id:"dEgA5A"})})]})})})})]})};var tk=n(86025);let tA=(e,t,n)=>{let[i,r]=(0,I.useState)(!1),{launchCancelFlow:o,cancelFlowEnabled:l}=(0,tk.zE)(e,t),a=(0,I.useCallback)(async()=>{if(o&&n){eV.zS.track(eV.VV.CANCEL_SUBSCRIPTION_CLICK,{source:"cancel-flow"}),r(!0);try{var e;let t=await o();(null==t||null==(e=t.sessionResults)?void 0:e.canceled)===!0&&await n()}catch(e){console.warn("Failed to cancel subscription",e)}r(!1)}},[o,n]);return{isCanceling:i,handleCancel:a,cancelFlowEnabled:l}}},81664:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});let i=new(n(83747)).b},84693:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});var i=n(88586),r=n(82927);let o=e=>{var t;let{currentWorkspace:n}=(0,r.ur)(),{data:o}=(0,i.Vl$)({variables:{id:null!=(t=null!=e?e:null==n?void 0:n.id)?t:""},skip:!e&&!(null==n?void 0:n.id)});return e?null==o?void 0:o.workspace:{...n,...null==o?void 0:o.workspace}}},85570:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});let i=new(n(63867)).hs("animation")},86025:(e,t,n)=>{"use strict";n.d(t,{XE:()=>j,zE:()=>I,yf:()=>w});var i=n(55729),r=n(91938),o=n(8205),l=n(68301),a=n(73110),s=n(49337),d=n(11390),c=n(95889),u=n(82927),p=n(29608),h=n(64076),m=n(85732),g=n(77650),x=n(21157),f=n.n(x),y=n(99038);let v=(e,t)=>{let n=f()(t);return{[e]:{next:g.Ru._({id:"hXzOVo"}),back:g.Ru._({id:"iH8pgl"}),nevermind:g.Ru._({id:"CKyk7Q"}),goToAccount:g.Ru._({id:"C9yTHG",values:{GAMMA_PROPER_NOUN:y.On}}),getHelp:g.Ru._({id:"pWsyuL"}),declineOffer:g.Ru._({id:"aIFikE"}),confirmAndCancel:g.Ru._({id:"G9nPRC"}),pauseSubscription:g.Ru._({id:"2RgEmU"}),cancelSubscription:g.Ru._({id:"dEgA5A"}),discountSubscription:g.Ru._({id:"qG4Wa/"}),claimOffer:g.Ru._({id:"/Gl/RK"}),discountOff:g.Ru._({id:"Bdtwnw"}),discountFor:g.Ru._({id:"sQv06Y"}),discountForever:g.Ru._({id:"FsOOWf"}),discountOneTime:g.Ru._({id:"HpXCa4"}),day:g.Ru._({id:"5YWExy"}),month:g.Ru._({id:"obrMay"}),year:g.Ru._({id:"/Tw548"}),error:g.Ru._({id:"wTrpxV"}),genericErrorDescription:g.Ru._({id:"PUjJ3A"}),cancelNow:g.Ru._({id:"EiakwV"}),applyingDiscount:g.Ru._({id:"8kSYjw"}),applyingCancel:g.Ru._({id:"VpuvNv"}),applyingResume:g.Ru._({id:"eIoGiX"}),applyingPause:g.Ru._({id:"UD7gOq"}),discountApplied:g.Ru._({id:"jdYyiz"}),discountAppliedMessage:g.Ru._({id:"DhHX6G"}),pauseApplied:g.Ru._({id:"eeITvj"}),pauseAppliedMessage:g.Ru._({id:"nm0VaE"}),pauseAppliedResumeMessage:g.Ru._({id:"qOe0SS"}),pauseScheduledMessage:g.Ru._({id:"mqRc6d"}),until:g.Ru._({id:"C51N+0"}),cancelApplied:g.Ru._({id:"Wcg6zu"}),cancelAppliedMessage:g.Ru._({id:"8vN97Y"}),cancelAppliedDateMessage:g.Ru._({id:"BS/SGu"}),howLongToPausePrompt:g.Ru._({id:"HLyJ9n"}),whatCouldWeHaveDone:g.Ru._({id:"fcbm8H"}),weReadEveryAnswer:g.Ru._({id:"nkuKRd"}),applyingCustomerAction:g.Ru._({id:"PXwF+s"}),loading:g.Ru._({id:"Z3FXyt"}),pauseWallCardPunch:g.Ru._({id:"iL2TQ6"}),pauseWallCta:g.Ru._({id:"TvXj47"}),pauseWallCardHeading:g.Ru._({id:"kHm8Fg"}),scheduledToReactivate:g.Ru._({id:"aH7vi8"}),resumeApplied:g.Ru._({id:"diOgYK"}),resumeAppliedMessage:g.Ru._({id:"YqFvUY"}),resumeNextChargeMessage:g.Ru._({id:"YJHkcd"}),resumeNextChargeMessageWithoutAmount:g.Ru._({id:"RrvVAn"}),resumeAccountDataInfo:g.Ru._({id:"dJCJXA"}),subscriptionPauseNotice:g.Ru._({id:"fpxliT"}),failedPaymentNotice:g.Ru._({id:"Vxg5vO"}),chargedMultipleTimeNotice:g.Ru._({id:"lAlv46"}),failedPaymentCardPunch:g.Ru._({id:"KEZrHg",values:{GAMMA_PROPER_NOUN:y.On,productName:n}}),resumeHey:g.Ru._({id:"hdOctW"}),invoicePaidTitle:g.Ru._({id:"aJGfDL"}),logout:g.Ru._({id:"W+3RJN"}),note:g.Ru._({id:"ycCSuD"}),discount:g.Ru._({id:"HmpVeZ"}),discountNoticeHeadline:g.Ru._({id:"5P1dmt"}),discountNoticePrepend:g.Ru._({id:"yjadEY"}),discountOverride:g.Ru._({id:"JfBDWL"}),discountValidUntil:g.Ru._({id:"uXxNua"}),updateBilling:g.Ru._({id:"tQilrI"}),extendTrialCTA:g.Ru._({id:"aaued9"}),extendTrialPunch:g.Ru._({id:"tvkJWl"}),extendTrialOfferTitle:g.Ru._({id:"SyzXYh"}),trialExtended:g.Ru._({id:"fezME2"}),trialExtendedMessage:g.Ru._({id:"QE4mUs"}),applyingTrialExtension:g.Ru._({id:"vI2q9R"}),switchPlanCTA:g.Ru._({id:"P2mx2L"}),changePlanHighlights:g.Ru._({id:"qbgW+C"}),changePlanOfferPunch:g.Ru._({id:"MRkiFP"}),planChanged:g.Ru._({id:"ByFtyh"}),planChangedMessage:g.Ru._({id:"Pf5z1G"}),applyingPlanChange:g.Ru._({id:"9vKKLI"}),surveyStepTag:g.Ru._({id:"cSUBI1"}),freeFormStepTag:g.Ru._({id:"cSUBI1"}),finalConfirmation:g.Ru._({id:"1/oP/N"}),offerDiscountTag:g.Ru._({id:"LTgtxG"}),offerChangePlanTag:g.Ru._({id:"ENMJv2"}),offerExtendTrialTag:g.Ru._({id:"MWKntz"}),offerRedirectTag:g.Ru._({id:"cvpAvL"}),offerContactTag:g.Ru._({id:"cvpAvL"}),offerPauseTag:g.Ru._({id:"+T6DGl"}),completeTag:g.Ru._({id:"K5c1e7"}),errorTag:g.Ru._({id:"EuvbIW"}),offerAccepted:g.Ru._({id:"ZU0opP"})}}},b="\n!function(){  \n    if (!window.churnkey || !window.churnkey.created) {\n      window.churnkey = { created: true };\n      const a = document.createElement('script');\n      a.src = 'https://assets.churnkey.co/js/app.js?appId=".concat(r.$.CHURNKEY_APP_ID,"';\n      a.async = true;\n      const b = document.getElementsByTagName('script')[0];\n      b.parentNode.insertBefore(a, b);\n    }\n  }();\n"),j=()=>{let e=!(0,p.rA)()&&!(0,m.NF)();return(0,h.W)(e,b),null},w=e=>{var t;let{subscription:n,workspace:c,autoLaunch:p=!0}=e,{user:h}=(0,u.ur)(),m=(0,l.u)("churnkeyFailedPaymentWallEnabled"),g=(0,a.O)(),x=(0,d.A4)(c),f=(0,s.k)(),y=m&&(null==h?void 0:h.id)===(null==n||null==(t=n.createdByUser)?void 0:t.id),v=(0,i.useCallback)(async()=>{if(n&&x&&y)return(0,o.yg)("churnkey").then(e=>{var t,i;if(!e||!n.billingSubscriptionId||!(null==(t=n.createdByUser)?void 0:t.billingCustomerId))return void console.error("[Churnkey] launchFailedPayment Missing hmac or subscription data",{hmac:e,subscription:n});console.debug("[Churnkey] launchFailedPayment - launching churnkey with:",{hmac:e,appId:r.$.CHURNKEY_APP_ID,subscriptionId:n.billingSubscriptionId,customerId:null==(i=n.createdByUser)?void 0:i.billingCustomerId}),C({authHash:e,subscription:n,localeKey:g,productKey:x,launchIntercomUI:f})})},[n,x,y,g,f]);return(0,i.useEffect)(()=>{p&&v()},[v,p]),{launchFailedPaymentFlow:v,failedPaymentFlowEnabled:y}},C=async e=>{var t,n;let{authHash:i,subscription:o,localeKey:l,productKey:a,launchIntercomUI:s}=e;null==(n=window.churnkey)||n.check("failed-payment",{subscriptionId:o.billingSubscriptionId,customerId:null==(t=o.createdByUser)?void 0:t.billingCustomerId,authHash:i,customerAttributes:{language:l},i18n:{lang:l,messages:v(l,a)},appId:r.$.CHURNKEY_APP_ID,mode:r.$.CHURNKEY_MODE,provider:"stripe",softWall:!0,forceCheck:!1,gracePeriodDays:3,ignoreInvoicesWithoutAttempt:!1,handleSupportRequest(){var e;s(),c.zS.track(c.VV.CHURNKEY_HANDLE_SUPPORT_CLICK,{source:"failed-payment-wall",subscriptionId:o.billingSubscriptionId,customerId:null==(e=o.createdByUser)?void 0:e.billingCustomerId})},async handleCancel(e){var t,n;return c.zS.track(c.VV.CANCEL_SUBSCRIPTION_CLICK,{source:"failed-payment-wall",subscriptionId:o.billingSubscriptionId,customerId:null==(t=o.createdByUser)?void 0:t.billingCustomerId}),console.debug("[launchChurnkeyFailedPayment.handleCancel]",{subscriptionId:o.billingSubscriptionId,customerId:null==(n=o.createdByUser)?void 0:n.billingCustomerId,customer:e}),S({authHash:i,subscription:o,localeKey:l,productKey:a,launchIntercomUI:s,customerAttributes:{viaFailedPayment:!0}}).catch(e=>C({authHash:i,subscription:o,localeKey:l,productKey:a,launchIntercomUI:s}))},onFailedPaymentWallActivated(){var e;c.zS.track(c.VV.CHURNKEY_FAILED_PAYMENT_WALL_SHOWN,{subscriptionId:o.billingSubscriptionId,customerId:null==(e=o.createdByUser)?void 0:e.billingCustomerId})},onUpdatePaymentInformation(){var e;c.zS.track(c.VV.CHURNKEY_PAYMENT_METHOD_UPDATED,{source:"failed-payment-wall",subscriptionId:o.billingSubscriptionId,customerId:null==(e=o.createdByUser)?void 0:e.billingCustomerId})},onFailedPaymentWallClose(){var e;c.zS.track(c.VV.CHURNKEY_FAILED_PAYMENT_WALL_CLOSED,{subscriptionId:o.billingSubscriptionId,customerId:null==(e=o.createdByUser)?void 0:e.billingCustomerId})},onCancel(){var e;c.zS.track(c.VV.CHURNKEY_CANCEL_SUBSCRIPTION_COMPLETE,{source:"failed-payment-wall",subscriptionId:o.billingSubscriptionId,customerId:null==(e=o.createdByUser)?void 0:e.billingCustomerId})},onError(e,t){console.warn('Churnkey check("failed-payment", ...) error',e,t)}})},I=(e,t)=>{let n=(0,l.u)("churnkeyCancelFlowEnabled"),r=(0,a.O)(),c=(0,d.A4)(t),u=(0,s.k)();return{launchCancelFlow:(0,i.useCallback)(()=>{if(e&&c&&n)return(0,o.yg)("churnkey").then(t=>{var n;return t&&e.billingSubscriptionId&&(null==(n=e.createdByUser)?void 0:n.billingCustomerId)?S({authHash:t,subscription:e,localeKey:r,productKey:c,launchIntercomUI:u}):void console.debug("[Churnkey] handleCancel - Missing hmac or subscription data",{hmac:t,subscription:e})})},[n,r,c,e,u]),cancelFlowEnabled:n}},S=async e=>{let{authHash:t,subscription:n,localeKey:i,productKey:o,customerAttributes:l={},launchIntercomUI:a}=e;return new Promise((e,s)=>{var u,p,h;null==(h=window.churnkey)||h.init("show",{subscriptionId:n.billingSubscriptionId,customerId:null==(u=n.createdByUser)?void 0:u.billingCustomerId,authHash:t,customerAttributes:{language:i,frequency:null==(p=(0,d.ZJ)(n))?void 0:p.frequencyUnit,productKey:o,...l},i18n:{lang:i,messages:v(i,o)},appId:r.$.CHURNKEY_APP_ID,mode:r.$.CHURNKEY_MODE,provider:"stripe",record:!0,handleSupportRequest(){var e;a(),c.zS.track(c.VV.CHURNKEY_HANDLE_SUPPORT_CLICK,{source:"cancel-flow",subscriptionId:n.billingSubscriptionId,customerId:null==(e=n.createdByUser)?void 0:e.billingCustomerId})},onCancel(e,t,i){var r;c.zS.track(c.VV.CHURNKEY_CANCEL_SUBSCRIPTION_COMPLETE,{source:"cancel-flow",subscriptionId:n.billingSubscriptionId,customerId:null==(r=n.createdByUser)?void 0:r.billingCustomerId,surveyResponse:t,freeformFeedback:i}),console.debug("[launchChurnkeyCancelFlow.onCancel]",{surveyResponse:t,freeformFeedback:i})},onGoToAccount(t){console.debug("[launchChurnkeyCancelFlow.onGoToAccount]",{sessionResults:t}),e({sessionResults:t})},onClose(t){if(console.debug("[launchChurnkeyCancelFlow.onClose]",{sessionResults:t}),!t||t.aborted)return void s("Churnkey cancel flow aborted");e({sessionResults:t})},onError(e){console.warn("[launchChurnkeyCancelFlow.onError]",{message:e}),s({message:e})}})})}},86497:(e,t,n)=>{"use strict";n.d(t,{O:()=>o});var i=n(32617),r=n(5291);let o=()=>{let e=(0,i.u)("offlineEditing"),t=(0,r.b9)();return e&&t}},87291:(e,t,n)=>{"use strict";n.d(t,{d:()=>m});var i=n(6029),r=n(46898),o=n(19564),l=n(55729),a=n(88586),s=n(15342),d=n(95889),c=n(99552),u=n(91792),p=n(43634),h=n(85607);let m=()=>{let e=(0,r.d)(),[t]=(0,a.vlJ)(),n=(0,s.GV)(c.df),{docId:m,getCollaborativeEditorInstance:g}=(0,h.mi)(),x=(0,s.GV)(p.SJ),f=g(),y=(0,d.st)(),{updateDocThemeWithAccentImages:v}=(0,u.Kt)({docId:m,editor:f}),b=(0,l.useCallback)(e=>{n&&e.id!==x.id&&t({variables:{input:{siteId:n,themeId:e.id}},update:(t,i)=>{let{data:r}=i,o=t.readFragment({id:"Theme:".concat(e.id),fragment:a.qaq,fragmentName:"DefaultThemeFields"});t.updateQuery({query:a.zLA,variables:{id:n}},e=>e&&e.site&&o?{...e,site:{...e.site,...null==r?void 0:r.updateSite,theme:o}}:e)}}).then(()=>{})},[n,x.id,t]),j=(0,l.useCallback)(t=>{t.id!==x.id&&v(t.id).then(()=>{null==y||y.track(d.VV.DOC_THEME_UPDATED,{doc_id:m,theme_id:t.id})}).catch(t=>{console.error(t),e({title:(0,i.jsx)(o.x6,{id:"Fulf8b",values:{0:t.message}}),position:"top",status:"error"})})},[y,x.id,m,e,v]);return(0,l.useCallback)(e=>n?b(e):j(e),[n,j,b])}},88033:(e,t,n)=>{"use strict";n.d(t,{F$:()=>i.F$,qk:()=>i.qk,uC:()=>R,j$:()=>P});var i=n(48561),r=n(6029),o=n(67909),l=n(36071),a=n(54731),s=n(17920),d=n(3674),c=n(40691),u=n(48810),p=n(58297),h=n(16426),m=n(61204),g=n(49611),x=n(27229),f=n(46898),y=n(99492),v=n(48621),b=n(19564),j=n(77650),w=n(38822),C=n.n(w),I=n(55729),S=n(88586),k=n(99038),A=n(82927),E=n(18351),_=n(72737);let R=e=>{var t,n;let{onClose:x,onSubmit:f,doc:w}=e,C=(0,A.Iy)("manage",w||void 0),{isConnected:k}=(0,S.utY)(),[E,_]=(0,I.useState)(S.aXG.Manage);return w?(0,r.jsxs)(o.aF,{closeOnOverlayClick:!1,isOpen:!0,onClose:x,size:"lg",children:[(0,r.jsx)(l.m,{}),(0,r.jsxs)(a.$,{"data-testid":"workspace-permissions-prompt",children:[(0,r.jsx)(s.r,{children:(0,r.jsx)(b.x6,{id:"JzTAyU",values:{0:w.title}})}),(0,r.jsx)(d.s,{}),(0,r.jsxs)(c.c,{children:[(0,r.jsx)(u.E,{mb:6,children:(0,r.jsx)(b.x6,{id:"wKPcxh"})}),(0,r.jsx)(i._Z,{testId:"workspace",title:(0,r.jsx)(b.x6,{id:"wtxjAY"}),subtitle:(null==w||null==(t=w.organization)?void 0:t.name)?j.Ru._({id:"aC87LX",values:{0:null==w||null==(n=w.organization)?void 0:n.name}}):j.Ru._({id:"ucB1/R"}),isDisabled:!C||!k,img:(0,r.jsx)(p.j,{color:"gray.700",textAlign:"center",bg:"gray.200",size:"32px",children:(0,r.jsx)(v.g,{size:"1x",icon:y.URI})}),disabledText:i.ef[E].title(),permissionsControl:(0,r.jsx)(i.qk,{selected:E,options:[S.aXG.Manage,S.aXG.Edit,S.aXG.Comment,S.aXG.View],onClick:e=>{_(e)}})})]}),(0,r.jsx)(h.j,{children:(0,r.jsxs)(m.e,{children:[(0,r.jsx)(g.$,{variant:"ghost",onClick:x,children:(0,r.jsx)(b.x6,{id:"dEgA5A"})}),(0,r.jsx)(g.$,{variant:"solid","data-testid":"workspace-permissions-submit",onClick:()=>{f(E),x()},children:(0,r.jsx)(b.x6,{id:"DPfwMq"})})]})})]})]}):(0,r.jsx)(r.Fragment,{})},P=()=>{let{onOpen:e,isOpen:t,onClose:n}=(0,x.j)({id:"workspacePermissionPromptDisclosure"}),[i]=(0,S.Ix6)(),{currentWorkspace:r}=(0,A.ur)(),o=(0,f.d)(),{addDocChannel:l}=(0,E.k)(),[a,s]=(0,I.useState)(null),[d,c]=(0,I.useState)(null),u=(0,A.IM)(),p=(0,I.useCallback)((e,t)=>{let n=(e.channels||[]).find(e=>e.id===t.id),i=(0,_.D5)(e,r),l=u.cannot("manage",e)&&C()(e.orgAccess);return i?(o({description:j.Ru._({id:"doMS3L",values:{GAMMA_ARTIFACT_PROPER_NOUN:k.TP}}),status:"warning",duration:5e3,isClosable:!0,position:"top"}),!1):l?(o({description:j.Ru._({id:"81ZRAa",values:{GAMMA_ARTIFACT_PROPER_NOUN:k.TP}}),status:"warning",duration:5e3,isClosable:!0,position:"top"}),!1):!n||(o({description:j.Ru._({id:"FRsVHP",values:{GAMMA_ARTIFACT_PROPER_NOUN:k.TP}}),status:"warning",duration:5e3,isClosable:!0,position:"top"}),!1)},[u,o,r]),h=(0,I.useCallback)(e=>{if(!a||!d)return;let{id:t}=a;i({variables:{id:t,orgAccess:e},optimisticResponse:{updateDoc:{id:t,orgAccess:e,__typename:"Doc"}}}).then(()=>{l({doc:a,channel:d,existingChannels:null==a?void 0:a.channels})}).catch(e=>{console.error("[useAddDocToChannel.updatedocOrgAccess] Error setting doc orgAccess for doc id",t),o({title:j.Ru._({id:"SlfejT"}),description:j.Ru._({id:"x9Wysy",values:{0:e.message}}),status:"error"})})},[l,a,d,o,i]),m=(0,I.useCallback)((t,n)=>{p(t,n)&&(t.orgAccess?l({doc:t,channel:n,existingChannels:(null==t?void 0:t.channels)||[]}):(s(t),c(n),e()))},[l,e,p]);return{isOpen:t,onClose:(0,I.useCallback)(()=>{c(null),s(null),n()},[n]),doc:a,handleAddDocToChannel:m,updateWorkspacePermissionThenAddToChannel:h}}},88114:(e,t,n)=>{"use strict";n.d(t,{K:()=>u});var i=n(55452),r=n(55729),o=n(88586),l=n(68986),a=n(65148),s=n(14322);let d=e=>{var t,n;let{pro:i,plus:r}=e,{yearly:o}=i||{},{yearly:l}=r||{};return(null==o||null==(t=o.discount)?void 0:t.price)||(null==l||null==(n=l.discount)?void 0:n.price)};class c extends Error{}let u=e=>{var t,n,u,p,h,m,g,x;let{workspaceId:f,isPublic:y=!1,canManageWorkspace:v,selectedBillingCycleKey:b}=e,[j]=(0,o.wQm)(),[w,C]=(0,r.useState)(),[I,S]=(0,r.useState)(),k="monthly"===b?{pro:null==w?void 0:w.monthly,plus:null==I?void 0:I.monthly}:"yearly"===b?{pro:null==w?void 0:w.yearly,plus:null==I?void 0:I.yearly}:null,A=f?{pro:(0,s.wb)(f,[(null==k||null==(t=k.pro)?void 0:t.id)||""]),plus:(0,s.wb)(f,[(null==k||null==(n=k.plus)?void 0:n.id)||""])}:null,E=(null==w||null==(p=w.yearly)||null==(u=p.discount)?void 0:u.price)||(null==w||null==(h=w.yearly)?void 0:h.price)||0,_=Math.round(12*((null==w||null==(m=w.monthly)?void 0:m.price)||0)),R=(null==I||null==(g=I.yearly)?void 0:g.price)||0,P=Math.round(12*((null==I||null==(x=I.monthly)?void 0:x.price)||0));return(0,r.useEffect)(()=>{C(null);let e=f;e||(e=l.x.getItem(a.E.currentWorkspaceId)?JSON.parse(l.x.getItem(a.E.currentWorkspaceId)):void 0),j({variables:{workspaceId:e}}).then(e=>{var t;if(e.error)throw Error("GraphQL error: "+JSON.stringify(e.error));let n=null==(t=e.data)?void 0:t.products;if(!n||!n.length)throw i.Cp("[getProducts] No products returned",{extra:{data:e.data}}),new c("[getProducts] No products returned");let{proMonthlyProductPrice:r,proYearlyProductPrice:o,plusMonthlyProductPrice:l,plusYearlyProductPrice:a}=(0,s.kp)(n);C({monthly:r,yearly:o}),S({monthly:l,yearly:a})}).catch(e=>{e instanceof c||console.error("[getProducts] err",e)})},[f,j,v,y]),{selectedProductPrices:k,annualProDiscountPercentage:(_-E)/_,annualPlusDiscountPercentage:(P-R)/P,hasSpecialAnnualDiscount:d({pro:w,plus:I}),checkoutUrls:A,productPricesPlus:I,productPricesPro:w}}},88571:(e,t,n)=>{"use strict";n.d(t,{a:()=>i.a,m:()=>i.m});var i=n(56450)},90456:(e,t,n)=>{"use strict";n.d(t,{t:()=>V,U:()=>G});var i=n(6029),r=n(46898),o=n(67909),l=n(36071),a=n(54731),s=n(17920),d=n(3674),c=n(40691),u=n(26385),p=n(48810),h=n(58959),m=n(29810),g=n(41781),x=n(96500),f=n(16426),y=n(61204),v=n(49611),b=n(40452),j=n(33787),w=n(26420),C=n(23293),I=n(3276),S=n(19564),k=n(27219),A=n(55729),E=n(73689),_=n(73287),R=n(99038),P=n(34823),T=n(88608),z=n(74003),M=n(28843),D=n(11390);let O=e=>{let{previewData:t,newProductPrice:n,seatCount:i}=e,r=(null==t?void 0:t.currency)?(0,D.GP)(t.currency):100,o=t&&n&&n.currency?i*(n.price||0)/(0,D.GP)(n.currency):null,l=o&&(null==t?void 0:t.total)?o-(null==t?void 0:t.total)/r:0,a="number"==typeof(null==t?void 0:t.startingBalance)&&"number"==typeof(null==t?void 0:t.endingBalance)?(Math.abs(null==t?void 0:t.startingBalance)-Math.abs(null==t?void 0:t.endingBalance))/r:0,s=t&&t.currency?(0,P.v)((t.amountDue||0)/r,{currency:t.currency}):null,d=o&&n&&n.currency?(0,P.v)(o,{currency:n.currency}):null,c=t&&n&&n.currency?(0,P.v)((n.price||0)/(0,D.GP)(n.currency),{currency:n.currency}):null,u=t&&t.currency&&l>0?(0,P.v)(l,{currency:t.currency}):null,p=t&&t.currency&&a>0?(0,P.v)(a,{currency:t.currency}):null;return{accountBalance:a,accountBalanceFormatted:p,newPerSeatPrice:c,proratedUpgradePrice:s,prorationAmount:l,prorationCredit:u,totalPrice:d}};var L=n(15342),N=n(95889),B=n(82927),U=n(85443),F=n(80812),W=n(88114);let G=()=>{var e,t;let n=(0,L.jL)(),o=(0,L.GV)(M.Pd),{status:l,productKey:a,productPrice:s,productFrequency:d,oldPlan:c}=o,{refetch:u}=(0,U.u)(),{subscription:p,refetchSubscription:h,product:m}=(0,z.I)(),[g]=(0,_.iaq)(),{data:x,refetch:f}=(0,_.GMP)({variables:{subscriptionId:(null==p?void 0:p.id)||"",newProductPriceId:(null==s?void 0:s.id)||""},skip:!(null==p?void 0:p.id)||!(null==s?void 0:s.id)||!o.isOpen}),y=(0,r.d)(),v=(0,N.st)(),b=(0,B.CX)(),{id:j}=(0,F.fL)(),{selectedProductPrices:w}=(0,W.K)({workspaceId:j,canManageWorkspace:b,selectedBillingCycleKey:"monthly"}),{selectedProductPrices:C}=(0,W.K)({workspaceId:j,canManageWorkspace:b,selectedBillingCycleKey:"yearly"}),I=(0,A.useCallback)(()=>{n((0,M.s3)()),m&&"verifying"!==o.status&&(null==v||v.track(N.VV.UPGRADE_ABANDONED,{abandonment_step:"modal_view",new_plan:(0,D.cE)(m,"yearly")}))},[v,n,o.status,m]),E=(0,A.useCallback)(async()=>new Promise((e,t)=>{if(!h)return void t();let n=0,r=setInterval(()=>{n++,h().then(o=>{var l;let{data:s}=o,c=(0,D.N_)(null==s?void 0:s.subscription);(null==c?void 0:c.key)!==a||d&&d!==(null==c||null==(l=c.productPrice)?void 0:l.frequencyUnit)?n>25&&(clearInterval(r),y({title:(0,i.jsx)(S.x6,{id:"7O1OBC"}),status:"error",duration:null}),t()):(clearInterval(r),e())})},500)}),[d,a,h,y]),R=(0,A.useCallback)(async()=>{let e=null==p?void 0:p.id,t=null==s?void 0:s.id;if(e&&t){n((0,M.au)("in-progress"));try{await g({variables:{id:e,productPriceId:t},awaitRefetchQueries:!0}),n((0,M.au)("verifying")),await E(),m&&(null==v||v.track(N.VV.UPGRADE_COMPLETE,{previous_plan:(0,D.cE)(m,"monthly"),new_plan:(0,D.cE)(m,"yearly"),renewal_date:(0,k.A)(new Date,1).toISOString()})),null==u||u()}catch(e){if(console.error(e),y({title:(0,i.jsx)(S.x6,{id:"7O1OBC"}),status:"error",duration:null}),!m)return;null==v||v.track(N.VV.UPGRADE_ERROR,{error_message:null==e?void 0:e.message,new_plan:(0,D.cE)(m,"yearly")})}}},[null==p?void 0:p.id,null==s?void 0:s.id,n,g,E,v,m,u,y]),T=m?null==C?void 0:C[m]:void 0,O=null==p||null==(t=p.products)||null==(e=t[0])?void 0:e.key,G=(0,A.useCallback)(e=>{var t;let{newPlan:i,newFrequency:r}=e,o=i?null==(t=r===_.Vd7.Month?w:C)?void 0:t[i]:void 0;o&&m&&(n((0,M.$C)({productKey:null!=i?i:void 0,productPrice:o,productFrequency:r,oldPlan:O})),n((0,M.gK)(null)),(null==p?void 0:p.id)&&(null==o?void 0:o.id)&&f({subscriptionId:p.id,newProductPriceId:o.id}).then(e=>{var t;n((0,M.gK)((null==(t=e.data)?void 0:t.previewSubscriptionUpdate)||null))}).catch(e=>{console.error(" Failed to preview subscription change:",e)}))},[O,w,C,m,n,null==p?void 0:p.id,f]),V=c!==a,H=m?null==w?void 0:w[m]:void 0;if(!(null==T?void 0:T.price)||!(null==H?void 0:H.price))return null;let q=T.price,K=H.price,Y=Math.round(100*(1-q/(12*K))),X=(0,P.v)(+((12*K-q)/(0,D.GP)(T.currency)).toFixed(2),{notation:"standard",currency:T.currency});return{showSubscriptionUpgradeModal:G,subscriptionUpgradeStatus:l,newProduct:a,newProductFrequency:d,newProductPrice:s,oldPlan:c,isPlanUpgrade:V,previewData:null==x?void 0:x.previewSubscriptionUpdate,onClose:I,onConfirmClick:R,savingsPercentage:Y,savingsAmount:X,selectedProductPrice:T}},V=()=>{let e=(0,L.GV)(M.Pd),t=G(),{subscriptionUpgradeStatus:n,newProduct:r,newProductPrice:b,newProductFrequency:j,isPlanUpgrade:w,previewData:C,savingsPercentage:I,savingsAmount:E,onClose:P,onConfirmClick:N}=t||{},{subscription:B,refetchSubscription:F}=(0,z.I)(),{refetch:W}=(0,U.u)(),V=(0,D.U2)(B)||1,{accountBalance:K,accountBalanceFormatted:Y,newPerSeatPrice:X,proratedUpgradePrice:J,prorationAmount:$,prorationCredit:Z,totalPrice:Q}=O({previewData:C,newProductPrice:b,seatCount:V}),ee=null==B?void 0:B.nextBillingTime,et=(0,A.useMemo)(()=>w?ee:(0,k.A)(new Date,1).toISOString(),[ee,w]),en="pro"===r?R.Kc:R.H9,ei="pro"===r?R.Ol:R.Ft,er=j===_.Vd7.Month?"month":"year",eo=(0,A.useCallback)(()=>{null==F||F(),null==W||W(),null==P||P()},[P,F,W]),el=n&&["not-started","in-progress"].includes(n);return e.isOpen&&t&&r&&B?(0,i.jsxs)(o.aF,{isOpen:e.isOpen,onClose:eo,trapFocus:!1,size:"verifying"===n?"2xl":"xl",children:[(0,i.jsx)(l.m,{}),"verifying"===n?(0,i.jsx)(H,{onClose:eo,newProduct:r,isPlanUpgrade:w}):(0,i.jsxs)(a.$,{children:[(0,i.jsx)(s.r,{children:w?(0,i.jsx)(S.x6,{id:"od3cZe",values:{newProductTypePronoun:en}}):(0,i.jsx)(S.x6,{id:"v2E4nZ",values:{newProductTypePronoun:en}})}),(0,i.jsx)(d.s,{}),(0,i.jsx)(c.c,{children:n&&["verifying","complete"].includes(n)?(0,i.jsx)(q,{status:n}):(0,i.jsxs)(u.B,{spacing:4,children:[!w&&(0,i.jsx)(p.E,{mb:2,children:(0,i.jsx)(S.x6,{id:"iHAmbK",values:{savingsPercentage:I,savingsAmount:E},components:{0:(0,i.jsx)(p.E,{fontWeight:"bold",color:"green.600",as:"span"}),1:(0,i.jsx)(p.E,{as:"span"})}})}),(0,i.jsxs)(u.B,{bg:"sky.50",p:4,borderRadius:"lg",children:[(0,i.jsxs)(u.B,{spacing:0,children:[(0,i.jsxs)(h.z,{w:"100%",justify:"space-between",spacing:1,children:[(0,i.jsx)(p.E,{as:"span",fontWeight:"bold",children:ei}),(0,i.jsx)(p.E,{color:"gray.700",children:V&&V>1&&"(x".concat(V,")")}),(0,i.jsx)(m.h,{}),X?(0,i.jsx)(p.E,{children:Q}):(0,i.jsx)(g.E,{h:5,w:15})]}),V&&V>1&&(0,i.jsx)(p.E,{fontSize:"sm",color:"gray.600",children:X?"year"===er?(0,i.jsx)(S.x6,{id:"AWNF80",values:{newPerSeatPrice:X}}):(0,i.jsx)(S.x6,{id:"eCItNz",values:{newPerSeatPrice:X}}):(0,i.jsx)(g.E,{h:4,w:30})})]}),C?(0,i.jsxs)(u.B,{spacing:2,children:[$>0&&(0,i.jsxs)(h.z,{justify:"space-between",children:[(0,i.jsx)(p.E,{fontWeight:"medium",children:(0,i.jsx)(S.x6,{id:"axBiAh"})}),(0,i.jsxs)(p.E,{color:"green.600",children:["-",Z]})]}),K>0&&(0,i.jsxs)(h.z,{justify:"space-between",children:[(0,i.jsx)(p.E,{fontWeight:"medium",children:(0,i.jsx)(S.x6,{id:"hzBYbK"})}),(0,i.jsxs)(p.E,{color:"green.600",children:["-",Y]})]})]}):(0,i.jsxs)(u.B,{bg:"gray.100",p:4,spacing:3,children:[(0,i.jsxs)(h.z,{justify:"space-between",children:[(0,i.jsx)(g.E,{h:5,w:95}),(0,i.jsx)(g.E,{h:5,w:65})]}),(0,i.jsxs)(h.z,{justify:"space-between",children:[(0,i.jsx)(g.E,{h:5,w:100}),(0,i.jsx)(g.E,{h:5,w:65})]})]}),(0,i.jsx)(x.c,{borderColor:"gray.300",my:2}),(0,i.jsxs)(h.z,{justify:"space-between",fontSize:"lg",children:[(0,i.jsx)(p.E,{fontWeight:"bold",children:(0,i.jsx)(S.x6,{id:"tV8kNA"})}),J?(0,i.jsx)(p.E,{fontWeight:"bold",children:J}):(0,i.jsx)(g.E,{h:6,w:20})]}),(0,i.jsx)(p.E,{fontSize:"xs",color:"gray.700",children:(0,i.jsx)(S.x6,{id:"C0VHmp"})})]}),(0,i.jsx)(u.B,{spacing:0,children:(0,i.jsxs)(p.E,{fontSize:"sm",color:"gray.700",children:[(0,i.jsx)(S.x6,{id:"PQmzn8"})," ",et&&(0,T.Yq)(et,"PPP")]})})]})}),n&&el&&(0,i.jsx)(f.j,{children:(0,i.jsxs)(y.e,{orientation:"vertical",w:"100%",children:[(0,i.jsx)(v.$,{variant:"solid",onClick:N,isLoading:"in-progress"===n,isDisabled:!C,children:(0,i.jsx)(S.x6,{id:"DDbn3x"})}),(0,i.jsx)(v.$,{fontSize:"md",variant:"ghost",colorScheme:"gray",onClick:P,children:w?(0,i.jsx)(S.x6,{id:"CCKKHO",values:{PLUS_PROPER_NOUN:R.H9}}):(0,i.jsx)(S.x6,{id:"UmMhxe"})})]})})]})]}):null},H=e=>{let{onClose:t,newProduct:n,isPlanUpgrade:r}=e,o="pro"===n?R.Kc:R.H9,{reward:l}=(0,E.bS)("bear","balloons",{startVelocity:3,spread:80}),{reward:s}=(0,E.bS)("bear","confetti"),c=(0,A.useRef)(!1);return(0,i.jsxs)(a.$,{sx:{borderRadius:"16px",overflow:"hidden"},children:[(0,i.jsx)(d.s,{}),(0,i.jsxs)(h.z,{align:"end",children:[(0,i.jsxs)(b.s,{h:"100%",justifyContent:"flex-end",m:0,p:0,onMouseEnter:()=>{c.current||(l(),s(),c.current=!0)},position:"relative",children:[(0,i.jsx)(j._,{src:"https://static.gamma.app/images/bear-with-balloons-50042070.webp",maxW:{base:"120px",md:"163px"},w:{base:"120px",md:"163px"}}),(0,i.jsx)(w.a,{position:"absolute",top:"30%",right:"25%",id:"bear"})]}),(0,i.jsxs)(u.B,{m:{base:2,sm:6},children:[(0,i.jsx)(p.E,{fontWeight:"bold",children:(0,i.jsx)(S.x6,{id:"eaTa58"})}),(0,i.jsx)(C.D,{size:{base:"md",sm:"lg"},children:r?(0,i.jsx)(S.x6,{id:"5YDdxV",values:{PRO_PROPER_NOUN:R.Kc}}):(0,i.jsx)(S.x6,{id:"/0frk/",values:{newProductPronoun:o}})}),(0,i.jsx)(m.h,{}),(0,i.jsxs)(p.E,{mb:4,children:[r&&(0,i.jsx)(S.x6,{id:"8WsNQx",values:{PRO_PROPER_NOUN:R.Kc}}),!r&&"Plus"===o&&(0,i.jsx)(S.x6,{id:"YxFLBL",values:{GAMMA_PLUS_PROPER_NOUN:R.Ft}}),!r&&"Pro"===o&&(0,i.jsx)(S.x6,{id:"ZpuSE8",values:{GAMMA_PROPER_NOUN:R.On}})]}),(0,i.jsx)(v.$,{variant:"solid",w:"fit-content",fontSize:"sm",px:6,onClick:t,children:r?(0,i.jsx)(S.x6,{id:"+uUBPY",values:{GAMMA_PRO_PROPER_NOUN:R.Ol}}):(0,i.jsx)(S.x6,{id:"C9yTHG",values:{GAMMA_PROPER_NOUN:R.On}})})]})]})]})},q=e=>{let{status:t}=e;return(0,i.jsxs)(u.B,{py:12,spacing:4,children:[(0,i.jsx)(I.y,{size:"lg"}),(0,i.jsx)(C.D,{size:"md",children:(0,i.jsx)(S.x6,{id:"it0Uj0"})}),(0,i.jsx)(p.E,{children:(0,i.jsx)(S.x6,{id:"+ofCyi"})})]})}},96804:(e,t,n)=>{"use strict";n.d(t,{B:()=>E});var i=n(6029),r=n(46898),o=n(67909),l=n(36071),a=n(54731),s=n(17920),d=n(3674),c=n(40691),u=n(26385),p=n(83638),h=n(25223),m=n(38036),g=n(16426),x=n(61204),f=n(49611),y=n(91106),v=n(19564),b=n(77650),j=n(81278),w=n(55729),C=n(88586),I=n(55252),S=n(44141),k=n(82927),A=n(70006);let E=e=>{var t;let{isOpen:n,onClose:E,existingDoc:_}=e,R=(0,r.d)(),P=(0,w.useRef)(null),[T,z]=(0,w.useState)(!1),{currentWorkspace:M}=(0,k.ur)(),[D,O]=(0,w.useState)(""),[L]=(0,C.Ybb)(),[N]=(0,C.aXl)(),B=(0,I.U)(),{push:U}=(0,j.useRouter)(),F=(0,w.useCallback)(async()=>{if(null==_?void 0:_.id){await (0,S.fb)(_.id),z(!0);try{var e,t;let{data:n}=await N({variables:{duplicateDocInput:{sourceDocId:_.id,source:C.ALe.SitesCopyToSite,title:(null==_?void 0:_.title)||b.Ru._({id:"wja8aL"}),orgId:null==M?void 0:M.id,orgAccess:C.aXG.Manage,themeId:null}}}),i=null==n||null==(e=n.duplicateDoc)?void 0:e.id;if(!i)return void console.error("[CreateSiteModal] Failed to duplicate doc with id",_.id);let{data:r}=await L({variables:{input:{workspaceId:null==M?void 0:M.id,name:D,routes:[{docId:i,path:"/"}],themeId:null==_||null==(t=_.theme)?void 0:t.id}}});if(!(null==r?void 0:r.createSite))return void console.error("[CreateSiteModal] Failed to create site, no site returned");let o=(0,A.pF)({docId:i});U(o),E()}catch(e){R({status:"error",title:(0,i.jsx)(v.x6,{id:"Pdboh4"}),description:(0,i.jsx)(v.x6,{id:"c6YG3V"})}),console.error(e)}z(!1)}},[L,null==M?void 0:M.id,N,null==_?void 0:_.id,null==_||null==(t=_.theme)?void 0:t.id,null==_?void 0:_.title,D,U,R]),W=(0,w.useCallback)(async()=>{z(!0);let{data:e}=await L({variables:{input:{workspaceId:null==M?void 0:M.id,name:D,routes:[]}}}),t=null==e?void 0:e.createSite;if(!t)return void console.error("[CreateSiteModal] Failed to create site, no site returned");B({siteId:null==t?void 0:t.id,routes:null==t?void 0:t.routes,title:"Home",path:"/"})},[B,L,null==M?void 0:M.id,D]),G=(0,w.useCallback)(async()=>(null==_?void 0:_.id)?F():W(),[null==_?void 0:_.id,F,W]),V=D.length>0;return(0,i.jsx)(y.L8,{isDark:!1,children:(0,i.jsxs)(o.aF,{isOpen:n,onClose:E,initialFocusRef:P,size:"2xl",children:[(0,i.jsx)(l.m,{}),(0,i.jsxs)(a.$,{children:[(0,i.jsx)(s.r,{children:(0,i.jsx)(v.x6,{id:"JHMOcq"})}),(0,i.jsx)(d.s,{}),(0,i.jsx)(c.c,{children:(0,i.jsx)(u.B,{spacing:4,children:(0,i.jsxs)(p.MJ,{children:[(0,i.jsx)(h.l,{children:(0,i.jsx)(v.x6,{id:"Lve3H6"})}),(0,i.jsx)(m.p,{ref:P,placeholder:b.Ru._({id:"tlD7N3"}),onChange:e=>{O(e.target.value)},onKeyDown:e=>{V&&"Enter"===e.key&&G()}})]})})}),(0,i.jsx)(g.j,{children:(0,i.jsxs)(x.e,{children:[(0,i.jsx)(f.$,{variant:"ghost",onClick:E,children:(0,i.jsx)(v.x6,{id:"dEgA5A"})}),(0,i.jsx)(f.$,{variant:"solid",onClick:G,isDisabled:!V,isLoading:T,children:(0,i.jsx)(v.x6,{id:"JHMOcq"})})]})})]})]})})}}}]);
//# sourceMappingURL=9715-494f46a53c4e8b10.js.map